var JR=Object.defineProperty;var KR=Object.getPrototypeOf;var WR=Reflect.get;var HR=(Ae,me,De)=>me in Ae?JR(Ae,me,{enumerable:!0,configurable:!0,writable:!0,value:De}):Ae[me]=De;var h=(Ae,me,De)=>(HR(Ae,typeof me!="symbol"?me+"":me,De),De),YR=(Ae,me,De)=>{if(!me.has(Ae))throw TypeError("Cannot "+De)};var _t=(Ae,me,De)=>{if(me.has(Ae))throw TypeError("Cannot add the same private member more than once");me instanceof WeakSet?me.add(Ae):me.set(Ae,De)};var he=(Ae,me,De)=>(YR(Ae,me,"access private method"),De),Gt=(Ae,me,De)=>WR(KR(Ae),De,me);(function(){var hr,Gs,fi,$c,di,Ec,mr,Zs,un,yr,Fs,Up,pi,Tc,hi,Nc,Ds,xp;"use strict";function Ae(){return new Promise((e,t)=>{const n=document.createElement("iframe");n.id="yuja-verity-extension-connect",n.style.display="none",n.style.visibility="hidden",n.src="https://zone1.verity.yuja.com/resources/themes/extension-connect.html",document.body.appendChild(n),n.onload=()=>e(n),n.onerror=t,setTimeout(t,5e3)})}function me(e){const t="https://zone1.verity.yuja.com";return new Promise((n,r)=>{const i=s=>{if(s.origin!==t){console.error(`Blocked message from origin ${s.origin}`);return}const a=s.data;if(a&&typeof a=="object"&&"require"in a&&a.require==="exists"&&"result"in a){const c=!!a.result,u=c&&"version"in a?a.version:void 0;n({exists:c,version:u}),window.removeEventListener("message",i)}};window.addEventListener("message",i),e.contentWindow?(e.contentWindow.postMessage({require:"exists"},t),setTimeout(()=>{r(),window.removeEventListener("message",i)},5e3)):(r(),window.removeEventListener("message",i))})}function De(e,t,n){const r="https://zone1.verity.yuja.com";return new Promise((i,s)=>{e.contentWindow?(e.contentWindow.postMessage({type:"saveAssessmentUrl",url:t,assessmentInfo:n},r),i(!0)):s()})}function Lc(e,t){const n="https://zone1.verity.yuja.com";return new Promise((r,i)=>{e.contentWindow?(e.contentWindow.postMessage({type:"saveMobileAssessmentUrl",url:t},n),r(!0)):i()})}async function Rn(e,t,n){const r=crypto.randomUUID();return new Promise((i,s)=>{var c;const a=u=>{if(u.origin!==n){console.error(`Blocked message from origin ${u.origin}`);return}if(u.data!==void 0){const{payload:l,responseId:m}=u.data;m===r&&(i(l),window.removeEventListener("message",a))}};window.addEventListener("message",a),(c=e.contentWindow)==null||c.postMessage({payload:t,requestId:r},n),setTimeout(()=>{s(),window.removeEventListener("message",a)},5e3)}).catch(()=>{})}async function Js(e,t){return Rn(e,{type:"getLTIRef",instituteId:t},"https://zone1.verity.yuja.com")}async function Mp(e,t,n,r,i){return await Rn(e,{type:"copyCheck",instituteId:t,courseId:n,assessmentId:r,quizType:i},"https://zone1.verity.yuja.com")||!1}async function Fp(e,t,n,r){return await Rn(e,{type:"isAssessmentVerityEnabled",instituteId:t,courseId:n,assessmentId:r},"https://zone1.verity.yuja.com")||!1}async function Ac(e){var t,n;if(navigator.userAgent.includes("VerityLockdown"))return!0;try{return!!((t=window.top)!=null&&t.proctor)}catch{if(e)try{return((n=await Rn(e,{type:"getPlatformInfo"},"https://zone1.verity.yuja.com"))==null?void 0:n.platform)==="lockdown"}catch(i){console.error(i)}return!1}}const Pc=new Map;async function Rc({extensionConnectIframe:e,instituteId:t,lmsProvidedCourseId:n,lmsProvidedAssessmentId:r,assessmentType:i}){const s=n+":"+r+(i?":"+i:""),a=Pc.get(s);if(a)return await a;const c=(async()=>(await Mp(e,t,n,r,i),await Fp(e,t,n,r)))();return Pc.set(s,c),await c}async function Dp(e,t,n,r){return await Rn(e,{type:"getProctoringOptions",instituteId:t,courseId:n,assessmentId:r},"https://zone1.verity.yuja.com")||void 0}async function _c(e,t){return await Rn(e,{type:"isVersionSupported",version:t},"https://zone1.verity.yuja.com")||!1}function Bp(){return!!window.chrome}const zp=e=>{const t=document.createElement("div");t.style.display="block",t.style.top="0vh",t.style.zIndex="99999999",t.style.position="fixed";const n=document.createElement("iframe");n.src="https://zone1.verity.yuja.com/launch/lockdownLaunch.html?url="+window.location.href,n.style.display="block",n.style.zIndex="99999999",n.style.width="100vw",n.style.height="100vh",n.style.overflow="auto",n.style.position="fixed",n.style.borderRadius="17px",n.style.borderColor="#BCBCBC",n.style.borderStyle="solid",n.style.borderWidth="1px",t.append(n),document.body.appendChild(t),window.addEventListener("message",r=>{var i;((i=r.data)==null?void 0:i.request)==="closeModalDiv"&&t.remove()}),n.onload=()=>{var r;(r=n.contentWindow)==null||r.postMessage({event:"lockdown-info",lockdownInfo:e},"https://zone1.verity.yuja.com")}};function Vp(e,t,n="https://zone1.verity.yuja.com"){const r=async()=>{var a;const s=await t();s&&(console.debug("Sending 'init-auth-instructions' message."),(a=e.contentWindow)==null||a.postMessage({...s,event:"init-auth-instructions"},n))};e.addEventListener("load",r);const i=s=>{var a;((a=s.data)==null?void 0:a.event)==="loaded"&&(r(),window.removeEventListener("message",i))};window.addEventListener("message",i)}function Cc(){[document.getElementById("yuja-authentication-instructions"),document.getElementById("yuja-download-instructions")].forEach(t=>t==null?void 0:t.remove())}function Ks(){Cc(),new MutationObserver(async t=>{for(const n of t)n.type==="childList"&&Cc()}).observe(document.body,{childList:!0,subtree:!0})}const qp={extension:["desktop-browser","chromeos-browser"],lockdown:["desktop-browser","desktop-lockdown"],mobile:["mobile-browser","mobile-lockdown"]};function Ws(){const e=navigator.userAgent||navigator.vendor;return/android|avantgo|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(40|60)|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|iPad/i.test(e)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1}function jc(){return navigator.userAgent.includes("CrOS")}function Gp(e="none"){return e==="lockdown"?"desktop-lockdown":e==="mobile"?"mobile-lockdown":Ws()?"mobile-browser":jc()?"chromeos-browser":"desktop-browser"}function Uc(e,t){return qp[e].includes(t)}function Zp(e){const t=n=>e({...n,type:`authenticated-page:${n.type}`});return{opened(n,r){return t({type:"opened",details:{type:n,url:r}})},detected(n){return t({type:"detected",details:{type:n}})},authenticateMessageSent(n){return t({type:"authenticate-message:sent",details:{message:n}})},authenticateMessageReceived(n,r){return t({type:"authenticate-message:received",details:{sender:n,message:r}})},authCodeSent(n,r){return t({type:"auth-code:sent",details:{origin:n,accountId:r}})},authCodeReceived(n,r){return t({type:"auth-code:received",details:{sender:n,message:r}})},authCodeExchanged(n,r){return t({type:"auth-code:exchanged",details:{accountId:n,userId:r}})},authenticated(n,r){return t({type:"authenticated",details:{accountId:n,userId:r}})},authenticationSkipped(n){return t({type:"authentication-skipped",details:{reason:n}})}}}function Jp(e){const t=n=>e({...n,type:`refresh-token:${n.type}`});return{received(n){return t({type:"received",details:{sender:n}})},refreshed(n,r){return t({type:"refreshed",details:{success:n,status:r}})},stored(){return t({type:"stored"})},cleared(){t({type:"cleared"})}}}function Kp(e){const t=n=>e({...n,type:`auth-code:${n.type}`});return{requested(n,r){return t({type:"requested",details:{purpose:n,accountId:r}})},created(n){return t({type:"created",details:{accountId:n}})},received(n,r){return t({type:"received",details:{accountId:n,sender:r}})}}}function Wp(e){const t=n=>e({...n,type:`auth:${n.type}`});return{accountIdReceived(n,r){return t({type:"account-id-received",details:{accountId:n,sender:r}})},refreshToken:Jp(t),authCode:Kp(t),authenticatedPage:Zp(t)}}function Hp(e){const t=n=>e({...n,type:`verity-checkbox:${n.type}`});return{injectionSkipped(n){return t({type:"injection-skipped",details:{reason:n}})},injected(n){return t({type:"injected",details:n})},initialOptionsReceived(n,r){return t({type:"initial-configuration-received",details:{configuration:n,options:r}})},statusChanged(n){return t({type:"status-changed",details:{enabled:n}})}}}function Yp(e){const t=n=>e({...n,type:`save-button:${n.type}`});return{replacementSkipped(n){return t({type:"replacement-skipped",details:{reason:n}})},replaced(n){return t({type:"replaced",details:{elementText:n}})},clicked(){return t({type:"clicked"})},saveStarted(n){return t({type:"save-started",details:n})},saveFinished(n){return t({type:"save-finished",details:{success:n}})},originalClicked(){return t({type:"original-clicked"})}}}function Xp(e){const t=n=>e({...n,type:`configuration-modal:${n.type}`});return{opened(){return t({type:"opened"})},saveStarted(n){return t({type:"save-started",details:{configuration:n}})},saveFinished(n,r){return t({type:"save-finished",details:{success:n,message:r}})},warningShown(n){return t({type:"warning-message",details:{warningType:n}})},closed(){return t({type:"closed"})}}}function Qp(e){const t=n=>e({...n,type:`edit:${n.type}`});return{detected(n){return t({type:"detected",details:n})},verityCheckbox:Hp(t),saveButton:Yp(t),configurationModal:Xp(t)}}function eh(e){const t=n=>e({...n,type:`start-button:${n.type}`});return{replacementSkipped(n){return t({type:"replacement-skipped",details:{reason:n}})},disabled(n){return t({type:"disabled",details:{elementText:n}})},enabled(n){return t({type:"enabled",details:{elementText:n}})},replaced(n){return t({type:"replaced",details:{elementText:n}})},clicked(){return t({type:"clicked"})},originalNotClicked(n){return t({type:"original-not-clicked",details:{reason:n}})},originalClicked(){return t({type:"original-clicked"})}}}function th(e){const t=n=>e({...n,type:`preview-dialog:${n.type}`});return{opened(){return t({type:"opened"})},closed(n){return t({type:"closed",details:{option:n}})}}}function nh(e){const t=n=>e({...n,type:`start-dialog:${n.type}`});return{opened(){return t({type:"opened"})},closed(n){return t({type:"closed",details:{option:n}})}}}function rh(e){const t=n=>e({...n,type:`context:${n.type}`});return{notSet(n){return t({type:"not-set",details:{reason:n}})},set(n){return t({type:"set",details:n})},consumed(n,r){return t({type:"consumed",details:{reason:n,pendingAssessment:r}})}}}function ih(e){const t=n=>e({...n,type:`password:${n.type}`});return{fillEnabled(){return t({type:"fill-enabled"})},fillDisabled(){return t({type:"fill-disabled"})}}}function sh(e){const t=n=>e({...n,type:`third-party:${n.type}`});return{startDialog:nh(t),context:rh(t),password:ih(t)}}function oh(e){const t=n=>e({...n,type:`start:${n.type}`});return{detected(n){return t({type:"detected",details:n})},injectionSkipped(n){return t({type:"injection-skipped",details:{reason:n}})},notifiedLms(n){return t({type:"notified-lms",details:n})},returnedToStartPage(n){return t({type:"returned-to-start-page",details:{url:n}})},startButton:eh(t),previewDialog:th(t),thirdParty:sh(t)}}function ah(e){const t=n=>e({...n,type:`interrupt:${n.type}`});return{created(n){return t({type:"created",details:n})},updated(n){return t({type:"updated",details:n})},deleted(n,r){return t({type:"deleted",details:{interrupt:n,newState:r}})}}}function xc(e){const{id:t,label:n,kind:r,contentHint:i,enabled:s,muted:a,readyState:c}=e;return{id:t,label:n,kind:r,contentHint:i,enabled:s,muted:a,readyState:c,settings:e.getSettings(),constraints:e.getConstraints(),capabilities:e.getCapabilities()}}function ch(e){return{id:e.id,active:e.active,video:e.getVideoTracks().map(xc),audio:e.getAudioTracks().map(xc)}}function Mc(e){return e.map(t=>t?ch(t):void 0).filter(t=>!!t)}function uh(e){const t=n=>e({...n,type:`user-media:${n.type}`});return{started(n,r){return t({type:"started",details:{...n,streams:Mc(r)}})},stopped(n){return t({type:"stopped",details:n})}}}function lh(e){const t=n=>e({...n,type:`display:${n.type}`});return{started(n,r){return t({type:"started",details:{...n,streams:Mc(r)}})},stopped(n){return t({type:"stopped",details:n})}}}function fh(e){const t=n=>e({...n,type:`recorder:${n.type}`});return{userMedia:uh(t),display:lh(t)}}function dh(e){const t=n=>e({...n,type:`live:${n.type}`});return{joined(n){return t({type:"joined",details:n})},left(n){return t({type:"left",details:n})}}}function ph(e){const t=n=>e({...n,type:`navigation:${n.type}`});return{blocked(n){return t({type:"blocked",details:n})}}}function hh(e){return{navigation:ph(n=>e({...n,type:`limiter:${n.type}`}))}}function mh(e){const t=n=>e({...n,type:`session:${n.type}`});return{started(n){return t({type:"started",details:n})},finished(n,r){return t({type:"finished",details:{taskId:n,proctoringSessionId:r}})},interrupt:ah(t),recorder:fh(t),limiter:hh(t),live:dh(t)}}function gh(e){const t=n=>e({...n,type:`setup:${n.type}`});return{notStarted(n){return t({type:"not-started",details:{reason:n}})},started(n){return t({type:"started",details:n})},cancelClicked(n){return t({type:"cancel-clicked",details:{taskId:n}})},cancelled(n,r){return t({type:"cancelled",details:{taskId:n,status:r}})},finishClicked(n){return t({type:"finish-clicked",details:{taskId:n}})},finished(n){return t({type:"finished",details:{taskId:n}})}}}function yh(e){const t=n=>e({...n,type:`password:${n.type}`});return{detected(n){return t({type:"detected",details:n})},fillSkipped(n){return t({type:"fill-skipped",details:{reason:n}})},filled(n){return t({type:"filled",details:{password:n}})},submitSkipped(n){return t({type:"submit-button:click-skipped",details:n})},submitClicked(){return t({type:"submit-button:clicked"})},incorrect(n,r){return t({type:"incorrect",details:{assessmentInfo:n,password:r}})}}}function wh(e){const t=n=>e({...n,type:`uploading-page:${n.type}`});return{opened(){return t({type:"opened"})}}}function bh(e){const t=n=>e({...n,type:`finished-page:${n.type}`});return{opened(n){return t({type:"opened",details:{type:n}})},closed(n){return t({type:"closed",details:{method:n}})}}}function vh(e){const t=n=>e({...n,type:`end:${n.type}`});return{detected(n){return t({type:"submit-detected",details:n})},notMatched(n){return t({type:"not-matched",details:n})},notifiedLms(n){return t({type:"notified-lms",details:n})},manuallyEnded(n){return t({type:"manually-ended",details:{type:n}})},uploadingPage:wh(t),finishedPage:bh(t)}}function Sh(e){const t=n=>e({...n,type:`take:${n.type}`});return{start:oh(t),session:mh(t),setup:gh(t),password:yh(t),end:vh(t)}}function kh(e){const t=n=>e({...n,type:`assessment:${n.type}`});return{edit:Qp(t),take:Sh(t)}}function Oh(e={context:{}}){let t=Promise.resolve(e);return{getState(){return t},async setState(n){t=t.then(async r=>{try{return await n(r)}catch(i){console.error(i)}return r})}}}function Ih({logFunction:e,getDynamicContext:t}){let n=[];const r=async s=>{const a=e({...s,context:s.context??(t==null?void 0:t()),time:s.time??new Date});return n.push(a),a==null||a.finally(()=>{n=n.filter(c=>c!==a)}),a},i=s=>(console.error("creating log for error",s),r({type:"error",details:{error:String(s),stack:s&&typeof s=="object"&&"stack"in s?s.stack:void 0}}));return{log:r,error:i,async capturePromiseError(s){try{return await s}catch(a){throw i(a),a}},authentication:Wp(r),assessment:kh(r),async dispose(){await Promise.allSettled(n)}}}function $h({platform:e,baseUrl:t,fetch:n,stateStore:r=Oh(),getDynamicContext:i}){const s=async l=>{try{const m=await n(`${t}/session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(m.ok)return m.json();console.error("session creation failed",m.status,l)}catch(m){console.error(m)}},a=async(l,m)=>{try{const g=await n(`${t}/${l}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});g.ok||console.error("logging failed",g.status,l,m)}catch(g){console.error(g)}};let c=Promise.resolve(r.getState());const u=()=>(c=c.then(async l=>{try{let{session:m,context:g}=await r.getState();return(!m||g.userId!==(m.userId||void 0)||!m.installationId&&g.installationId||!m.fingerprint&&g.fingerprint||!m.systemDetails&&g.systemDetails||!m.platformDetails&&g.platformDetails)&&(m=await s({...g,platform:e}),await r.setState(d=>({...d,session:m}))),{session:m,context:g}}catch(m){return console.error(m),l}}),c);return{...Ih({logFunction:async l=>{const m=l.time??new Date,{session:g,context:d}=await u();g&&await a(g.id,{proctoringSessionId:d.proctoringSessionId,liveSessionId:d.liveSessionId,...l,time:m})},getDynamicContext:i}),stateStore:r}}function Hs(e){this.message=e}Hs.prototype=new Error,Hs.prototype.name="InvalidCharacterError";var Fc=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new Hs("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,i=0,s=0,a="";r=t.charAt(s++);~r&&(n=i%4?64*n+r:r,i++%4)?a+=String.fromCharCode(255&n>>(-2*i&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return a};function Eh(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(n){return decodeURIComponent(Fc(n).replace(/(.)/g,function(r,i){var s=i.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}(t)}catch{return Fc(t)}}function yi(e){this.message=e}function Dc(e,t){if(typeof e!="string")throw new yi("Invalid token specified");var n=(t=t||{}).header===!0?0:1;try{return JSON.parse(Eh(e.split(".")[n]))}catch(r){throw new yi("Invalid token specified: "+r.message)}}yi.prototype=new Error,yi.prototype.name="InvalidTokenError";var _n=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Th(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ys={exports:{}},Cn=typeof Reflect=="object"?Reflect:null,Bc=Cn&&typeof Cn.apply=="function"?Cn.apply:function(t,n,r){return Function.prototype.apply.call(t,n,r)},wi;Cn&&typeof Cn.ownKeys=="function"?wi=Cn.ownKeys:Object.getOwnPropertySymbols?wi=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:wi=function(t){return Object.getOwnPropertyNames(t)};function Nh(e){console&&console.warn&&console.warn(e)}var zc=Number.isNaN||function(t){return t!==t};function X(){X.init.call(this)}Ys.exports=X,Ys.exports.once=Rh,X.EventEmitter=X,X.prototype._events=void 0,X.prototype._eventsCount=0,X.prototype._maxListeners=void 0;var Vc=10;function bi(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(X,"defaultMaxListeners",{enumerable:!0,get:function(){return Vc},set:function(e){if(typeof e!="number"||e<0||zc(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Vc=e}}),X.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},X.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||zc(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function qc(e){return e._maxListeners===void 0?X.defaultMaxListeners:e._maxListeners}X.prototype.getMaxListeners=function(){return qc(this)},X.prototype.emit=function(t){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var a;if(n.length>0&&(a=n[0]),a instanceof Error)throw a;var c=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw c.context=a,c}var u=s[t];if(u===void 0)return!1;if(typeof u=="function")Bc(u,this,n);else for(var l=u.length,m=Wc(u,l),r=0;r<l;++r)Bc(m[r],this,n);return!0};function Gc(e,t,n,r){var i,s,a;if(bi(n),s=e._events,s===void 0?(s=e._events=Object.create(null),e._eventsCount=0):(s.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),a=s[t]),a===void 0)a=s[t]=n,++e._eventsCount;else if(typeof a=="function"?a=s[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),i=qc(e),i>0&&a.length>i&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,Nh(c)}return e}X.prototype.addListener=function(t,n){return Gc(this,t,n,!1)},X.prototype.on=X.prototype.addListener,X.prototype.prependListener=function(t,n){return Gc(this,t,n,!0)};function Lh(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Zc(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=Lh.bind(r);return i.listener=n,r.wrapFn=i,i}X.prototype.once=function(t,n){return bi(n),this.on(t,Zc(this,t,n)),this},X.prototype.prependOnceListener=function(t,n){return bi(n),this.prependListener(t,Zc(this,t,n)),this},X.prototype.removeListener=function(t,n){var r,i,s,a,c;if(bi(n),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||n));else if(typeof r!="function"){for(s=-1,a=r.length-1;a>=0;a--)if(r[a]===n||r[a].listener===n){c=r[a].listener,s=a;break}if(s<0)return this;s===0?r.shift():Ah(r,s),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,c||n)}return this},X.prototype.off=X.prototype.removeListener,X.prototype.removeAllListeners=function(t){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var s=Object.keys(r),a;for(i=0;i<s.length;++i)a=s[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[t],typeof n=="function")this.removeListener(t,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(t,n[i]);return this};function Jc(e,t,n){var r=e._events;if(r===void 0)return[];var i=r[t];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?Ph(i):Wc(i,i.length)}X.prototype.listeners=function(t){return Jc(this,t,!0)},X.prototype.rawListeners=function(t){return Jc(this,t,!1)},X.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Kc.call(e,t)},X.prototype.listenerCount=Kc;function Kc(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}X.prototype.eventNames=function(){return this._eventsCount>0?wi(this._events):[]};function Wc(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function Ah(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function Ph(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function Rh(e,t){return new Promise(function(n,r){function i(a){e.removeListener(t,s),r(a)}function s(){typeof e.removeListener=="function"&&e.removeListener("error",i),n([].slice.call(arguments))}Hc(e,t,s,{once:!0}),t!=="error"&&_h(e,i,{once:!0})})}function _h(e,t,n){typeof e.on=="function"&&Hc(e,"error",t,n)}function Hc(e,t,n,r){if(typeof e.on=="function")r.once?e.once(t,n):e.on(t,n);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(s){r.once&&e.removeEventListener(t,i),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var Ch=Ys.exports;const Yc=Th(Ch),M=class M{constructor(t,n){h(this,"config");h(this,"schemaValidators");h(this,"emitter");h(this,"fetchPromise");this.config=t,this.schemaValidators=n,this.emitter=new Yc,M.tokenLock=null,M.tokenUnlock=()=>{},M.tokenTimeOut=null,M.tokenUseBuffer=null,M.callId=0,M.debug=!1,M.apiRouteConfig=null}log(t,...n){M.debug&&console.error(`[API-CLIENT] ${t}`,...n)}async setAccessToken(t){this.log(`Setting access token to ${t}`),await this.config.setAccessToken(t),this.emitter.emit("access-token-updated",t?Dc(t):void 0),this.updateApiRouteConfig(),this.log(`Set access token to ${t}`)}async getAccessToken(){this.log("Getting access token");const t=await this.config.getAccessToken();return this.log(`Got access token ${t}`),t}async setRefreshToken(t){this.log(`Setting refresh token to ${t}`),await this.config.setRefreshToken(t),this.log(`Set refresh token to ${t}`)}async getRefreshToken(){this.log("Getting refresh token");const t=await this.config.getRefreshToken();return this.log(`Got refresh token ${t}`),t}async setAccountId(t){this.log(`Setting account id to ${t}`),await this.config.setAccountId(t),this.log(`Set account id to ${t}`)}async getAccountId(){this.log("Getting account id");const t=await this.config.getAccountId();return this.log(`Got account id ${t}`),t}async getLocalRefreshedTime(){this.log("Getting local refreshed time");const t=await this.config.getLocalRefreshedTime();return this.log(`Got local refreshed time ${t}`),t}async setLocalRefreshedTime(t){this.log(`Setting local refreshed time to ${t}`),await this.config.setLocalRefreshedTime(t),this.log(`Set local refreshed time to ${t}`)}async updateTokens(){var n;const t=M.callId++;if(this.log(`[Call ${t}] Updating tokens`),M.tokenLock){this.log(`[Call ${t}] Waiting for another updateTokens to finish`),await M.tokenLock,this.log(`[Call ${t}] Another updateTokens finished`);return}else this.log(`[Call ${t}] Setting new token lock`),M.tokenLock=new Promise(r=>{M.tokenUnlock=()=>{r(!0),M.tokenLock=null},M.tokenTimeOut=setTimeout(()=>{r(!1),M.tokenLock=null},1e4)});try{if(M.tokenUseBuffer){this.log(`[Call ${t}] Waiting for token buffer to finish`),await M.tokenUseBuffer,this.log(`[Call ${t}] Token buffer finished`);return}const r=await this.getAccountId(),i=await this.getRefreshToken();if(!r||!i){this.log(`[Call ${t}] No accountId or refreshToken, not updating tokens`);return}const s=`${r}:${i}`,a=M.isRefreshPayloadValidMap.get(s);if(a!==void 0&&!a){this.log(`[Call ${t}] Refresh payload is invalid, not updating tokens`);return}const c=await fetch(`${this.config.verityOrigin}/api/access-control/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accountId:r,refreshToken:i})});if(this.emitter.emit("refresh",c),this.log(`[Call ${t}] Response received from refresh`,c),c.ok){const{accessToken:u,refreshToken:l}=await c.json();typeof u=="string"&&await this.setAccessToken(u),typeof l=="string"&&await this.setRefreshToken(l),await this.setLocalRefreshedTime(Date.now())}else this.log(`[Call ${t}] Response not ok from refresh`,c),M.isRefreshPayloadValidMap.set(s,!1)}catch(r){this.log(`[Call ${t}] Error updating tokens`,r)}finally{this.log(`[Call ${t}] Clearing token timeout`),M.tokenTimeOut&&clearTimeout(M.tokenTimeOut),this.log(`[Call ${t}] Freeing token lock`),(n=M.tokenUnlock)==null||n.call(M,!1),this.log(`[Call ${t}] Creating token buffer`),M.tokenUseBuffer=new Promise(r=>{setTimeout(()=>{r(!0),M.tokenUseBuffer=null},100)}),this.log(`[Call ${t}] Finished token update`)}}async getJwt(){this.log("Getting JWT");const t=await this.getAccessToken();if(!t)return;const n=Dc(t);return this.log("Got JWT",n),n}async resetAccessToken(){this.log("Resetting access token"),await this.setAccessToken(void 0),await fetch(`${this.config.verityOrigin}/api/verity/session/end`,{credentials:"include"}),this.emitter.emit("access-token-updated",void 0),this.log("Reset access token")}async generateAuthorizationHeader(){this.log("Generating authorization header");const t=await this.getAccessToken();return this.log("Got authorization header",{Authorization:`Bearer ${t}`}),{Authorization:`Bearer ${t}`}}async applyAuthenticatedFetchParams(...t){this.log("Generating authenticated fetch parameters");const[n,r]=t;if(!await this.getAccessToken())return[n,r];try{const i=await this.generateAuthorizationHeader();if(n instanceof Request&&!(r!=null&&r.headers))return Object.entries(i).forEach(([s,a])=>n.headers.set(s,a)),this.log("Generated authenticated fetch parameters",{originalInput:n,originalInit:r,authHeader:i}),[n,r];{const s={...r,headers:{...r==null?void 0:r.headers,...i}};return this.log("Generated authenticated fetch parameters",{originalInput:n,originalInit:r,authHeader:i,modifiedInit:s}),[n,s]}}catch(i){return this.log("Failed to generate authenticated fetch parameters",i),[n,r]}}async updateApiRouteConfig(){try{this.log("Updating API route config");const t=await fetch(`${this.config.verityOrigin}/api/verity/version/config`,{headers:{...await this.generateAuthorizationHeader()}});if(!t.ok)throw new Error("Failed to update API route config");const n=await t.json();if(typeof n!="object"||!n)throw new Error("Invalid API route config");const r=n;M.apiRouteConfig=r,this.log("Updated API route config",r)}catch(t){M.apiRouteConfig=null,this.log("Failed to update API route config",t)}}applyApiRouteConfig(...t){const[n,r]=t;try{if(this.log("Using API route config"),!M.apiRouteConfig)return[n,r];const i=n instanceof Request?n.url:n instanceof URL?n.toString():n;for(const{route:s,version:a}of M.apiRouteConfig)if(i.includes(s)){if(this.log(`Using API route config for route ${s}`),n instanceof Request&&!(r!=null&&r.headers))return Object.entries({"X-Api-Version":a}).forEach(([c,u])=>n.headers.set(c,u)),this.log("Generated API route config",{originalInput:n,originalInit:r,version:a,headers:n.headers}),[n,r];{const c={...r,headers:{...r==null?void 0:r.headers,"X-Api-Version":a}};return this.log("Generated API route config",{originalInput:n,originalInit:r,version:a,headers:c.headers}),[n,c]}}return this.log(`No API route config found for route ${i}`),[n,r]}catch(i){return this.log("Failed to use API route config",i),[n,r]}}getRouteVersion(t){var n;return M.apiRouteConfig?((n=M.apiRouteConfig.find(r=>t.includes(r.route)))==null?void 0:n.version)??"v1":"v1"}async applyFetchOverrides(...t){const[n,r]=t;try{const[i,s]=await this.applyAuthenticatedFetchParams(n,r),[a,c]=this.applyApiRouteConfig(i,s);return this.log("Applying fetch overrides",{input:a,init:c}),[a,c]}catch(i){return this.log("Failed to apply fetch overrides",i),[n,r]}}cloneFetchParams(...t){const[n,r]=t;return n instanceof Request?[new Request(n),r?{...r}:void 0]:[n,r?{...r}:void 0]}async fetch(...t){return this.log("Fetching",t),this.fetchPromise&&await this.fetchPromise,this.fetchPromise=(async()=>{const n=await fetch(...await this.applyFetchOverrides(...this.cloneFetchParams(...t)));if(this.log("Fetch response",n),n.status===401||n.status===403){this.log("Token expired, updating tokens"),await this.updateTokens(),this.log("Token updated, retrying fetch");const[r,i]=await this.applyFetchOverrides(...this.cloneFetchParams(...t));return await fetch(r,i)}return this.fetchPromise=void 0,n})(),await this.fetchPromise}clearCookies(){document&&document.cookie&&document.cookie.split(";").forEach(n=>{const[r]=n.split("=");document.cookie=`${r}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=${window.location.hostname}`})}};h(M,"tokenLock"),h(M,"tokenUnlock"),h(M,"tokenTimeOut"),h(M,"tokenUseBuffer"),h(M,"callId"),h(M,"debug"),h(M,"apiRouteConfig"),h(M,"isRefreshPayloadValidMap",new Map);let U=M;function Xc(e){return vi(e)&&Symbol.asyncIterator in e}function Qc(e){return vi(e)&&Symbol.iterator in e}function jh(e){return vi(e)&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function eu(e){return e instanceof Promise}function Xs(e){return e instanceof Date&&Number.isFinite(e.getTime())}function Qs(e){return e instanceof globalThis.Uint8Array}function vi(e){return e!==null&&typeof e=="object"}function jn(e){return Array.isArray(e)&&!ArrayBuffer.isView(e)}function Si(e){return e===void 0}function eo(e){return e===null}function to(e){return typeof e=="boolean"}function Zt(e){return typeof e=="number"}function tu(e){return Number.isInteger(e)}function no(e){return typeof e=="bigint"}function Jt(e){return typeof e=="string"}function nu(e){return typeof e=="function"}function ro(e){return typeof e=="symbol"}var it;(function(e){e.ExactOptionalPropertyTypes=!1,e.AllowArrayObject=!1,e.AllowNaN=!1,e.AllowNullVoid=!1;function t(a,c){return e.ExactOptionalPropertyTypes?c in a:a[c]!==void 0}e.IsExactOptionalProperty=t;function n(a){const c=vi(a);return e.AllowArrayObject?c:c&&!jn(a)}e.IsObjectLike=n;function r(a){return n(a)&&!(a instanceof Date)&&!(a instanceof Uint8Array)}e.IsRecordLike=r;function i(a){return e.AllowNaN?Zt(a):Number.isFinite(a)}e.IsNumberLike=i;function s(a){const c=Si(a);return e.AllowNullVoid?c||a===null:c}e.IsVoidLike=s})(it||(it={}));const io=new Map;function so(e){return io.has(e)}function Uh(e,t){io.set(e,t)}function ru(e){return io.get(e)}const oo=new Map;function ki(e){return oo.has(e)}function xh(e,t){oo.set(e,t)}function iu(e){return oo.get(e)}const Tt=Symbol.for("TypeBox.Transform"),Oi=Symbol.for("TypeBox.Readonly"),Kt=Symbol.for("TypeBox.Optional"),Ii=Symbol.for("TypeBox.Hint"),C=Symbol.for("TypeBox.Kind");function su(e={}){return{...e,[C]:e[C]??"Unsafe"}}class wt extends Error{constructor(t){super(t)}}class Mh extends wt{constructor(t){super(`Duplicate type kind '${t}' detected`)}}class Fh extends wt{constructor(t){super(`Duplicate string format '${t}' detected`)}}var ou;(function(e){function t(r,i){if(ki(r))throw new Mh(r);return xh(r,i),(s={})=>su({...s,[C]:r})}e.Type=t;function n(r,i){if(so(r))throw new Fh(r);return Uh(r,i),r}e.Format=n})(ou||(ou={}));function Pe(e){return{[C]:"MappedResult",properties:e}}function Dh(e){return $e(e)&&!Nt(e)&&!Ei(e)&&Symbol.asyncIterator in e}function Nt(e){return Array.isArray(e)}function au(e){return typeof e=="bigint"}function $i(e){return typeof e=="boolean"}function cu(e){return e instanceof globalThis.Date}function Bh(e){return typeof e=="function"}function zh(e){return $e(e)&&!Nt(e)&&!Ei(e)&&Symbol.iterator in e}function Vh(e){return e===null}function Wt(e){return typeof e=="number"}function $e(e){return typeof e=="object"&&e!==null}function qh(e){return e instanceof globalThis.RegExp}function Se(e){return typeof e=="string"}function Gh(e){return typeof e=="symbol"}function Ei(e){return e instanceof globalThis.Uint8Array}function ge(e){return e===void 0}function Zh(e){return e.map(t=>Ti(t))}function Jh(e){return new Date(e.getTime())}function Kh(e){return new Uint8Array(e)}function Wh(e){return new RegExp(e.source,e.flags)}function Hh(e){const t={};for(const n of Object.getOwnPropertyNames(e))t[n]=Ti(e[n]);for(const n of Object.getOwnPropertySymbols(e))t[n]=Ti(e[n]);return t}function Ti(e){return Nt(e)?Zh(e):cu(e)?Jh(e):Ei(e)?Kh(e):qh(e)?Wh(e):$e(e)?Hh(e):e}function Yh(e){return Ti(e)}function Xe(e){return e.map(t=>x(t))}function x(e,t={}){return{...Yh(e),...t}}function Xh(e,t){const{[t]:n,...r}=e;return r}function st(e,t){return t.reduce((n,r)=>Xh(n,r),e)}function uu(e,t={}){return{...t,[C]:"Array",type:"array",items:x(e)}}function lu(e,t={}){return{...t,[C]:"AsyncIterator",type:"AsyncIterator",items:x(e)}}function fu(e,t,n){return{...n,[C]:"Constructor",type:"Constructor",parameters:Xe(e),returns:x(t)}}function Ni(e,t,n){return{...n,[C]:"Function",type:"Function",parameters:Xe(e),returns:x(t)}}function qe(e={}){return{...e,[C]:"Never",not:{}}}function Qh(e){return $e(e)&&e[Oi]==="Readonly"}function Un(e){return $e(e)&&e[Kt]==="Optional"}function em(e){return G(e,"Any")}function wr(e){return G(e,"Array")}function ao(e){return G(e,"AsyncIterator")}function du(e){return G(e,"BigInt")}function pu(e){return G(e,"Boolean")}function co(e){return G(e,"Constructor")}function tm(e){return G(e,"Date")}function uo(e){return G(e,"Function")}function Li(e){return G(e,"Integer")}function bt(e){return G(e,"Intersect")}function lo(e){return G(e,"Iterator")}function G(e,t){return $e(e)&&C in e&&e[C]===t}function br(e){return G(e,"Literal")}function fn(e){return G(e,"MappedKey")}function Qe(e){return G(e,"MappedResult")}function Ai(e){return G(e,"Never")}function nm(e){return G(e,"Not")}function rm(e){return G(e,"Null")}function Pi(e){return G(e,"Number")}function Lt(e){return G(e,"Object")}function Ri(e){return G(e,"Promise")}function hu(e){return G(e,"Record")}function mu(e){return G(e,"Ref")}function gu(e){return G(e,"RegExp")}function fo(e){return G(e,"String")}function im(e){return G(e,"Symbol")}function dn(e){return G(e,"TemplateLiteral")}function sm(e){return G(e,"This")}function po(e){return $e(e)&&Tt in e}function xn(e){return G(e,"Tuple")}function om(e){return G(e,"Undefined")}function Re(e){return G(e,"Union")}function am(e){return G(e,"Uint8Array")}function cm(e){return G(e,"Unknown")}function um(e){return G(e,"Unsafe")}function lm(e){return G(e,"Void")}function fm(e){return $e(e)&&C in e&&Se(e[C])}function pn(e){return em(e)||wr(e)||pu(e)||du(e)||ao(e)||co(e)||tm(e)||uo(e)||Li(e)||bt(e)||lo(e)||br(e)||fn(e)||Qe(e)||Ai(e)||nm(e)||rm(e)||Pi(e)||Lt(e)||Ri(e)||hu(e)||mu(e)||gu(e)||fo(e)||im(e)||dn(e)||sm(e)||xn(e)||om(e)||Re(e)||am(e)||cm(e)||um(e)||lm(e)||fm(e)}function dm(e){return st(x(e),[Kt])}function pm(e){return{...x(e),[Kt]:"Optional"}}function hm(e,t){return t===!1?dm(e):pm(e)}function hn(e,t){const n=t??!0;return Qe(e)?ym(e,n):hm(e,n)}function mm(e,t){const n={};for(const r of globalThis.Object.getOwnPropertyNames(e))n[r]=hn(e[r],t);return n}function gm(e,t){return mm(e.properties,t)}function ym(e,t){const n=gm(e,t);return Pe(n)}function ho(e,t){const n=e.every(i=>Lt(i)),r=pn(t.unevaluatedProperties)?{unevaluatedProperties:x(t.unevaluatedProperties)}:{};return t.unevaluatedProperties===!1||pn(t.unevaluatedProperties)||n?{...t,...r,[C]:"Intersect",type:"object",allOf:Xe(e)}:{...t,...r,[C]:"Intersect",allOf:Xe(e)}}function wm(e){return e.every(t=>Un(t))}function bm(e){return st(e,[Kt])}function yu(e){return e.map(t=>Un(t)?bm(t):t)}function vm(e,t){return wm(e)?hn(ho(yu(e),t)):ho(yu(e),t)}function wu(e,t={}){if(e.length===0)return qe(t);if(e.length===1)return x(e[0],t);if(e.some(n=>po(n)))throw new Error("Cannot intersect transform types");return vm(e,t)}function mn(e,t={}){if(e.length===0)return qe(t);if(e.length===1)return x(e[0],t);if(e.some(n=>po(n)))throw new Error("Cannot intersect transform types");return ho(e,t)}function mo(e,t){return{...t,[C]:"Union",anyOf:Xe(e)}}function Sm(e){return e.some(t=>Un(t))}function bu(e){return e.map(t=>Un(t)?km(t):t)}function km(e){return st(e,[Kt])}function Om(e,t){return Sm(e)?hn(mo(bu(e),t)):mo(bu(e),t)}function Mn(e,t={}){return e.length===0?qe(t):e.length===1?x(e[0],t):Om(e,t)}function Ge(e,t={}){return e.length===0?qe(t):e.length===1?x(e[0],t):mo(e,t)}class vu extends wt{}function Im(e){return e.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")}function go(e,t,n){return e[t]===n&&e.charCodeAt(t-1)!==92}function Ct(e,t){return go(e,t,"(")}function vr(e,t){return go(e,t,")")}function Su(e,t){return go(e,t,"|")}function $m(e){if(!(Ct(e,0)&&vr(e,e.length-1)))return!1;let t=0;for(let n=0;n<e.length;n++)if(Ct(e,n)&&(t+=1),vr(e,n)&&(t-=1),t===0&&n!==e.length-1)return!1;return!0}function Em(e){return e.slice(1,e.length-1)}function Tm(e){let t=0;for(let n=0;n<e.length;n++)if(Ct(e,n)&&(t+=1),vr(e,n)&&(t-=1),Su(e,n)&&t===0)return!0;return!1}function Nm(e){for(let t=0;t<e.length;t++)if(Ct(e,t))return!0;return!1}function Lm(e){let[t,n]=[0,0];const r=[];for(let s=0;s<e.length;s++)if(Ct(e,s)&&(t+=1),vr(e,s)&&(t-=1),Su(e,s)&&t===0){const a=e.slice(n,s);a.length>0&&r.push(Fn(a)),n=s+1}const i=e.slice(n);return i.length>0&&r.push(Fn(i)),r.length===0?{type:"const",const:""}:r.length===1?r[0]:{type:"or",expr:r}}function Am(e){function t(i,s){if(!Ct(i,s))throw new vu("TemplateLiteralParser: Index must point to open parens");let a=0;for(let c=s;c<i.length;c++)if(Ct(i,c)&&(a+=1),vr(i,c)&&(a-=1),a===0)return[s,c];throw new vu("TemplateLiteralParser: Unclosed group parens in expression")}function n(i,s){for(let a=s;a<i.length;a++)if(Ct(i,a))return[s,a];return[s,i.length]}const r=[];for(let i=0;i<e.length;i++)if(Ct(e,i)){const[s,a]=t(e,i),c=e.slice(s,a+1);r.push(Fn(c)),i=a}else{const[s,a]=n(e,i),c=e.slice(s,a);c.length>0&&r.push(Fn(c)),i=a-1}return r.length===0?{type:"const",const:""}:r.length===1?r[0]:{type:"and",expr:r}}function Fn(e){return $m(e)?Fn(Em(e)):Tm(e)?Lm(e):Nm(e)?Am(e):{type:"const",const:Im(e)}}function yo(e){return Fn(e.slice(1,e.length-1))}class Pm extends wt{}function Rm(e){return e.type==="or"&&e.expr.length===2&&e.expr[0].type==="const"&&e.expr[0].const==="0"&&e.expr[1].type==="const"&&e.expr[1].const==="[1-9][0-9]*"}function _m(e){return e.type==="or"&&e.expr.length===2&&e.expr[0].type==="const"&&e.expr[0].const==="true"&&e.expr[1].type==="const"&&e.expr[1].const==="false"}function Cm(e){return e.type==="const"&&e.const===".*"}function Sr(e){return Rm(e)||Cm(e)?!1:_m(e)?!0:e.type==="and"?e.expr.every(t=>Sr(t)):e.type==="or"?e.expr.every(t=>Sr(t)):e.type==="const"?!0:(()=>{throw new Pm("Unknown expression type")})()}function jm(e){const t=yo(e.pattern);return Sr(t)}class Um extends wt{}function*ku(e){if(e.length===1)return yield*e[0];for(const t of e[0])for(const n of ku(e.slice(1)))yield`${t}${n}`}function*xm(e){return yield*ku(e.expr.map(t=>[..._i(t)]))}function*Mm(e){for(const t of e.expr)yield*_i(t)}function*Fm(e){return yield e.const}function*_i(e){return e.type==="and"?yield*xm(e):e.type==="or"?yield*Mm(e):e.type==="const"?yield*Fm(e):(()=>{throw new Um("Unknown expression")})()}function Ou(e){const t=yo(e.pattern);return Sr(t)?[..._i(t)]:[]}function ye(e,t={}){return{...t,[C]:"Literal",const:e,type:typeof e}}function Iu(e={}){return{...e,[C]:"Boolean",type:"boolean"}}function wo(e={}){return{...e,[C]:"BigInt",type:"bigint"}}function Dn(e={}){return{...e,[C]:"Number",type:"number"}}function Ht(e={}){return{...e,[C]:"String",type:"string"}}function*Dm(e){const t=e.trim().replace(/"|'/g,"");return t==="boolean"?yield Iu():t==="number"?yield Dn():t==="bigint"?yield wo():t==="string"?yield Ht():yield(()=>{const n=t.split("|").map(r=>ye(r.trim()));return n.length===0?qe():n.length===1?n[0]:Mn(n)})()}function*Bm(e){if(e[1]!=="{"){const t=ye("$"),n=bo(e.slice(1));return yield*[t,...n]}for(let t=2;t<e.length;t++)if(e[t]==="}"){const n=Dm(e.slice(2,t)),r=bo(e.slice(t+1));return yield*[...n,...r]}yield ye(e)}function*bo(e){for(let t=0;t<e.length;t++)if(e[t]==="$"){const n=ye(e.slice(0,t)),r=Bm(e.slice(t));return yield*[n,...r]}yield ye(e)}function zm(e){return[...bo(e)]}const Vm="(true|false)",Ci="(0|[1-9][0-9]*)",$u="(.*)",kr=`^${Ci}$`,ji=`^${$u}$`;class qm extends wt{}function Gm(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Eu(e,t){return dn(e)?e.pattern.slice(1,e.pattern.length-1):Re(e)?`(${e.anyOf.map(n=>Eu(n,t)).join("|")})`:Pi(e)?`${t}${Ci}`:Li(e)?`${t}${Ci}`:du(e)?`${t}${Ci}`:fo(e)?`${t}${$u}`:br(e)?`${t}${Gm(e.const.toString())}`:pu(e)?`${t}${Vm}`:(()=>{throw new qm(`Unexpected Kind '${e[C]}'`)})()}function Tu(e){return`^${e.map(t=>Eu(t,"")).join("")}$`}function Ui(e){const n=Ou(e).map(r=>ye(r));return Mn(n)}function Nu(e,t={}){const n=Se(e)?Tu(zm(e)):Tu(e);return{...t,[C]:"TemplateLiteral",type:"string",pattern:n}}function Zm(e){return Ou(e).map(n=>n.toString())}function Jm(e){const t=[];for(const n of e)t.push(...Yt(n));return t}function Km(e){return[e.toString()]}function Yt(e){return[...new Set(dn(e)?Zm(e):Re(e)?Jm(e.anyOf):br(e)?Km(e.const):Pi(e)?["[number]"]:Li(e)?["[number]"]:[])]}function Wm(e,t,n){const r={};for(const i of Object.getOwnPropertyNames(t))r[i]=vo(e,Yt(t[i]),n);return r}function Hm(e,t,n){return Wm(e,t.properties,n)}function Ym(e,t,n){const r=Hm(e,t,n);return Pe(r)}function Lu(e,t){return e.map(n=>Au(n,t))}function Xm(e){return e.filter(t=>!Ai(t))}function Qm(e,t){return wu(Xm(Lu(e,t)))}function eg(e){return e.some(t=>Ai(t))?[]:e}function tg(e,t){return Mn(eg(Lu(e,t)))}function ng(e,t){return t in e?e[t]:t==="[number]"?Mn(e):qe()}function rg(e,t){return t==="[number]"?e:qe()}function ig(e,t){return t in e?e[t]:qe()}function Au(e,t){return bt(e)?Qm(e.allOf,t):Re(e)?tg(e.anyOf,t):xn(e)?ng(e.items??[],t):wr(e)?rg(e.items,t):Lt(e)?ig(e.properties,t):qe()}function Pu(e,t){return t.map(n=>Au(e,n))}function Ru(e,t){return Mn(Pu(e,t))}function vo(e,t,n={}){return Qe(t)?x(Ym(e,t,n)):fn(t)?x(cg(e,t,n)):pn(t)?x(Ru(e,Yt(t)),n):x(Ru(e,t),n)}function sg(e,t,n){return{[t]:vo(e,[t],n)}}function og(e,t,n){return t.reduce((r,i)=>({...r,...sg(e,i,n)}),{})}function ag(e,t,n){return og(e,t.keys,n)}function cg(e,t,n){const r=ag(e,t,n);return Pe(r)}function _u(e,t={}){return{...t,[C]:"Iterator",type:"Iterator",items:x(e)}}function ug(e,t={}){const n=globalThis.Object.getOwnPropertyNames(e),r=n.filter(c=>Un(e[c])),i=n.filter(c=>!r.includes(c)),s=pn(t.additionalProperties)?{additionalProperties:x(t.additionalProperties)}:{},a={};for(const c of n)a[c]=x(e[c]);return i.length>0?{...t,...s,[C]:"Object",type:"object",properties:a,required:i}:{...t,...s,[C]:"Object",type:"object",properties:a}}const Ne=ug;function Cu(e,t={}){return{...t,[C]:"Promise",type:"Promise",item:x(e)}}function lg(e){return st(x(e),[Oi])}function fg(e){return{...x(e),[Oi]:"Readonly"}}function dg(e,t){return t===!1?lg(e):fg(e)}function gn(e,t){const n=t??!0;return Qe(e)?mg(e,n):dg(e,n)}function pg(e,t){const n={};for(const r of globalThis.Object.getOwnPropertyNames(e))n[r]=gn(e[r],t);return n}function hg(e,t){return pg(e.properties,t)}function mg(e,t){const n=hg(e,t);return Pe(n)}function Or(e,t={}){const[n,r,i]=[!1,e.length,e.length];return e.length>0?{...t,[C]:"Tuple",type:"array",items:Xe(e),additionalItems:n,minItems:r,maxItems:i}:{...t,[C]:"Tuple",type:"array",minItems:r,maxItems:i}}function gg(e,t){return e.includes(t)}function yg(e){return[...new Set(e)]}function wg(e,t){return e.filter(n=>t.includes(n))}function bg(e,t){return e.reduce((n,r)=>wg(n,r),t)}function vg(e){return e.length===1?e[0]:e.length>1?bg(e.slice(1),e[0]):[]}function Sg(e){const t=[];for(const n of e)t.push(...n);return t}function ju(e,t){return e in t?ot(e,t[e]):Pe(t)}function kg(e){return{[e]:ye(e)}}function Og(e){const t={};for(const n of e)t[n]=ye(n);return t}function Ig(e,t){return gg(t,e)?kg(e):Og(t)}function $g(e,t){const n=Ig(e,t);return ju(e,n)}function Ir(e,t){return t.map(n=>ot(e,n))}function Eg(e,t){const n={};for(const r of globalThis.Object.getOwnPropertyNames(t))n[r]=ot(e,t[r]);return n}function ot(e,t){return Un(t)?hn(ot(e,st(t,[Kt]))):Qh(t)?gn(ot(e,st(t,[Oi]))):Qe(t)?ju(e,t.properties):fn(t)?$g(e,t.keys):co(t)?fu(Ir(e,t.parameters),ot(e,t.returns)):uo(t)?Ni(Ir(e,t.parameters),ot(e,t.returns)):ao(t)?lu(ot(e,t.items)):lo(t)?_u(ot(e,t.items)):bt(t)?mn(Ir(e,t.allOf)):Re(t)?Ge(Ir(e,t.anyOf)):xn(t)?Or(Ir(e,t.items??[])):Lt(t)?Ne(Eg(e,t.properties)):wr(t)?uu(ot(e,t.items)):Ri(t)?Cu(ot(e,t.item)):t}function Tg(e,t){const n={};for(const r of e)n[r]=ot(r,t);return n}function Ng(e,t,n={}){const r=pn(e)?Yt(e):e,i=t({[C]:"MappedKey",keys:r}),s=Tg(r,i);return x(Ne(s),n)}function Uu(e){const t=[];for(const n of e)t.push(xi(n));return t}function Lg(e){const t=Uu(e);return Sg(t)}function Ag(e){const t=Uu(e);return vg(t)}function Pg(e){return e.map((t,n)=>n.toString())}function Rg(e){return["[number]"]}function _g(e){return globalThis.Object.getOwnPropertyNames(e)}function Cg(e){return So?globalThis.Object.getOwnPropertyNames(e).map(n=>n[0]==="^"&&n[n.length-1]==="$"?n.slice(1,n.length-1):n):[]}function xi(e){return bt(e)?Lg(e.allOf):Re(e)?Ag(e.anyOf):xn(e)?Pg(e.items??[]):wr(e)?Rg(e.items):Lt(e)?_g(e.properties):hu(e)?Cg(e.patternProperties):[]}let So=!1;function Mi(e){So=!0;const t=xi(e);return So=!1,`^(${t.map(r=>`(${r})`).join("|")})$`}function jg(e){return e.map(t=>t==="[number]"?Dn():ye(t))}function xu(e,t={}){if(Qe(e))return Mg(e,t);{const n=xi(e),r=jg(n),i=Mn(r);return x(i,t)}}function Ug(e,t){const n={};for(const r of globalThis.Object.getOwnPropertyNames(e))n[r]=xu(e[r],t);return n}function xg(e,t){return Ug(e.properties,t)}function Mg(e,t){const n=xg(e,t);return Pe(n)}function Fg(e){return e.allOf.every(t=>$r(t))}function Dg(e){return e.anyOf.some(t=>$r(t))}function Bg(e){return!$r(e.not)}function $r(e){return e[C]==="Intersect"?Fg(e):e[C]==="Union"?Dg(e):e[C]==="Not"?Bg(e):e[C]==="Undefined"}function zg(e){switch(e.errorType){case S.ArrayContains:return"Expected array to contain at least one matching value";case S.ArrayMaxContains:return`Expected array to contain no more than ${e.schema.maxContains} matching values`;case S.ArrayMinContains:return`Expected array to contain at least ${e.schema.minContains} matching values`;case S.ArrayMaxItems:return`Expected array length to be less or equal to ${e.schema.maxItems}`;case S.ArrayMinItems:return`Expected array length to be greater or equal to ${e.schema.minItems}`;case S.ArrayUniqueItems:return"Expected array elements to be unique";case S.Array:return"Expected array";case S.AsyncIterator:return"Expected AsyncIterator";case S.BigIntExclusiveMaximum:return`Expected bigint to be less than ${e.schema.exclusiveMaximum}`;case S.BigIntExclusiveMinimum:return`Expected bigint to be greater than ${e.schema.exclusiveMinimum}`;case S.BigIntMaximum:return`Expected bigint to be less or equal to ${e.schema.maximum}`;case S.BigIntMinimum:return`Expected bigint to be greater or equal to ${e.schema.minimum}`;case S.BigIntMultipleOf:return`Expected bigint to be a multiple of ${e.schema.multipleOf}`;case S.BigInt:return"Expected bigint";case S.Boolean:return"Expected boolean";case S.DateExclusiveMinimumTimestamp:return`Expected Date timestamp to be greater than ${e.schema.exclusiveMinimumTimestamp}`;case S.DateExclusiveMaximumTimestamp:return`Expected Date timestamp to be less than ${e.schema.exclusiveMaximumTimestamp}`;case S.DateMinimumTimestamp:return`Expected Date timestamp to be greater or equal to ${e.schema.minimumTimestamp}`;case S.DateMaximumTimestamp:return`Expected Date timestamp to be less or equal to ${e.schema.maximumTimestamp}`;case S.DateMultipleOfTimestamp:return`Expected Date timestamp to be a multiple of ${e.schema.multipleOfTimestamp}`;case S.Date:return"Expected Date";case S.Function:return"Expected function";case S.IntegerExclusiveMaximum:return`Expected integer to be less than ${e.schema.exclusiveMaximum}`;case S.IntegerExclusiveMinimum:return`Expected integer to be greater than ${e.schema.exclusiveMinimum}`;case S.IntegerMaximum:return`Expected integer to be less or equal to ${e.schema.maximum}`;case S.IntegerMinimum:return`Expected integer to be greater or equal to ${e.schema.minimum}`;case S.IntegerMultipleOf:return`Expected integer to be a multiple of ${e.schema.multipleOf}`;case S.Integer:return"Expected integer";case S.IntersectUnevaluatedProperties:return"Unexpected property";case S.Intersect:return"Expected all values to match";case S.Iterator:return"Expected Iterator";case S.Literal:return`Expected ${typeof e.schema.const=="string"?`'${e.schema.const}'`:e.schema.const}`;case S.Never:return"Never";case S.Not:return"Value should not match";case S.Null:return"Expected null";case S.NumberExclusiveMaximum:return`Expected number to be less than ${e.schema.exclusiveMaximum}`;case S.NumberExclusiveMinimum:return`Expected number to be greater than ${e.schema.exclusiveMinimum}`;case S.NumberMaximum:return`Expected number to be less or equal to ${e.schema.maximum}`;case S.NumberMinimum:return`Expected number to be greater or equal to ${e.schema.minimum}`;case S.NumberMultipleOf:return`Expected number to be a multiple of ${e.schema.multipleOf}`;case S.Number:return"Expected number";case S.Object:return"Expected object";case S.ObjectAdditionalProperties:return"Unexpected property";case S.ObjectMaxProperties:return`Expected object to have no more than ${e.schema.maxProperties} properties`;case S.ObjectMinProperties:return`Expected object to have at least ${e.schema.minProperties} properties`;case S.ObjectRequiredProperty:return"Required property";case S.Promise:return"Expected Promise";case S.RegExp:return"Expected string to match regular expression";case S.StringFormatUnknown:return`Unknown format '${e.schema.format}'`;case S.StringFormat:return`Expected string to match '${e.schema.format}' format`;case S.StringMaxLength:return`Expected string length less or equal to ${e.schema.maxLength}`;case S.StringMinLength:return`Expected string length greater or equal to ${e.schema.minLength}`;case S.StringPattern:return`Expected string to match '${e.schema.pattern}'`;case S.String:return"Expected string";case S.Symbol:return"Expected symbol";case S.TupleLength:return`Expected tuple to have ${e.schema.maxItems||0} elements`;case S.Tuple:return"Expected tuple";case S.Uint8ArrayMaxByteLength:return`Expected byte length less or equal to ${e.schema.maxByteLength}`;case S.Uint8ArrayMinByteLength:return`Expected byte length greater or equal to ${e.schema.minByteLength}`;case S.Uint8Array:return"Expected Uint8Array";case S.Undefined:return"Expected undefined";case S.Union:return"Expected union value";case S.Void:return"Expected void";case S.Kind:return`Expected kind '${e.schema[C]}'`;default:return"Unknown error type"}}let Vg=zg;function qg(){return Vg}class Gg extends wt{constructor(t){super(`Unable to dereference schema with $id '${t.$id}'`),this.schema=t}}function Zg(e,t){const n=t.find(r=>r.$id===e.$ref);if(n===void 0)throw new Gg(e);return Er(n,t)}function Er(e,t){return e[C]==="This"||e[C]==="Ref"?Zg(e,t):e}class Jg extends wt{constructor(t){super("Unable to hash value"),this.value=t}}var et;(function(e){e[e.Undefined=0]="Undefined",e[e.Null=1]="Null",e[e.Boolean=2]="Boolean",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Object=5]="Object",e[e.Array=6]="Array",e[e.Date=7]="Date",e[e.Uint8Array=8]="Uint8Array",e[e.Symbol=9]="Symbol",e[e.BigInt=10]="BigInt"})(et||(et={}));let Bn=BigInt("14695981039346656037");const[Kg,Wg]=[BigInt("1099511628211"),BigInt("2")**BigInt("64")],Hg=Array.from({length:256}).map((e,t)=>BigInt(t)),Mu=new Float64Array(1),Fu=new DataView(Mu.buffer),Du=new Uint8Array(Mu.buffer);function*Yg(e){const t=e===0?1:Math.ceil(Math.floor(Math.log2(e)+1)/8);for(let n=0;n<t;n++)yield e>>8*(t-1-n)&255}function Xg(e){Be(et.Array);for(const t of e)zn(t)}function Qg(e){Be(et.Boolean),Be(e?1:0)}function ey(e){Be(et.BigInt),Fu.setBigInt64(0,e);for(const t of Du)Be(t)}function ty(e){Be(et.Date),zn(e.getTime())}function ny(e){Be(et.Null)}function ry(e){Be(et.Number),Fu.setFloat64(0,e);for(const t of Du)Be(t)}function iy(e){Be(et.Object);for(const t of globalThis.Object.getOwnPropertyNames(e).sort())zn(t),zn(e[t])}function sy(e){Be(et.String);for(let t=0;t<e.length;t++)for(const n of Yg(e.charCodeAt(t)))Be(n)}function oy(e){Be(et.Symbol),zn(e.description)}function ay(e){Be(et.Uint8Array);for(let t=0;t<e.length;t++)Be(e[t])}function cy(e){return Be(et.Undefined)}function zn(e){if(jn(e))return Xg(e);if(to(e))return Qg(e);if(no(e))return ey(e);if(Xs(e))return ty(e);if(eo(e))return ny();if(Zt(e))return ry(e);if(jh(e))return iy(e);if(Jt(e))return sy(e);if(ro(e))return oy(e);if(Qs(e))return ay(e);if(Si(e))return cy();throw new Jg(e)}function Be(e){Bn=Bn^Hg[e],Bn=Bn*Kg%Wg}function Bu(e){return Bn=BigInt("14695981039346656037"),zn(e),Bn}var S;(function(e){e[e.ArrayContains=0]="ArrayContains",e[e.ArrayMaxContains=1]="ArrayMaxContains",e[e.ArrayMaxItems=2]="ArrayMaxItems",e[e.ArrayMinContains=3]="ArrayMinContains",e[e.ArrayMinItems=4]="ArrayMinItems",e[e.ArrayUniqueItems=5]="ArrayUniqueItems",e[e.Array=6]="Array",e[e.AsyncIterator=7]="AsyncIterator",e[e.BigIntExclusiveMaximum=8]="BigIntExclusiveMaximum",e[e.BigIntExclusiveMinimum=9]="BigIntExclusiveMinimum",e[e.BigIntMaximum=10]="BigIntMaximum",e[e.BigIntMinimum=11]="BigIntMinimum",e[e.BigIntMultipleOf=12]="BigIntMultipleOf",e[e.BigInt=13]="BigInt",e[e.Boolean=14]="Boolean",e[e.DateExclusiveMaximumTimestamp=15]="DateExclusiveMaximumTimestamp",e[e.DateExclusiveMinimumTimestamp=16]="DateExclusiveMinimumTimestamp",e[e.DateMaximumTimestamp=17]="DateMaximumTimestamp",e[e.DateMinimumTimestamp=18]="DateMinimumTimestamp",e[e.DateMultipleOfTimestamp=19]="DateMultipleOfTimestamp",e[e.Date=20]="Date",e[e.Function=21]="Function",e[e.IntegerExclusiveMaximum=22]="IntegerExclusiveMaximum",e[e.IntegerExclusiveMinimum=23]="IntegerExclusiveMinimum",e[e.IntegerMaximum=24]="IntegerMaximum",e[e.IntegerMinimum=25]="IntegerMinimum",e[e.IntegerMultipleOf=26]="IntegerMultipleOf",e[e.Integer=27]="Integer",e[e.IntersectUnevaluatedProperties=28]="IntersectUnevaluatedProperties",e[e.Intersect=29]="Intersect",e[e.Iterator=30]="Iterator",e[e.Kind=31]="Kind",e[e.Literal=32]="Literal",e[e.Never=33]="Never",e[e.Not=34]="Not",e[e.Null=35]="Null",e[e.NumberExclusiveMaximum=36]="NumberExclusiveMaximum",e[e.NumberExclusiveMinimum=37]="NumberExclusiveMinimum",e[e.NumberMaximum=38]="NumberMaximum",e[e.NumberMinimum=39]="NumberMinimum",e[e.NumberMultipleOf=40]="NumberMultipleOf",e[e.Number=41]="Number",e[e.ObjectAdditionalProperties=42]="ObjectAdditionalProperties",e[e.ObjectMaxProperties=43]="ObjectMaxProperties",e[e.ObjectMinProperties=44]="ObjectMinProperties",e[e.ObjectRequiredProperty=45]="ObjectRequiredProperty",e[e.Object=46]="Object",e[e.Promise=47]="Promise",e[e.RegExp=48]="RegExp",e[e.StringFormatUnknown=49]="StringFormatUnknown",e[e.StringFormat=50]="StringFormat",e[e.StringMaxLength=51]="StringMaxLength",e[e.StringMinLength=52]="StringMinLength",e[e.StringPattern=53]="StringPattern",e[e.String=54]="String",e[e.Symbol=55]="Symbol",e[e.TupleLength=56]="TupleLength",e[e.Tuple=57]="Tuple",e[e.Uint8ArrayMaxByteLength=58]="Uint8ArrayMaxByteLength",e[e.Uint8ArrayMinByteLength=59]="Uint8ArrayMinByteLength",e[e.Uint8Array=60]="Uint8Array",e[e.Undefined=61]="Undefined",e[e.Union=62]="Union",e[e.Void=63]="Void"})(S||(S={}));class uy extends wt{constructor(t){super("Unknown type"),this.schema=t}}function jt(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function D(e){return e!==void 0}class ly{constructor(t){this.iterator=t}[Symbol.iterator](){return this.iterator}First(){const t=this.iterator.next();return t.done?void 0:t.value}}function R(e,t,n,r){return{type:e,schema:t,path:n,value:r,message:qg()({errorType:e,path:n,schema:t,value:r})}}function*fy(e,t,n,r){}function*dy(e,t,n,r){if(!jn(r))return yield R(S.Array,e,n,r);D(e.minItems)&&!(r.length>=e.minItems)&&(yield R(S.ArrayMinItems,e,n,r)),D(e.maxItems)&&!(r.length<=e.maxItems)&&(yield R(S.ArrayMaxItems,e,n,r));for(let a=0;a<r.length;a++)yield*_e(e.items,t,`${n}/${a}`,r[a]);if(e.uniqueItems===!0&&!function(){const a=new Set;for(const c of r){const u=Bu(c);if(a.has(u))return!1;a.add(u)}return!0}()&&(yield R(S.ArrayUniqueItems,e,n,r)),!(D(e.contains)||D(e.minContains)||D(e.maxContains)))return;const i=D(e.contains)?e.contains:qe(),s=r.reduce((a,c,u)=>_e(i,t,`${n}${u}`,c).next().done===!0?a+1:a,0);s===0&&(yield R(S.ArrayContains,e,n,r)),Zt(e.minContains)&&s<e.minContains&&(yield R(S.ArrayMinContains,e,n,r)),Zt(e.maxContains)&&s>e.maxContains&&(yield R(S.ArrayMaxContains,e,n,r))}function*py(e,t,n,r){Xc(r)||(yield R(S.AsyncIterator,e,n,r))}function*hy(e,t,n,r){if(!no(r))return yield R(S.BigInt,e,n,r);D(e.exclusiveMaximum)&&!(r<e.exclusiveMaximum)&&(yield R(S.BigIntExclusiveMaximum,e,n,r)),D(e.exclusiveMinimum)&&!(r>e.exclusiveMinimum)&&(yield R(S.BigIntExclusiveMinimum,e,n,r)),D(e.maximum)&&!(r<=e.maximum)&&(yield R(S.BigIntMaximum,e,n,r)),D(e.minimum)&&!(r>=e.minimum)&&(yield R(S.BigIntMinimum,e,n,r)),D(e.multipleOf)&&r%e.multipleOf!==BigInt(0)&&(yield R(S.BigIntMultipleOf,e,n,r))}function*my(e,t,n,r){to(r)||(yield R(S.Boolean,e,n,r))}function*gy(e,t,n,r){yield*_e(e.returns,t,n,r.prototype)}function*yy(e,t,n,r){if(!Xs(r))return yield R(S.Date,e,n,r);D(e.exclusiveMaximumTimestamp)&&!(r.getTime()<e.exclusiveMaximumTimestamp)&&(yield R(S.DateExclusiveMaximumTimestamp,e,n,r)),D(e.exclusiveMinimumTimestamp)&&!(r.getTime()>e.exclusiveMinimumTimestamp)&&(yield R(S.DateExclusiveMinimumTimestamp,e,n,r)),D(e.maximumTimestamp)&&!(r.getTime()<=e.maximumTimestamp)&&(yield R(S.DateMaximumTimestamp,e,n,r)),D(e.minimumTimestamp)&&!(r.getTime()>=e.minimumTimestamp)&&(yield R(S.DateMinimumTimestamp,e,n,r)),D(e.multipleOfTimestamp)&&r.getTime()%e.multipleOfTimestamp!==0&&(yield R(S.DateMultipleOfTimestamp,e,n,r))}function*wy(e,t,n,r){nu(r)||(yield R(S.Function,e,n,r))}function*by(e,t,n,r){if(!tu(r))return yield R(S.Integer,e,n,r);D(e.exclusiveMaximum)&&!(r<e.exclusiveMaximum)&&(yield R(S.IntegerExclusiveMaximum,e,n,r)),D(e.exclusiveMinimum)&&!(r>e.exclusiveMinimum)&&(yield R(S.IntegerExclusiveMinimum,e,n,r)),D(e.maximum)&&!(r<=e.maximum)&&(yield R(S.IntegerMaximum,e,n,r)),D(e.minimum)&&!(r>=e.minimum)&&(yield R(S.IntegerMinimum,e,n,r)),D(e.multipleOf)&&r%e.multipleOf!==0&&(yield R(S.IntegerMultipleOf,e,n,r))}function*vy(e,t,n,r){for(const i of e.allOf){const s=_e(i,t,n,r).next();s.done||(yield R(S.Intersect,e,n,r),yield s.value)}if(e.unevaluatedProperties===!1){const i=new RegExp(Mi(e));for(const s of Object.getOwnPropertyNames(r))i.test(s)||(yield R(S.IntersectUnevaluatedProperties,e,`${n}/${s}`,r))}if(typeof e.unevaluatedProperties=="object"){const i=new RegExp(Mi(e));for(const s of Object.getOwnPropertyNames(r))if(!i.test(s)){const a=_e(e.unevaluatedProperties,t,`${n}/${s}`,r[s]).next();a.done||(yield a.value)}}}function*Sy(e,t,n,r){Qc(r)||(yield R(S.Iterator,e,n,r))}function*ky(e,t,n,r){r!==e.const&&(yield R(S.Literal,e,n,r))}function*Oy(e,t,n,r){yield R(S.Never,e,n,r)}function*Iy(e,t,n,r){_e(e.not,t,n,r).next().done===!0&&(yield R(S.Not,e,n,r))}function*$y(e,t,n,r){eo(r)||(yield R(S.Null,e,n,r))}function*Ey(e,t,n,r){if(!it.IsNumberLike(r))return yield R(S.Number,e,n,r);D(e.exclusiveMaximum)&&!(r<e.exclusiveMaximum)&&(yield R(S.NumberExclusiveMaximum,e,n,r)),D(e.exclusiveMinimum)&&!(r>e.exclusiveMinimum)&&(yield R(S.NumberExclusiveMinimum,e,n,r)),D(e.maximum)&&!(r<=e.maximum)&&(yield R(S.NumberMaximum,e,n,r)),D(e.minimum)&&!(r>=e.minimum)&&(yield R(S.NumberMinimum,e,n,r)),D(e.multipleOf)&&r%e.multipleOf!==0&&(yield R(S.NumberMultipleOf,e,n,r))}function*Ty(e,t,n,r){if(!it.IsObjectLike(r))return yield R(S.Object,e,n,r);D(e.minProperties)&&!(Object.getOwnPropertyNames(r).length>=e.minProperties)&&(yield R(S.ObjectMinProperties,e,n,r)),D(e.maxProperties)&&!(Object.getOwnPropertyNames(r).length<=e.maxProperties)&&(yield R(S.ObjectMaxProperties,e,n,r));const i=Array.isArray(e.required)?e.required:[],s=Object.getOwnPropertyNames(e.properties),a=Object.getOwnPropertyNames(r);for(const c of i)a.includes(c)||(yield R(S.ObjectRequiredProperty,e.properties[c],`${n}/${jt(c)}`,void 0));if(e.additionalProperties===!1)for(const c of a)s.includes(c)||(yield R(S.ObjectAdditionalProperties,e,`${n}/${jt(c)}`,r[c]));if(typeof e.additionalProperties=="object")for(const c of a)s.includes(c)||(yield*_e(e.additionalProperties,t,`${n}/${jt(c)}`,r[c]));for(const c of s){const u=e.properties[c];e.required&&e.required.includes(c)?(yield*_e(u,t,`${n}/${jt(c)}`,r[c]),$r(e)&&!(c in r)&&(yield R(S.ObjectRequiredProperty,u,`${n}/${jt(c)}`,void 0))):it.IsExactOptionalProperty(r,c)&&(yield*_e(u,t,`${n}/${jt(c)}`,r[c]))}}function*Ny(e,t,n,r){eu(r)||(yield R(S.Promise,e,n,r))}function*Ly(e,t,n,r){if(!it.IsRecordLike(r))return yield R(S.Object,e,n,r);D(e.minProperties)&&!(Object.getOwnPropertyNames(r).length>=e.minProperties)&&(yield R(S.ObjectMinProperties,e,n,r)),D(e.maxProperties)&&!(Object.getOwnPropertyNames(r).length<=e.maxProperties)&&(yield R(S.ObjectMaxProperties,e,n,r));const[i,s]=Object.entries(e.patternProperties)[0],a=new RegExp(i);for(const[c,u]of Object.entries(r))a.test(c)&&(yield*_e(s,t,`${n}/${jt(c)}`,u));if(typeof e.additionalProperties=="object")for(const[c,u]of Object.entries(r))a.test(c)||(yield*_e(e.additionalProperties,t,`${n}/${jt(c)}`,u));if(e.additionalProperties===!1){for(const[c,u]of Object.entries(r))if(!a.test(c))return yield R(S.ObjectAdditionalProperties,e,`${n}/${jt(c)}`,u)}}function*Ay(e,t,n,r){yield*_e(Er(e,t),t,n,r)}function*Py(e,t,n,r){if(!Jt(r))return yield R(S.String,e,n,r);if(D(e.minLength)&&!(r.length>=e.minLength)&&(yield R(S.StringMinLength,e,n,r)),D(e.maxLength)&&!(r.length<=e.maxLength)&&(yield R(S.StringMaxLength,e,n,r)),!new RegExp(e.source,e.flags).test(r))return yield R(S.RegExp,e,n,r)}function*Ry(e,t,n,r){if(!Jt(r))return yield R(S.String,e,n,r);D(e.minLength)&&!(r.length>=e.minLength)&&(yield R(S.StringMinLength,e,n,r)),D(e.maxLength)&&!(r.length<=e.maxLength)&&(yield R(S.StringMaxLength,e,n,r)),Jt(e.pattern)&&(new RegExp(e.pattern).test(r)||(yield R(S.StringPattern,e,n,r))),Jt(e.format)&&(so(e.format)?ru(e.format)(r)||(yield R(S.StringFormat,e,n,r)):yield R(S.StringFormatUnknown,e,n,r))}function*_y(e,t,n,r){ro(r)||(yield R(S.Symbol,e,n,r))}function*Cy(e,t,n,r){if(!Jt(r))return yield R(S.String,e,n,r);new RegExp(e.pattern).test(r)||(yield R(S.StringPattern,e,n,r))}function*jy(e,t,n,r){yield*_e(Er(e,t),t,n,r)}function*Uy(e,t,n,r){if(!jn(r))return yield R(S.Tuple,e,n,r);if(e.items===void 0&&r.length!==0)return yield R(S.TupleLength,e,n,r);if(r.length!==e.maxItems)return yield R(S.TupleLength,e,n,r);if(e.items)for(let i=0;i<e.items.length;i++)yield*_e(e.items[i],t,`${n}/${i}`,r[i])}function*xy(e,t,n,r){Si(r)||(yield R(S.Undefined,e,n,r))}function*My(e,t,n,r){let i=0;for(const s of e.anyOf){const a=[..._e(s,t,n,r)];if(a.length===0)return;i+=a.length}i>0&&(yield R(S.Union,e,n,r))}function*Fy(e,t,n,r){if(!Qs(r))return yield R(S.Uint8Array,e,n,r);D(e.maxByteLength)&&!(r.length<=e.maxByteLength)&&(yield R(S.Uint8ArrayMaxByteLength,e,n,r)),D(e.minByteLength)&&!(r.length>=e.minByteLength)&&(yield R(S.Uint8ArrayMinByteLength,e,n,r))}function*Dy(e,t,n,r){}function*By(e,t,n,r){it.IsVoidLike(r)||(yield R(S.Void,e,n,r))}function*zy(e,t,n,r){iu(e[C])(e,r)||(yield R(S.Kind,e,n,r))}function*_e(e,t,n,r){const i=D(e.$id)?[...t,e]:t,s=e;switch(s[C]){case"Any":return yield*fy();case"Array":return yield*dy(s,i,n,r);case"AsyncIterator":return yield*py(s,i,n,r);case"BigInt":return yield*hy(s,i,n,r);case"Boolean":return yield*my(s,i,n,r);case"Constructor":return yield*gy(s,i,n,r);case"Date":return yield*yy(s,i,n,r);case"Function":return yield*wy(s,i,n,r);case"Integer":return yield*by(s,i,n,r);case"Intersect":return yield*vy(s,i,n,r);case"Iterator":return yield*Sy(s,i,n,r);case"Literal":return yield*ky(s,i,n,r);case"Never":return yield*Oy(s,i,n,r);case"Not":return yield*Iy(s,i,n,r);case"Null":return yield*$y(s,i,n,r);case"Number":return yield*Ey(s,i,n,r);case"Object":return yield*Ty(s,i,n,r);case"Promise":return yield*Ny(s,i,n,r);case"Record":return yield*Ly(s,i,n,r);case"Ref":return yield*Ay(s,i,n,r);case"RegExp":return yield*Py(s,i,n,r);case"String":return yield*Ry(s,i,n,r);case"Symbol":return yield*_y(s,i,n,r);case"TemplateLiteral":return yield*Cy(s,i,n,r);case"This":return yield*jy(s,i,n,r);case"Tuple":return yield*Uy(s,i,n,r);case"Undefined":return yield*xy(s,i,n,r);case"Union":return yield*My(s,i,n,r);case"Uint8Array":return yield*Fy(s,i,n,r);case"Unknown":return yield*Dy();case"Void":return yield*By(s,i,n,r);default:if(!ki(s[C]))throw new uy(e);return yield*zy(s,i,n,r)}}function zu(...e){const t=e.length===3?_e(e[0],e[1],"",e[2]):_e(e[0],[],"",e[1]);return new ly(t)}function Tr(e={}){return{...e,[C]:"Any"}}function Nr(e={}){return{...e,[C]:"Unknown"}}const Vy=["Any","Array","AsyncIterator","BigInt","Boolean","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];function Vu(e){try{return new RegExp(e),!0}catch{return!1}}function ko(e){if(!Se(e))return!1;for(let t=0;t<e.length;t++){const n=e.charCodeAt(t);if(n>=7&&n<=13||n===27||n===127)return!1}return!0}function qu(e){return Oo(e)||je(e)}function Lr(e){return ge(e)||au(e)}function te(e){return ge(e)||Wt(e)}function Oo(e){return ge(e)||$i(e)}function H(e){return ge(e)||Se(e)}function qy(e){return ge(e)||Se(e)&&ko(e)&&Vu(e)}function Gy(e){return ge(e)||Se(e)&&ko(e)}function Gu(e){return ge(e)||je(e)}function Fi(e){return $e(e)&&e[Kt]==="Optional"}function vt(e){return Z(e,"Any")&&H(e.$id)}function yn(e){return Z(e,"Array")&&e.type==="array"&&H(e.$id)&&je(e.items)&&te(e.minItems)&&te(e.maxItems)&&Oo(e.uniqueItems)&&Gu(e.contains)&&te(e.minContains)&&te(e.maxContains)}function Io(e){return Z(e,"AsyncIterator")&&e.type==="AsyncIterator"&&H(e.$id)&&je(e.items)}function Di(e){return Z(e,"BigInt")&&e.type==="bigint"&&H(e.$id)&&Lr(e.exclusiveMaximum)&&Lr(e.exclusiveMinimum)&&Lr(e.maximum)&&Lr(e.minimum)&&Lr(e.multipleOf)}function wn(e){return Z(e,"Boolean")&&e.type==="boolean"&&H(e.$id)}function Bi(e){return Z(e,"Constructor")&&e.type==="Constructor"&&H(e.$id)&&Nt(e.parameters)&&e.parameters.every(t=>je(t))&&je(e.returns)}function zi(e){return Z(e,"Date")&&e.type==="Date"&&H(e.$id)&&te(e.exclusiveMaximumTimestamp)&&te(e.exclusiveMinimumTimestamp)&&te(e.maximumTimestamp)&&te(e.minimumTimestamp)&&te(e.multipleOfTimestamp)}function Vi(e){return Z(e,"Function")&&e.type==="Function"&&H(e.$id)&&Nt(e.parameters)&&e.parameters.every(t=>je(t))&&je(e.returns)}function Ut(e){return Z(e,"Integer")&&e.type==="integer"&&H(e.$id)&&te(e.exclusiveMaximum)&&te(e.exclusiveMinimum)&&te(e.maximum)&&te(e.minimum)&&te(e.multipleOf)}function Zu(e){return $e(e)&&Object.entries(e).every(([t,n])=>ko(t)&&je(n))}function bn(e){return Z(e,"Intersect")&&!(Se(e.type)&&e.type!=="object")&&Nt(e.allOf)&&e.allOf.every(t=>je(t)&&!Yy(t))&&H(e.type)&&(Oo(e.unevaluatedProperties)||Gu(e.unevaluatedProperties))&&H(e.$id)}function $o(e){return Z(e,"Iterator")&&e.type==="Iterator"&&H(e.$id)&&je(e.items)}function Z(e,t){return $e(e)&&C in e&&e[C]===t}function Ju(e){return Xt(e)&&Se(e.const)}function Ku(e){return Xt(e)&&Wt(e.const)}function Wu(e){return Xt(e)&&$i(e.const)}function Xt(e){return Z(e,"Literal")&&H(e.$id)&&Zy(e.const)}function Zy(e){return $i(e)||Wt(e)||Se(e)}function Jy(e){return Z(e,"MappedKey")&&Nt(e.keys)&&e.keys.every(t=>Wt(t)||Se(t))}function Ky(e){return Z(e,"MappedResult")&&Zu(e.properties)}function Qt(e){return Z(e,"Never")&&$e(e.not)&&Object.getOwnPropertyNames(e.not).length===0}function Vn(e){return Z(e,"Not")&&je(e.not)}function Eo(e){return Z(e,"Null")&&e.type==="null"&&H(e.$id)}function We(e){return Z(e,"Number")&&e.type==="number"&&H(e.$id)&&te(e.exclusiveMaximum)&&te(e.exclusiveMinimum)&&te(e.maximum)&&te(e.minimum)&&te(e.multipleOf)}function ce(e){return Z(e,"Object")&&e.type==="object"&&H(e.$id)&&Zu(e.properties)&&qu(e.additionalProperties)&&te(e.minProperties)&&te(e.maxProperties)}function To(e){return Z(e,"Promise")&&e.type==="Promise"&&H(e.$id)&&je(e.item)}function Ce(e){return Z(e,"Record")&&e.type==="object"&&H(e.$id)&&qu(e.additionalProperties)&&$e(e.patternProperties)&&(t=>{const n=Object.getOwnPropertyNames(t.patternProperties);return n.length===1&&Vu(n[0])&&$e(t.patternProperties)&&je(t.patternProperties[n[0]])})(e)}function Wy(e){return Z(e,"Ref")&&H(e.$id)&&Se(e.$ref)}function Ar(e){return Z(e,"RegExp")&&H(e.$id)&&Se(e.source)&&Se(e.flags)&&te(e.maxLength)&&te(e.minLength)}function St(e){return Z(e,"String")&&e.type==="string"&&H(e.$id)&&te(e.minLength)&&te(e.maxLength)&&qy(e.pattern)&&Gy(e.format)}function Pr(e){return Z(e,"Symbol")&&e.type==="symbol"&&H(e.$id)}function Rr(e){return Z(e,"TemplateLiteral")&&e.type==="string"&&Se(e.pattern)&&e.pattern[0]==="^"&&e.pattern[e.pattern.length-1]==="$"}function Hy(e){return Z(e,"This")&&H(e.$id)&&Se(e.$ref)}function Yy(e){return $e(e)&&Tt in e}function qi(e){return Z(e,"Tuple")&&e.type==="array"&&H(e.$id)&&Wt(e.minItems)&&Wt(e.maxItems)&&e.minItems===e.maxItems&&(ge(e.items)&&ge(e.additionalItems)&&e.minItems===0||Nt(e.items)&&e.items.every(t=>je(t)))}function vn(e){return Z(e,"Undefined")&&e.type==="undefined"&&H(e.$id)}function xt(e){return Z(e,"Union")&&H(e.$id)&&$e(e)&&Nt(e.anyOf)&&e.anyOf.every(t=>je(t))}function _r(e){return Z(e,"Uint8Array")&&e.type==="Uint8Array"&&H(e.$id)&&te(e.minByteLength)&&te(e.maxByteLength)}function kt(e){return Z(e,"Unknown")&&H(e.$id)}function Xy(e){return Z(e,"Unsafe")}function Gi(e){return Z(e,"Void")&&e.type==="void"&&H(e.$id)}function Qy(e){return $e(e)&&C in e&&Se(e[C])&&!Vy.includes(e[C])}function je(e){return $e(e)&&(vt(e)||yn(e)||wn(e)||Di(e)||Io(e)||Bi(e)||zi(e)||Vi(e)||Ut(e)||bn(e)||$o(e)||Xt(e)||Jy(e)||Ky(e)||Qt(e)||Vn(e)||Eo(e)||We(e)||ce(e)||To(e)||Ce(e)||Wy(e)||Ar(e)||St(e)||Pr(e)||Rr(e)||Hy(e)||qi(e)||vn(e)||xt(e)||_r(e)||kt(e)||Xy(e)||Gi(e)||Qy(e))}class ew extends wt{}var k;(function(e){e[e.Union=0]="Union",e[e.True=1]="True",e[e.False=2]="False"})(k||(k={}));function at(e){return e===k.False?e:k.True}function qn(e){throw new ew(e)}function ke(e){return Qt(e)||bn(e)||xt(e)||kt(e)||vt(e)}function Oe(e,t){return Qt(t)?Xu():bn(t)?Zi(e,t):xt(t)?Ro(e,t):kt(t)?ol():vt(t)?No():qn("StructuralRight")}function No(e,t){return k.True}function tw(e,t){return bn(t)?Zi(e,t):xt(t)&&t.anyOf.some(n=>vt(n)||kt(n))?k.True:xt(t)?k.Union:kt(t)||vt(t)?k.True:k.Union}function nw(e,t){return kt(e)?k.False:vt(e)?k.Union:Qt(e)?k.True:k.False}function rw(e,t){return ce(t)&&Ji(t)?k.True:ke(t)?Oe(e,t):yn(t)?at(Y(e.items,t.items)):k.False}function iw(e,t){return ke(t)?Oe(e,t):Io(t)?at(Y(e.items,t.items)):k.False}function sw(e,t){return ke(t)?Oe(e,t):ce(t)?ze(e,t):Ce(t)?ct(e,t):Di(t)?k.True:k.False}function Hu(e,t){return Wu(e)||wn(e)?k.True:k.False}function ow(e,t){return ke(t)?Oe(e,t):ce(t)?ze(e,t):Ce(t)?ct(e,t):wn(t)?k.True:k.False}function aw(e,t){return ke(t)?Oe(e,t):ce(t)?ze(e,t):Bi(t)?e.parameters.length>t.parameters.length?k.False:e.parameters.every((n,r)=>at(Y(t.parameters[r],n))===k.True)?at(Y(e.returns,t.returns)):k.False:k.False}function cw(e,t){return ke(t)?Oe(e,t):ce(t)?ze(e,t):Ce(t)?ct(e,t):zi(t)?k.True:k.False}function uw(e,t){return ke(t)?Oe(e,t):ce(t)?ze(e,t):Vi(t)?e.parameters.length>t.parameters.length?k.False:e.parameters.every((n,r)=>at(Y(t.parameters[r],n))===k.True)?at(Y(e.returns,t.returns)):k.False:k.False}function Yu(e,t){return Xt(e)&&Wt(e.const)||We(e)||Ut(e)?k.True:k.False}function lw(e,t){return Ut(t)||We(t)?k.True:ke(t)?Oe(e,t):ce(t)?ze(e,t):Ce(t)?ct(e,t):k.False}function Zi(e,t){return t.allOf.every(n=>Y(e,n)===k.True)?k.True:k.False}function fw(e,t){return e.allOf.some(n=>Y(n,t)===k.True)?k.True:k.False}function dw(e,t){return ke(t)?Oe(e,t):$o(t)?at(Y(e.items,t.items)):k.False}function pw(e,t){return Xt(t)&&t.const===e.const?k.True:ke(t)?Oe(e,t):ce(t)?ze(e,t):Ce(t)?ct(e,t):St(t)?sl(e):We(t)?el(e):Ut(t)?Yu(e):wn(t)?Hu(e):k.False}function Xu(e,t){return k.False}function hw(e,t){return k.True}function Qu(e){let[t,n]=[e,0];for(;Vn(t);)t=t.not,n+=1;return n%2===0?t:Nr()}function mw(e,t){return Vn(e)?Y(Qu(e),t):Vn(t)?Y(e,Qu(t)):qn("Invalid fallthrough for Not")}function gw(e,t){return ke(t)?Oe(e,t):ce(t)?ze(e,t):Ce(t)?ct(e,t):Eo(t)?k.True:k.False}function el(e,t){return Ku(e)||We(e)||Ut(e)?k.True:k.False}function yw(e,t){return ke(t)?Oe(e,t):ce(t)?ze(e,t):Ce(t)?ct(e,t):Ut(t)||We(t)?k.True:k.False}function He(e,t){return Object.getOwnPropertyNames(e.properties).length===t}function tl(e){return Ji(e)}function nl(e){return He(e,0)||He(e,1)&&"description"in e.properties&&xt(e.properties.description)&&e.properties.description.anyOf.length===2&&(St(e.properties.description.anyOf[0])&&vn(e.properties.description.anyOf[1])||St(e.properties.description.anyOf[1])&&vn(e.properties.description.anyOf[0]))}function Lo(e){return He(e,0)}function rl(e){return He(e,0)}function ww(e){return He(e,0)}function bw(e){return He(e,0)}function vw(e){return Ji(e)}function Sw(e){const t=Dn();return He(e,0)||He(e,1)&&"length"in e.properties&&at(Y(e.properties.length,t))===k.True}function kw(e){return He(e,0)}function Ji(e){const t=Dn();return He(e,0)||He(e,1)&&"length"in e.properties&&at(Y(e.properties.length,t))===k.True}function Ow(e){const t=Ni([Tr()],Tr());return He(e,0)||He(e,1)&&"then"in e.properties&&at(Y(e.properties.then,t))===k.True}function il(e,t){return Y(e,t)===k.False||Fi(e)&&!Fi(t)?k.False:k.True}function ze(e,t){return kt(e)?k.False:vt(e)?k.Union:Qt(e)||Ju(e)&&tl(t)||Ku(e)&&Lo(t)||Wu(e)&&rl(t)||Pr(e)&&nl(t)||Di(e)&&ww(t)||St(e)&&tl(t)||Pr(e)&&nl(t)||We(e)&&Lo(t)||Ut(e)&&Lo(t)||wn(e)&&rl(t)||_r(e)&&vw(t)||zi(e)&&bw(t)||Bi(e)&&kw(t)||Vi(e)&&Sw(t)?k.True:Ce(e)&&St(Ao(e))?(()=>t[Ii]==="Record"?k.True:k.False)():Ce(e)&&We(Ao(e))?(()=>He(t,0)?k.True:k.False)():k.False}function Iw(e,t){return ke(t)?Oe(e,t):Ce(t)?ct(e,t):ce(t)?(()=>{for(const n of Object.getOwnPropertyNames(t.properties)){if(!(n in e.properties)&&!Fi(t.properties[n]))return k.False;if(Fi(t.properties[n]))return k.True;if(il(e.properties[n],t.properties[n])===k.False)return k.False}return k.True})():k.False}function $w(e,t){return ke(t)?Oe(e,t):ce(t)&&Ow(t)?k.True:To(t)?at(Y(e.item,t.item)):k.False}function Ao(e){return kr in e.patternProperties?Dn():ji in e.patternProperties?Ht():qn("Unknown record key pattern")}function Po(e){return kr in e.patternProperties?e.patternProperties[kr]:ji in e.patternProperties?e.patternProperties[ji]:qn("Unable to get record value schema")}function ct(e,t){const[n,r]=[Ao(t),Po(t)];return Ju(e)&&We(n)&&at(Y(e,r))===k.True?k.True:_r(e)&&We(n)||St(e)&&We(n)||yn(e)&&We(n)?Y(e,r):ce(e)?(()=>{for(const i of Object.getOwnPropertyNames(e.properties))if(il(r,e.properties[i])===k.False)return k.False;return k.True})():k.False}function Ew(e,t){return ke(t)?Oe(e,t):ce(t)?ze(e,t):Ce(t)?Y(Po(e),Po(t)):k.False}function Tw(e,t){const n=Ar(e)?Ht():e,r=Ar(t)?Ht():t;return Y(n,r)}function sl(e,t){return Xt(e)&&Se(e.const)||St(e)?k.True:k.False}function Nw(e,t){return ke(t)?Oe(e,t):ce(t)?ze(e,t):Ce(t)?ct(e,t):St(t)?k.True:k.False}function Lw(e,t){return ke(t)?Oe(e,t):ce(t)?ze(e,t):Ce(t)?ct(e,t):Pr(t)?k.True:k.False}function Aw(e,t){return Rr(e)?Y(Ui(e),t):Rr(t)?Y(e,Ui(t)):qn("Invalid fallthrough for TemplateLiteral")}function Pw(e,t){return yn(t)&&e.items!==void 0&&e.items.every(n=>Y(n,t.items)===k.True)}function Rw(e,t){return Qt(e)?k.True:kt(e)?k.False:vt(e)?k.Union:k.False}function _w(e,t){return ke(t)?Oe(e,t):ce(t)&&Ji(t)||yn(t)&&Pw(e,t)?k.True:qi(t)?ge(e.items)&&!ge(t.items)||!ge(e.items)&&ge(t.items)?k.False:ge(e.items)&&!ge(t.items)||e.items.every((n,r)=>Y(n,t.items[r])===k.True)?k.True:k.False:k.False}function Cw(e,t){return ke(t)?Oe(e,t):ce(t)?ze(e,t):Ce(t)?ct(e,t):_r(t)?k.True:k.False}function jw(e,t){return ke(t)?Oe(e,t):ce(t)?ze(e,t):Ce(t)?ct(e,t):Gi(t)?Mw(e):vn(t)?k.True:k.False}function Ro(e,t){return t.anyOf.some(n=>Y(e,n)===k.True)?k.True:k.False}function Uw(e,t){return e.anyOf.every(n=>Y(n,t)===k.True)?k.True:k.False}function ol(e,t){return k.True}function xw(e,t){return Qt(t)?Xu():bn(t)?Zi(e,t):xt(t)?Ro(e,t):vt(t)?No():St(t)?sl(e):We(t)?el(e):Ut(t)?Yu(e):wn(t)?Hu(e):yn(t)?nw(e):qi(t)?Rw(e):ce(t)?ze(e,t):kt(t)?k.True:k.False}function Mw(e,t){return vn(e)||vn(e)?k.True:k.False}function Fw(e,t){return bn(t)?Zi(e,t):xt(t)?Ro(e,t):kt(t)?ol():vt(t)?No():ce(t)?ze(e,t):Gi(t)?k.True:k.False}function Y(e,t){return Rr(e)||Rr(t)?Aw(e,t):Ar(e)||Ar(t)?Tw(e,t):Vn(e)||Vn(t)?mw(e,t):vt(e)?tw(e,t):yn(e)?rw(e,t):Di(e)?sw(e,t):wn(e)?ow(e,t):Io(e)?iw(e,t):Bi(e)?aw(e,t):zi(e)?cw(e,t):Vi(e)?uw(e,t):Ut(e)?lw(e,t):bn(e)?fw(e,t):$o(e)?dw(e,t):Xt(e)?pw(e,t):Qt(e)?hw():Eo(e)?gw(e,t):We(e)?yw(e,t):ce(e)?Iw(e,t):Ce(e)?Ew(e,t):St(e)?Nw(e,t):Pr(e)?Lw(e,t):qi(e)?_w(e,t):To(e)?$w(e,t):_r(e)?Cw(e,t):vn(e)?jw(e,t):xt(e)?Uw(e,t):kt(e)?xw(e,t):Gi(e)?Fw(e,t):qn(`Unknown left type operand '${e[C]}'`)}function Cr(e,t){return Y(e,t)}function Dw(e,t,n,r,i){const s={};for(const a of globalThis.Object.getOwnPropertyNames(e))s[a]=_o(e[a],t,n,r,i);return s}function Bw(e,t,n,r,i){return Dw(e.properties,t,n,r,i)}function zw(e,t,n,r,i){const s=Bw(e,t,n,r,i);return Pe(s)}function Vw(e,t,n,r){const i=Cr(e,t);return i===k.Union?Ge([n,r]):i===k.True?n:r}function _o(e,t,n,r,i={}){return Qe(e)?zw(e,t,n,r,i):fn(e)?x(Jw(e,t,n,r,i)):x(Vw(e,t,n,r),i)}function qw(e,t,n,r,i){return{[e]:_o(ye(e),t,n,r,i)}}function Gw(e,t,n,r,i){return e.reduce((s,a)=>({...s,...qw(a,t,n,r,i)}),{})}function Zw(e,t,n,r,i){return Gw(e.keys,t,n,r,i)}function Jw(e,t,n,r,i){const s=Zw(e,t,n,r,i);return Pe(s)}class Kw extends wt{constructor(t){super("Unknown type"),this.schema=t}}function Ww(e){return e[C]==="Any"||e[C]==="Unknown"}function B(e){return e!==void 0}function Hw(e,t,n){return!0}function Yw(e,t,n){if(!jn(n)||B(e.minItems)&&!(n.length>=e.minItems)||B(e.maxItems)&&!(n.length<=e.maxItems)||!n.every(s=>Ue(e.items,t,s))||e.uniqueItems===!0&&!function(){const s=new Set;for(const a of n){const c=Bu(a);if(s.has(c))return!1;s.add(c)}return!0}())return!1;if(!(B(e.contains)||Zt(e.minContains)||Zt(e.maxContains)))return!0;const r=B(e.contains)?e.contains:qe(),i=n.reduce((s,a)=>Ue(r,t,a)?s+1:s,0);return!(i===0||Zt(e.minContains)&&i<e.minContains||Zt(e.maxContains)&&i>e.maxContains)}function Xw(e,t,n){return Xc(n)}function Qw(e,t,n){return!(!no(n)||B(e.exclusiveMaximum)&&!(n<e.exclusiveMaximum)||B(e.exclusiveMinimum)&&!(n>e.exclusiveMinimum)||B(e.maximum)&&!(n<=e.maximum)||B(e.minimum)&&!(n>=e.minimum)||B(e.multipleOf)&&n%e.multipleOf!==BigInt(0))}function eb(e,t,n){return to(n)}function tb(e,t,n){return Ue(e.returns,t,n.prototype)}function nb(e,t,n){return!(!Xs(n)||B(e.exclusiveMaximumTimestamp)&&!(n.getTime()<e.exclusiveMaximumTimestamp)||B(e.exclusiveMinimumTimestamp)&&!(n.getTime()>e.exclusiveMinimumTimestamp)||B(e.maximumTimestamp)&&!(n.getTime()<=e.maximumTimestamp)||B(e.minimumTimestamp)&&!(n.getTime()>=e.minimumTimestamp)||B(e.multipleOfTimestamp)&&n.getTime()%e.multipleOfTimestamp!==0)}function rb(e,t,n){return nu(n)}function ib(e,t,n){return!(!tu(n)||B(e.exclusiveMaximum)&&!(n<e.exclusiveMaximum)||B(e.exclusiveMinimum)&&!(n>e.exclusiveMinimum)||B(e.maximum)&&!(n<=e.maximum)||B(e.minimum)&&!(n>=e.minimum)||B(e.multipleOf)&&n%e.multipleOf!==0)}function sb(e,t,n){const r=e.allOf.every(i=>Ue(i,t,n));if(e.unevaluatedProperties===!1){const i=new RegExp(Mi(e)),s=Object.getOwnPropertyNames(n).every(a=>i.test(a));return r&&s}else if(je(e.unevaluatedProperties)){const i=new RegExp(Mi(e)),s=Object.getOwnPropertyNames(n).every(a=>i.test(a)||Ue(e.unevaluatedProperties,t,n[a]));return r&&s}else return r}function ob(e,t,n){return Qc(n)}function ab(e,t,n){return n===e.const}function cb(e,t,n){return!1}function ub(e,t,n){return!Ue(e.not,t,n)}function lb(e,t,n){return eo(n)}function fb(e,t,n){return!(!it.IsNumberLike(n)||B(e.exclusiveMaximum)&&!(n<e.exclusiveMaximum)||B(e.exclusiveMinimum)&&!(n>e.exclusiveMinimum)||B(e.minimum)&&!(n>=e.minimum)||B(e.maximum)&&!(n<=e.maximum)||B(e.multipleOf)&&n%e.multipleOf!==0)}function db(e,t,n){if(!it.IsObjectLike(n)||B(e.minProperties)&&!(Object.getOwnPropertyNames(n).length>=e.minProperties)||B(e.maxProperties)&&!(Object.getOwnPropertyNames(n).length<=e.maxProperties))return!1;const r=Object.getOwnPropertyNames(e.properties);for(const i of r){const s=e.properties[i];if(e.required&&e.required.includes(i)){if(!Ue(s,t,n[i])||($r(s)||Ww(s))&&!(i in n))return!1}else if(it.IsExactOptionalProperty(n,i)&&!Ue(s,t,n[i]))return!1}if(e.additionalProperties===!1){const i=Object.getOwnPropertyNames(n);return e.required&&e.required.length===r.length&&i.length===r.length?!0:i.every(s=>r.includes(s))}else return typeof e.additionalProperties=="object"?Object.getOwnPropertyNames(n).every(s=>r.includes(s)||Ue(e.additionalProperties,t,n[s])):!0}function pb(e,t,n){return eu(n)}function hb(e,t,n){if(!it.IsRecordLike(n)||B(e.minProperties)&&!(Object.getOwnPropertyNames(n).length>=e.minProperties)||B(e.maxProperties)&&!(Object.getOwnPropertyNames(n).length<=e.maxProperties))return!1;const[r,i]=Object.entries(e.patternProperties)[0],s=new RegExp(r),a=Object.entries(n).every(([l,m])=>s.test(l)?Ue(i,t,m):!0),c=typeof e.additionalProperties=="object"?Object.entries(n).every(([l,m])=>s.test(l)?!0:Ue(e.additionalProperties,t,m)):!0,u=e.additionalProperties===!1?Object.getOwnPropertyNames(n).every(l=>s.test(l)):!0;return a&&c&&u}function mb(e,t,n){return Ue(Er(e,t),t,n)}function gb(e,t,n){const r=new RegExp(e.source,e.flags);return B(e.minLength)&&!(n.length>=e.minLength)||B(e.maxLength)&&!(n.length<=e.maxLength)?!1:r.test(n)}function yb(e,t,n){return!Jt(n)||B(e.minLength)&&!(n.length>=e.minLength)||B(e.maxLength)&&!(n.length<=e.maxLength)||B(e.pattern)&&!new RegExp(e.pattern).test(n)?!1:B(e.format)?so(e.format)?ru(e.format)(n):!1:!0}function wb(e,t,n){return ro(n)}function bb(e,t,n){return Jt(n)&&new RegExp(e.pattern).test(n)}function vb(e,t,n){return Ue(Er(e,t),t,n)}function Sb(e,t,n){if(!jn(n)||e.items===void 0&&n.length!==0||n.length!==e.maxItems)return!1;if(!e.items)return!0;for(let r=0;r<e.items.length;r++)if(!Ue(e.items[r],t,n[r]))return!1;return!0}function kb(e,t,n){return Si(n)}function Ob(e,t,n){return e.anyOf.some(r=>Ue(r,t,n))}function Ib(e,t,n){return!(!Qs(n)||B(e.maxByteLength)&&!(n.length<=e.maxByteLength)||B(e.minByteLength)&&!(n.length>=e.minByteLength))}function $b(e,t,n){return!0}function Eb(e,t,n){return it.IsVoidLike(n)}function Tb(e,t,n){return ki(e[C])?iu(e[C])(e,n):!1}function Ue(e,t,n){const r=B(e.$id)?[...t,e]:t,i=e;switch(i[C]){case"Any":return Hw();case"Array":return Yw(i,r,n);case"AsyncIterator":return Xw(i,r,n);case"BigInt":return Qw(i,r,n);case"Boolean":return eb(i,r,n);case"Constructor":return tb(i,r,n);case"Date":return nb(i,r,n);case"Function":return rb(i,r,n);case"Integer":return ib(i,r,n);case"Intersect":return sb(i,r,n);case"Iterator":return ob(i,r,n);case"Literal":return ab(i,r,n);case"Never":return cb();case"Not":return ub(i,r,n);case"Null":return lb(i,r,n);case"Number":return fb(i,r,n);case"Object":return db(i,r,n);case"Promise":return pb(i,r,n);case"Record":return hb(i,r,n);case"Ref":return mb(i,r,n);case"RegExp":return gb(i,r,n);case"String":return yb(i,r,n);case"Symbol":return wb(i,r,n);case"TemplateLiteral":return bb(i,r,n);case"This":return vb(i,r,n);case"Tuple":return Sb(i,r,n);case"Undefined":return kb(i,r,n);case"Union":return Ob(i,r,n);case"Uint8Array":return Ib(i,r,n);case"Unknown":return $b();case"Void":return Eb(i,r,n);default:if(!ki(i[C]))throw new Kw(i);return Tb(i,r,n)}}function al(...e){return e.length===3?Ue(e[0],e[1],e[2]):Ue(e[0],[],e[1])}const Nb=Ne({type:ye("insert"),path:Ht(),value:Nr()}),Lb=Ne({type:ye("update"),path:Ht(),value:Nr()}),Ab=Ne({type:ye("delete"),path:Ht()});Ge([Nb,Lb,Ab]);function Pb(...e){return al.apply(al,e)}function Rb(...e){return zu.apply(zu,e)}class jr extends Error{}class f extends jr{constructor(n){super(`API Client Error: ${(n==null?void 0:n.message)??"unknown"}`);h(this,"cause");this.name=`ApiClientError: ${(n==null?void 0:n.name)??"unknown"}`,this.cause=n}}class cl extends jr{constructor(n,{code:r,message:i,details:s}={}){super(`API Client Error: ${r} (${n}): ${i}`);h(this,"status");h(this,"originalMessage");h(this,"code");h(this,"details");this.name=`ApiClientError: ${r} (${n}): ${i}`,this.status=n,this.originalMessage=i,this.code=r,this.details=s}}class _b extends jr{constructor(n,r){super(`API Client Error: ${JSON.stringify([...Rb(n.schema,r)],void 0,4)}`);h(this,"schema");h(this,"value");this.name="ApiClientError: schema",this.schema=n,this.value=r}}const li=class li extends jr{constructor(){super(li.NAME),this.name=li.NAME}};h(li,"NAME","UnauthenticatedError");let Gn=li;async function tt(e){try{const t=await e;if(t.ok)return t;if(t.status===401||t.status===403)throw new Gn;{const n=await t.text();throw new cl(t.status,n.includes("<!DOCTYPE html>")?void 0:JSON.parse(n))}}catch(t){if(t instanceof Error)throw t instanceof jr?t:new f(t)}throw new f}async function Ee(e,t){const r=await(await tt(e)).json();if(t.validate(r))return r;throw new _b(t,r)}function Zn(e){return new Proxy(e,{get(t,n,r){const i=Reflect.get(t,n,r);return typeof i=="function"?async(...s)=>{try{return await i.apply(this,s)}catch(a){throw a instanceof Error?new f(a):new f(new Error(`Unknown error: ${JSON.stringify(a)}`))}}:i}})}function ul(e){return e.map(t=>Co(t))}function Cb(e){return mn(ul(e))}function jb(e){return Ge(ul(e))}function Ub(e){return Co(e)}function Co(e){return bt(e)?Cb(e.allOf):Re(e)?jb(e.anyOf):Ri(e)?Ub(e.item):e}function xb(e,t={}){return x(Co(e),t)}function Mb(e){const t=[];for(const n of e)t.push(...xi(n));return yg(t)}function Fb(e){return e.filter(t=>!Ai(t))}function Db(e,t){const n=[];for(const r of e)n.push(...Pu(r,[t]));return Fb(n)}function Bb(e,t){const n={};for(const r of t)n[r]=wu(Db(e,r));return n}function zb(e,t={}){const n=Mb(e),r=Bb(e,n);return Ne(r,t)}function ll(e={}){return{...e,[C]:"Date",type:"Date"}}function fl(e={}){return{...e,[C]:"Null",type:"null"}}function dl(e){return{...e,[C]:"Symbol",type:"symbol"}}function pl(e={}){return{...e,[C]:"Undefined",type:"undefined"}}function hl(e={}){return{...e,[C]:"Uint8Array",type:"Uint8Array"}}function Vb(e){return e.map(t=>jo(t,!1))}function qb(e){const t={};for(const n of globalThis.Object.getOwnPropertyNames(e))t[n]=gn(jo(e[n],!1));return t}function Ki(e,t){return t===!0?e:gn(e)}function jo(e,t){return Dh(e)||zh(e)?Ki(Tr(),t):Nt(e)?gn(Or(Vb(e))):Ei(e)?hl():cu(e)?ll():$e(e)?Ki(Ne(qb(e)),t):Bh(e)?Ki(Ni([],Nr()),t):ge(e)?pl():Vh(e)?fl():Gh(e)?dl():au(e)?wo():Wt(e)||$i(e)||Se(e)?ye(e):Ne({})}function Gb(e,t={}){return x(jo(e,!0),t)}function Zb(e,t={}){return Or(Xe(e.parameters),{...t})}function Ur(e,t){return e.map(n=>At(n,t))}function Jb(e,t){const n={};for(const r of globalThis.Object.getOwnPropertyNames(e))n[r]=At(e[r],t);return n}function Kb(e,t){return e.parameters=Ur(e.parameters,t),e.returns=At(e.returns,t),e}function Wb(e,t){return e.parameters=Ur(e.parameters,t),e.returns=At(e.returns,t),e}function Hb(e,t){return e.allOf=Ur(e.allOf,t),e}function Yb(e,t){return e.anyOf=Ur(e.anyOf,t),e}function Xb(e,t){return ge(e.items)||(e.items=Ur(e.items,t)),e}function Qb(e,t){return e.items=At(e.items,t),e}function ev(e,t){return e.properties=Jb(e.properties,t),e}function tv(e,t){return e.item=At(e.item,t),e}function nv(e,t){return e.items=At(e.items,t),e}function rv(e,t){return e.items=At(e.items,t),e}function iv(e,t){const n=t.find(i=>i.$id===e.$ref);if(n===void 0)throw Error(`Unable to dereference schema with $id ${e.$ref}`);const r=st(n,["$id"]);return At(r,t)}function sv(e,t){return co(e)?Kb(e,t):uo(e)?Wb(e,t):bt(e)?Hb(e,t):Re(e)?Yb(e,t):xn(e)?Xb(e,t):wr(e)?Qb(e,t):Lt(e)?ev(e,t):Ri(e)?tv(e,t):ao(e)?nv(e,t):lo(e)?rv(e,t):mu(e)?iv(e,t):e}function At(e,t){return sv(x(e),Xe(t))}function ov(e,t={}){if(ge(e))throw new Error("Enum undefined or empty");const n=globalThis.Object.getOwnPropertyNames(e).filter(s=>isNaN(s)).map(s=>e[s]),i=[...new Set(n)].map(s=>ye(s));return Ge(i,{...t,[Ii]:"Enum"})}function av(e,t){return Uo(Ui(e),t)}function cv(e,t){const n=e.filter(r=>Cr(r,t)===k.False);return n.length===1?n[0]:Ge(n)}function Uo(e,t,n={}){return dn(e)?x(av(e,t),n):Qe(e)?x(fv(e,t),n):x(Re(e)?cv(e.anyOf,t):Cr(e,t)!==k.False?qe():e,n)}function uv(e,t){const n={};for(const r of globalThis.Object.getOwnPropertyNames(e))n[r]=Uo(e[r],t);return n}function lv(e,t){return uv(e.properties,t)}function fv(e,t){const n=lv(e,t);return Pe(n)}function dv(e,t){return xo(Ui(e),t)}function pv(e,t){const n=e.filter(r=>Cr(r,t)!==k.False);return n.length===1?n[0]:Ge(n)}function xo(e,t,n={}){return dn(e)?x(dv(e,t),n):Qe(e)?x(gv(e,t),n):x(Re(e)?pv(e.anyOf,t):Cr(e,t)!==k.False?e:qe(),n)}function hv(e,t){const n={};for(const r of globalThis.Object.getOwnPropertyNames(e))n[r]=xo(e[r],t);return n}function mv(e,t){return hv(e.properties,t)}function gv(e,t){const n=mv(e,t);return Pe(n)}function yv(e,t={}){return x(e.returns,t)}function wv(e={}){return{...e,[C]:"Integer",type:"integer"}}function bv(e,t,n){return{[e]:Jn(ye(e),t,n)}}function vv(e,t,n){return e.reduce((r,i)=>({...r,...bv(i,t,n)}),{})}function Sv(e,t,n){return vv(e.keys,t,n)}function kv(e,t,n){const r=Sv(e,t,n);return Pe(r)}function Ov(e){const[t,n]=[e.slice(0,1),e.slice(1)];return[t.toLowerCase(),n].join("")}function Iv(e){const[t,n]=[e.slice(0,1),e.slice(1)];return[t.toUpperCase(),n].join("")}function $v(e){return e.toUpperCase()}function Ev(e){return e.toLowerCase()}function Tv(e,t,n){const r=yo(e.pattern);if(!Sr(r))return{...e,pattern:ml(e.pattern,t)};const a=[..._i(r)].map(l=>ye(l)),c=gl(a,t),u=Ge(c);return Nu([u],n)}function ml(e,t){return typeof e=="string"?t==="Uncapitalize"?Ov(e):t==="Capitalize"?Iv(e):t==="Uppercase"?$v(e):t==="Lowercase"?Ev(e):e:e.toString()}function gl(e,t){return e.map(n=>Jn(n,t))}function Jn(e,t,n={}){return fn(e)?kv(e,t,n):dn(e)?Tv(e,t,e):Re(e)?Ge(gl(e.anyOf,t),n):br(e)?ye(ml(e.const,t),n):e}function Nv(e,t={}){return Jn(e,"Capitalize",t)}function Lv(e,t={}){return Jn(e,"Lowercase",t)}function Av(e,t={}){return Jn(e,"Uncapitalize",t)}function Pv(e,t={}){return Jn(e,"Uppercase",t)}function Rv(e,t){return{...t,[C]:"Not",not:x(e)}}function _v(e,t,n){const r={};for(const i of globalThis.Object.getOwnPropertyNames(e))r[i]=Fo(e[i],t,n);return r}function Cv(e,t,n){return _v(e.properties,t,n)}function jv(e,t,n){const r=Cv(e,t,n);return Pe(r)}function Uv(e,t){return e.map(n=>Mo(n,t))}function xv(e,t){return e.map(n=>Mo(n,t))}function Mv(e,t){const{[t]:n,...r}=e;return r}function Fv(e,t){return t.reduce((n,r)=>Mv(n,r),e)}function Mo(e,t){return bt(e)?mn(Uv(e.allOf,t)):Re(e)?Ge(xv(e.anyOf,t)):Lt(e)?Ne(Fv(e.properties,t)):Ne({})}function Fo(e,t,n={}){if(fn(t))return Vv(e,t,n);if(Qe(e))return jv(e,t,n);const r=pn(t)?Yt(t):t,i=st(e,[Tt,"$id","required"]),s=x(Mo(e,r),n);return{...i,...s}}function Dv(e,t,n){return{[t]:Fo(e,[t],n)}}function Bv(e,t,n){return t.reduce((r,i)=>({...r,...Dv(e,i,n)}),{})}function zv(e,t,n){return Bv(e,t.keys,n)}function Vv(e,t,n){const r=zv(e,t,n);return Pe(r)}function qv(e,t={}){return Or(Xe(e.parameters),{...t})}function yl(e){return e.map(t=>wl(t))}function Gv(e){const t={};for(const n of globalThis.Object.getOwnPropertyNames(e))t[n]=hn(e[n]);return t}function wl(e){return bt(e)?mn(yl(e.allOf)):Re(e)?Ge(yl(e.anyOf)):Lt(e)?Ne(Gv(e.properties)):Ne({})}function bl(e,t={}){if(Qe(e))return Kv(e,t);const n=st(e,[Tt,"$id","required"]),r=x(wl(e),t);return{...n,...r}}function Zv(e,t){const n={};for(const r of globalThis.Object.getOwnPropertyNames(e))n[r]=bl(e[r],t);return n}function Jv(e,t){return Zv(e.properties,t)}function Kv(e,t){const n=Jv(e,t);return Pe(n)}function Wv(e,t,n){const r={};for(const i of globalThis.Object.getOwnPropertyNames(e))r[i]=Bo(e[i],t,n);return r}function Hv(e,t,n){return Wv(e.properties,t,n)}function Yv(e,t,n){const r=Hv(e,t,n);return Pe(r)}function Xv(e,t){return e.map(n=>Do(n,t))}function Qv(e,t){return e.map(n=>Do(n,t))}function eS(e,t){const n={};for(const r of t)r in e&&(n[r]=e[r]);return n}function Do(e,t){return bt(e)?mn(Xv(e.allOf,t)):Re(e)?Ge(Qv(e.anyOf,t)):Lt(e)?Ne(eS(e.properties,t)):Ne({})}function Bo(e,t,n={}){if(fn(t))return iS(e,t,n);if(Qe(e))return Yv(e,t,n);const r=pn(t)?Yt(t):t,i=st(e,[Tt,"$id","required"]),s=x(Do(e,r),n);return{...i,...s}}function tS(e,t,n){return{[t]:Bo(e,[t],n)}}function nS(e,t,n){return t.reduce((r,i)=>({...r,...tS(e,i,n)}),{})}function rS(e,t,n){return nS(e,t.keys,n)}function iS(e,t,n){const r=rS(e,t,n);return Pe(r)}function sS(e){return gn(hn(e))}function xr(e,t,n){return{...n,[C]:"Record",type:"object",patternProperties:{[e]:x(t)}}}function zo(e,t,n){const r={};for(const i of e)r[i]=x(t);return Ne(r,{...n,[Ii]:"Record"})}function oS(e,t,n){return jm(e)?zo(Yt(e),t,n):xr(e.pattern,t,n)}function aS(e,t,n){return zo(Yt(Ge(e)),t,n)}function cS(e,t,n){return zo([e.toString()],t,n)}function uS(e,t,n){return xr(e.source,t,n)}function lS(e,t,n){const r=ge(e.pattern)?ji:e.pattern;return xr(r,t,n)}function fS(e,t,n){return xr(kr,t,n)}function dS(e,t,n){return xr(kr,t,n)}function pS(e,t,n={}){return Re(e)?aS(e.anyOf,t,n):dn(e)?oS(e,t,n):br(e)?cS(e.const,t,n):Li(e)?fS(e,t,n):Pi(e)?dS(e,t,n):gu(e)?uS(e,t,n):fo(e)?lS(e,t,n):qe(n)}let hS=0;function mS(e,t={}){ge(t.$id)&&(t.$id=`T${hS++}`);const n=e({[C]:"This",$ref:`${t.$id}`});return n.$id=t.$id,x({...t,[Ii]:"Recursive",...n})}function gS(e,t={}){if(Se(e))return{...t,[C]:"Ref",$ref:e};if(ge(e.$id))throw new Error("Reference target type must specify an $id");return{...t,[C]:"Ref",$ref:e.$id}}function yS(e,t={}){const n=Se(e)?new globalThis.RegExp(e):e;return{...t,[C]:"RegExp",type:"RegExp",source:n.source,flags:n.flags}}function vl(e){return e.map(t=>Sl(t))}function wS(e){const t={};for(const n of globalThis.Object.getOwnPropertyNames(e))t[n]=st(e[n],[Kt]);return t}function Sl(e){return bt(e)?mn(vl(e.allOf)):Re(e)?Ge(vl(e.anyOf)):Lt(e)?Ne(wS(e.properties)):Ne({})}function kl(e,t={}){if(Qe(e))return SS(e,t);{const n=st(e,[Tt,"$id","required"]),r=x(Sl(e),t);return{...n,...r}}}function bS(e,t){const n={};for(const r of globalThis.Object.getOwnPropertyNames(e))n[r]=kl(e[r],t);return n}function vS(e,t){return bS(e.properties,t)}function SS(e,t){const n=vS(e,t);return Pe(n)}function kS(e){return bt(e)?Xe(e.allOf):Re(e)?Xe(e.anyOf):xn(e)?Xe(e.items??[]):[]}function OS(e){return Xe(kS(e))}function IS(e,t={}){return x(e.returns,t)}function $S(e){return JSON.parse(JSON.stringify(e))}class ES{constructor(t){this.schema=t}Decode(t){return new TS(this.schema,t)}}class TS{constructor(t,n){this.schema=t,this.decode=n}EncodeTransform(t,n){const s={Encode:a=>n[Tt].Encode(t(a)),Decode:a=>this.decode(n[Tt].Decode(a))};return{...n,[Tt]:s}}EncodeSchema(t,n){const r={Decode:this.decode,Encode:t};return{...n,[Tt]:r}}Encode(t){const n=x(this.schema);return po(n)?this.EncodeTransform(t,n):this.EncodeSchema(t,n)}}function NS(e){return new ES(e)}function LS(e={}){return{...e,[C]:"Void",type:"void"}}const o=Object.freeze(Object.defineProperty({__proto__:null,Any:Tr,Array:uu,AsyncIterator:lu,Awaited:xb,BigInt:wo,Boolean:Iu,Capitalize:Nv,Composite:zb,Const:Gb,Constructor:fu,ConstructorParameters:Zb,Date:ll,Deref:At,Enum:ov,Exclude:Uo,Extends:_o,Extract:xo,Function:Ni,Index:vo,InstanceType:yv,Integer:wv,Intersect:mn,Iterator:_u,KeyOf:xu,Literal:ye,Lowercase:Lv,Mapped:Ng,Never:qe,Not:Rv,Null:fl,Number:Dn,Object:Ne,Omit:Fo,Optional:hn,Parameters:qv,Partial:bl,Pick:Bo,Promise:Cu,Readonly:gn,ReadonlyOptional:sS,Record:pS,Recursive:mS,Ref:gS,RegExp:yS,Required:kl,Rest:OS,ReturnType:IS,Strict:$S,String:Ht,Symbol:dl,TemplateLiteral:Nu,Transform:NS,Tuple:Or,Uint8Array:hl,Uncapitalize:Av,Undefined:pl,Union:Ge,Unknown:Nr,Unsafe:su,Uppercase:Pv,Void:LS},Symbol.toStringTag,{value:"Module"}));class v{constructor(t){h(this,"schema");h(this,"validate",t=>Pb(this.schema,t));this.schema=t}}function A(e){return o.Optional(o.Union([o.Null(),e]))}const AS=new v(o.Object({authenticated:o.Boolean()})),PS=new v(o.Object({code:o.String()})),RS=new v(o.Object({authCode:o.String()})),_S=new v(o.Object({refreshToken:o.String(),accountId:o.String(),currentUserId:o.String()})),CS=new v(o.Object({id:o.String(),email:A(o.String()),currentUserId:A(o.String()),userIds:o.Array(o.String())})),jS=new v(o.Object({entries:o.Array(o.Object({accountId:o.String(),userId:o.String(),role:o.String(),instituteId:o.String(),instituteName:A(o.String()),institutePlatform:A(o.String()),instituteOrigin:A(o.String()),courseId:o.String(),lmsCourseId:A(o.String()),courseCode:A(o.String()),courseName:A(o.String())})),currentPage:o.Number(),totalElements:o.Number(),totalPages:o.Number()})),US={authenticated:AS,accessCode:PS,accessControlAuthCode:RS,refreshTokenInfo:_S,account:CS,getAccountPortals:jS};class xS extends U{constructor(n){super(n,US);h(this,"isAuthenticated",async()=>{try{return!!(await super.fetch(`${this.config.verityOrigin}/api/verity/version/config`,{credentials:"include"})).ok}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"getAccessCode",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/session/access-code`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)});if(r.ok){const i=await r.json();if(this.schemaValidators.accessCode.validate(i))return i.code}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getAccessControlAuthCode",async()=>{try{const n=await this.getAccountId(),r=await super.fetch(`${this.config.verityOrigin}/api/access-control/account/${n}/auth-code`,{method:"POST"});if(r.ok){const i=await r.json();if(this.schemaValidators.accessControlAuthCode.validate(i))return{accountId:n,authCode:i.authCode}}}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"getRefreshTokenFromAuthCode",async(n,r)=>{try{const i=await fetch(`${this.config.verityOrigin}/api/access-control/account/${n}/refresh-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({authCode:r})});if(i.ok){const s=await i.json();if(this.schemaValidators.refreshTokenInfo.validate(s))return s}}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"validateUserFromServer",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/session/validate/user?${n}`,{credentials:"include"});return!!(r.ok&&r.status===200)}catch(r){if(r instanceof Error)throw new f(r)}});h(this,"getAccount",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/access-control/account/${n}`);if(r.ok){const i=await r.json();if(this.schemaValidators.account.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"logout",async()=>{try{if((await super.fetch(`${this.config.verityOrigin}/api/verity/session/end`,{credentials:"include"})).ok)return}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"logFailedAuth",async n=>{try{await super.fetch(`${this.config.verityOrigin}/api/verity/debug/auth`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:n})});return}catch(r){if(r instanceof Error)throw new f(r)}});h(this,"getAccountPortals",async({accountId:n,searchQuery:r,page:i,size:s})=>{try{const a=new URLSearchParams;r&&a.set("searchQuery",r),a.set("page",i.toString()),a.set("size",s.toString());const c=await super.fetch(`${this.config.verityOrigin}/api/access-control/account/${n}/portals?${a.toString()}`,{method:"GET",credentials:"include"});if(c.ok){const u=await c.json();if(this.schemaValidators.getAccountPortals.validate(u))return u}}catch(a){if(a instanceof Error)throw new f(a)}throw new f});h(this,"setCurrentuserId",async({accountId:n,userId:r})=>{try{if((await super.fetch(`${this.config.verityOrigin}/api/access-control/account/${n}/current-user/${r}`,{method:"PUT",credentials:"include"})).ok)return}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"mapNonLmsUser",async({userUuid:n,courseUuid:r,instituteUuid:i})=>{try{if((await super.fetch(`${this.config.verityOrigin}/api/verity/portal/map`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({userUuid:n,courseUuid:r,instituteUuid:i})})).ok)return}catch(s){if(s instanceof Error)throw new f(s)}throw new f})}}const MS=new v(o.Object({type:o.Literal("access code"),name:o.Literal("save password disabled"),time:o.Date(),details:o.Object({success:o.Boolean()})})),FS=new v(o.Object({type:o.Literal("access code"),name:o.Literal("save password reset"),time:o.Date(),details:o.Object({success:o.Boolean()})})),DS=new v(o.Object({type:o.Literal("access code"),name:o.Literal("autofill"),time:o.Date(),details:o.Object({success:o.Boolean(),password:o.Optional(o.String())})})),BS={accessCodeDisableEvent:MS,accessCodeResetEvent:FS,accessCodeAutofillEvent:DS},lc=class lc extends U{constructor(n,r){super(n,BS);_t(this,hr);h(this,"emitter");h(this,"disable",async(n,r)=>{await he(this,hr,Gs).call(this,n,{type:"access code",name:"save password disabled",time:new Date,details:r})});h(this,"reset",async(n,r)=>{await he(this,hr,Gs).call(this,n,{type:"access code",name:"save password reset",time:new Date,details:r})});h(this,"autofill",async(n,r)=>{await he(this,hr,Gs).call(this,n,{type:"access code",name:"autofill",time:new Date,details:r})});this.emitter=r}};hr=new WeakSet,Gs=async function(n,r){try{if(this.emitter.emit("log",r),(await Gt(lc.prototype,this,"fetch").call(this,`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:r.type,name:r.name,time:r.time,details:r.details}),credentials:"include"})).ok)return!0}catch(i){if(i instanceof Error)throw new f(i)}throw new f};let Vo=lc;const zS=new v(o.Object({type:o.Literal("clipboard"),name:o.Literal("disable"),time:o.Date(),details:o.Object({success:o.Boolean()})})),VS=new v(o.Object({type:o.Literal("clipboard"),name:o.Literal("keypress"),time:o.Date(),details:o.Object({keypress:o.String(),value:o.Optional(o.String())})})),qS={clipboardDisableEvent:zS,clipboardKeypressEvent:VS},fc=class fc extends U{constructor(n,r){super(n,qS);_t(this,fi);h(this,"emitter");h(this,"disable",async(n,r)=>{await he(this,fi,$c).call(this,n,{type:"clipboard",name:"disable",time:new Date,details:r})});h(this,"keypress",async(n,r)=>{await he(this,fi,$c).call(this,n,{type:"clipboard",name:"keypress",time:new Date,details:r})});this.emitter=r}};fi=new WeakSet,$c=async function(n,r){try{if(this.emitter.emit("log",r),(await Gt(fc.prototype,this,"fetch").call(this,`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:r.type,name:r.name,time:r.time,details:r.details}),credentials:"include"})).ok)return!0}catch(i){if(i instanceof Error)throw new f(i)}throw new f};let qo=fc;const Ol={httpWebNavigationEvent:new v(o.Object({type:o.Literal("web navigation"),name:o.Union([o.Literal("webRequest"),o.Literal("webNavigation")]),time:o.Date(),details:o.Object({url:o.String(),method:o.Optional(o.String()),frame:o.Optional(o.String())})}))};class GS extends U{constructor(n,r){super(n,Ol);h(this,"emitter");h(this,"webNavigation",async(n,r,i)=>{try{const s={type:"web navigation",name:r,time:new Date,details:i};if(this.emitter.emit("log",s),Ol.httpWebNavigationEvent.validate(s)&&(await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s),credentials:"include"})).ok)return!0}catch(s){if(s instanceof Error)throw new f(s)}throw new f});this.emitter=r}}const ZS=new v(o.Object({type:o.Literal("screenshot"),name:o.Literal("disable"),time:o.Date(),details:o.Object({success:o.Boolean()})})),JS=new v(o.Object({type:o.Literal("screenshot"),name:o.Literal("keypress"),time:o.Date(),details:o.Object({keypress:o.String()})})),KS={screenshotDisableEvent:ZS,screenshotKeypressEvent:JS},dc=class dc extends U{constructor(n,r){super(n,KS);_t(this,di);h(this,"emitter");h(this,"disable",async(n,r)=>{await he(this,di,Ec).call(this,n,{type:"screenshot",name:"disable",time:new Date,details:r})});h(this,"keypress",async(n,r)=>{await he(this,di,Ec).call(this,n,{type:"screenshot",name:"keypress",time:new Date,details:r})});this.emitter=r}};di=new WeakSet,Ec=async function(n,r){try{if(this.emitter.emit("log",r),(await Gt(dc.prototype,this,"fetch").call(this,`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:r.type,name:r.name,time:r.time,details:r.details}),credentials:"include"})).ok)return!0}catch(i){if(i instanceof Error)throw new f(i)}throw new f};let Go=dc;const WS=new v(o.Object({type:o.Literal("session"),name:o.Literal("start quiz"),time:o.Date(),details:o.Object({success:o.Boolean()})})),HS=new v(o.Object({type:o.Literal("session"),name:o.Literal("end quiz"),time:o.Date(),details:o.Object({success:o.Boolean()})})),YS=new v(o.Object({type:o.Literal("session"),name:o.Literal("end proctoring"),time:o.Date(),details:o.Object({success:o.Boolean()})})),XS={startAssessmentEvent:WS,endAssessmentEvent:HS,endProctoringEvent:YS},pc=class pc extends U{constructor(n,r){super(n,XS);_t(this,mr);h(this,"emitter");h(this,"startAssessment",async({proctoringSessionId:n,event:r})=>await he(this,mr,Zs).call(this,{proctoringSessionId:n,event:{type:"session",name:"start quiz",...r}}));h(this,"endAssessment",async({proctoringSessionId:n,event:r})=>await he(this,mr,Zs).call(this,{proctoringSessionId:n,event:{type:"session",name:"end quiz",...r}}));h(this,"endProctoring",async({proctoringSessionId:n,event:r})=>await he(this,mr,Zs).call(this,{proctoringSessionId:n,event:{type:"session",name:"end proctoring",...r}}));this.emitter=r}};mr=new WeakSet,Zs=async function({proctoringSessionId:n,event:r}){try{this.emitter.emit("log",r);const i=await Gt(pc.prototype,this,"fetch").call(this,`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r),credentials:"include"});if(!i.ok)throw new f(new Error(`Invalid Response: ${i.status} - ${i.statusText}`))}catch(i){if(i instanceof Error)throw new f(i)}};let Zo=pc;const QS=new v(o.Object({type:o.Literal("tab"),name:o.Literal("close one"),time:o.Date(),details:o.Object({url:o.String(),title:o.String(),autoClose:o.Boolean()})})),ek=new v(o.Object({type:o.Literal("tab"),name:o.Literal("create"),time:o.Date(),details:o.Object({url:o.String(),title:o.String()})})),tk=new v(o.Object({type:o.Literal("tab"),name:o.Literal("whitelist"),time:o.Date(),details:o.Object({success:o.Boolean(),whiteList:o.Array(o.String())})})),nk=new v(o.Object({type:o.Literal("tab"),name:o.Literal("disable"),time:o.Date(),details:o.Object({success:o.Boolean()})})),rk=new v(o.Object({type:o.Literal("tab"),name:o.Literal("focus"),time:o.Date(),details:o.Object({focus:o.Boolean()})})),ik={tabCloseOneEvent:QS,tabCreateEvent:ek,tabWhitelistEvent:tk,tabDisableEvent:nk,tabFocusEvent:rk},hc=class hc extends U{constructor(n,r){super(n,ik);_t(this,un);h(this,"emitter");h(this,"closeOne",async(n,r)=>{await he(this,un,yr).call(this,n,{type:"tab",name:"close one",time:new Date,details:r})});h(this,"create",async(n,r)=>{await he(this,un,yr).call(this,n,{type:"tab",name:"create",time:new Date,details:r})});h(this,"whitelist",async(n,r)=>{await he(this,un,yr).call(this,n,{type:"tab",name:"whitelist",time:new Date,details:r})});h(this,"disable",async(n,r)=>{await he(this,un,yr).call(this,n,{type:"tab",name:"disable",time:new Date,details:r})});h(this,"focus",async(n,r)=>{await he(this,un,yr).call(this,n,{type:"tab",name:"focus",time:new Date,details:r})});this.emitter=r}};un=new WeakSet,yr=async function(n,r){try{if(this.emitter.emit("log",r),(await Gt(hc.prototype,this,"fetch").call(this,`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:r.type,name:r.name,time:r.time,details:r.details}),credentials:"include"})).ok)return!0}catch(i){if(i instanceof Error)throw new f(i)}throw new f};let Jo=hc;const sk={keyboardKeypressEvent:new v(o.Object({type:o.Literal("keyboard"),name:o.Literal("keypress"),time:o.Date(),details:o.Object({value:o.String()})}))},mc=class mc extends U{constructor(n,r){super(n,sk);_t(this,Fs);h(this,"emitter");h(this,"keypress",async(n,r)=>{await he(this,Fs,Up).call(this,n,{type:"keyboard",name:"keypress",time:new Date,details:r})});this.emitter=r}};Fs=new WeakSet,Up=async function(n,r){try{if(this.emitter.emit("log",r),(await Gt(mc.prototype,this,"fetch").call(this,`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:r.type,name:r.name,time:r.time,details:r.details}),credentials:"include"})).ok)return!0}catch(i){if(i instanceof Error)throw new f(i)}throw new f};let Ko=mc;const ok=new v(o.Object({type:o.Literal("live"),name:o.Literal("audio bridge"),time:o.Date(),details:o.Object({success:o.Boolean()})})),ak=new v(o.Object({type:o.Literal("live"),name:o.Literal("proctor joined"),time:o.Date(),details:o.Object({proctorId:o.String(),count:o.Optional(o.Number())})})),ck=new v(o.Object({type:o.Literal("live"),name:o.Literal("proctor left"),time:o.Date(),details:o.Object({proctorId:o.String(),count:o.Optional(o.Number())})})),uk=new v(o.Object({type:o.Literal("live"),name:o.Literal("join session"),time:o.Date(),details:o.Object({liveSessionId:o.String(),liveUserSessionId:o.String(),proctorIds:o.Optional(o.Array(o.String())),proctorGroupIds:o.Optional(o.Array(o.Number()))})})),lk=new v(o.Object({type:o.Literal("live"),name:o.Literal("no proctors"),time:o.Date(),details:o.Object({isOnJoin:o.Boolean()})})),Kn={liveBuildAudioBridgeEvent:ok,liveProctorJoinedEvent:ak,liveProctorLeftEvent:ck,liveJoinSessionEvent:uk,noProctorsEvent:lk};class fk extends U{constructor(n,r){super(n,Kn);h(this,"emitter");h(this,"createAudioBridge",async(n,r)=>{try{const i={type:"live",name:"audio bridge",time:new Date,details:r};if(this.emitter.emit("log",i),Kn.liveBuildAudioBridgeEvent.validate(i)&&(await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i),credentials:"include"})).ok)return!0}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"proctorJoined",async(n,r)=>{try{const i={type:"live",name:"proctor joined",time:new Date,details:r};if(this.emitter.emit("log",i),Kn.liveProctorJoinedEvent.validate(i)&&(await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i),credentials:"include"})).ok)return!0}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"proctorLeft",async(n,r)=>{try{const i={type:"live",name:"proctor left",time:new Date,details:r};if(this.emitter.emit("log",i),Kn.liveProctorLeftEvent.validate(i)&&(await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i),credentials:"include"})).ok)return!0}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"joinedSession",async(n,r)=>{try{const i={type:"live",name:"join session",time:new Date,details:r};if(this.emitter.emit("log",i),Kn.liveJoinSessionEvent.validate(i)&&(await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i),credentials:"include"})).ok)return!0}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"noProctors",async(n,r)=>{try{const i={type:"live",name:"no proctors",time:new Date,details:r};if(this.emitter.emit("log",i),Kn.noProctorsEvent.validate(i)&&(await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i),credentials:"include"})).ok)return!0}catch(i){if(i instanceof Error)throw new f(i)}throw new f});this.emitter=r}}const dk={connectionCheckEvent:new v(o.Object({type:o.Literal("system"),name:o.Literal("connection check"),time:o.Date(),details:o.Object({metrics:o.Any(),uploadSpeed:o.Number()})}))};class pk extends U{constructor(n){super(n,dk);h(this,"connectionCheck",async(n,r,i)=>{try{if(n===""&&r)return!0;const s={type:"system",name:"connection check",time:new Date,details:i};if((await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s),credentials:"include"})).ok)return!0}catch(s){if(s instanceof Error)throw new f(s)}throw new f})}}const hk=new v(o.Object({type:o.Literal("face detection"),name:o.Literal("other"),time:o.Date(),details:o.Object({count:o.Number()})})),mk=new v(o.Object({type:o.Literal("face detection"),name:o.Literal("target"),time:o.Date(),details:o.Object({count:o.Number()})})),gk={otherFaceDetectedEvent:hk,targetFaceDetectedEvent:mk};class yk extends U{constructor(t){super(t,gk)}async facesDetected(t,{who:n,count:r}){try{if((await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/event/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"face detection",name:n,time:new Date,details:{count:r}}),credentials:"include"})).ok)return!0}catch(i){if(i instanceof Error)throw new f(i)}throw new f}}const wk=new v(o.Object({type:o.Literal("interrupt"),name:o.Literal("trigger"),time:o.Date(),details:o.Object({success:o.Boolean(),type:o.Union([o.Literal("webcam"),o.Literal("display"),o.Literal("monitor count"),o.Literal("face recorder"),o.Literal("speaking")])})})),bk=new v(o.Object({type:o.Literal("interrupt"),name:o.Literal("resume"),time:o.Date(),details:o.Object({success:o.Boolean(),type:o.Union([o.Literal("webcam"),o.Literal("display"),o.Literal("monitor count"),o.Literal("face recorder")])})})),vk={interruptTriggerEvent:wk,interruptResumeEvent:bk},gc=class gc extends U{constructor(n,r){super(n,vk);_t(this,pi);h(this,"emitter");h(this,"trigger",async(n,r)=>{await he(this,pi,Tc).call(this,n,{type:"interrupt",name:"trigger",time:new Date,details:r})});h(this,"resume",async(n,r)=>{await he(this,pi,Tc).call(this,n,{type:"interrupt",name:"resume",time:new Date,details:r})});this.emitter=r}};pi=new WeakSet,Tc=async function(n,r){try{if(this.emitter.emit("log",r),(await Gt(gc.prototype,this,"fetch").call(this,`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:r.type,name:r.name,time:r.time,details:r.details}),credentials:"include"})).ok)return!0}catch(i){if(i instanceof Error)throw new f(i)}throw new f};let Wo=gc;const Sk=new v(o.Object({type:o.Literal("user action"),name:o.Literal("right click blocked"),time:o.Date(),details:o.Object({})})),kk=new v(o.Object({type:o.Literal("user action"),name:o.Literal("printing blocked"),time:o.Date(),details:o.Object({})})),Ok={rightClickBlockedEvent:Sk,printingBlockedEvent:kk},yc=class yc extends U{constructor(n,r){super(n,Ok);_t(this,hi);h(this,"emitter");h(this,"rightClickBlocked",async(n,r)=>{await he(this,hi,Nc).call(this,n,{type:"user action",name:"right click blocked",time:new Date,details:r})});h(this,"printingBlocked",async(n,r)=>{await he(this,hi,Nc).call(this,n,{type:"user action",name:"printing blocked",time:new Date,details:r})});this.emitter=r}};hi=new WeakSet,Nc=async function(n,r){try{if(this.emitter.emit("log",r),(await Gt(yc.prototype,this,"fetch").call(this,`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:r.type,name:r.name,time:r.time,details:r.details}),credentials:"include"})).ok)return!0}catch(i){if(i instanceof Error)throw new f(i)}throw new f};let Ho=yc;const Ik=o.Object({bbox:o.Object({normalizedX:o.Number(),normalizedY:o.Number(),normalizedWidth:o.Number(),normalizedHeight:o.Number()}),bboxRaw:o.Object({x:o.Number(),y:o.Number(),width:o.Number(),height:o.Number()}),score:o.Number(),gestures:o.Array(o.String()),similarity:A(o.Number()),embedding:A(o.Array(o.Number()))}),$k=new v(o.Partial(o.Object({type:o.String(),name:o.String(),time:o.Date(),details:o.Object({topic:o.String(),metadata:A(o.Object({duration:A(o.Number())})),detections:o.Array(o.Partial(Ik))})}))),Ek=o.Object({bbox:o.Object({normalizedX:o.Number(),normalizedY:o.Number(),normalizedWidth:o.Number(),normalizedHeight:o.Number()}),bboxRaw:o.Object({x:o.Number(),y:o.Number(),width:o.Number(),height:o.Number()}),score:o.Number(),name:o.String()}),Tk=new v(o.Partial(o.Object({type:o.String(),name:o.String(),time:o.Date(),details:o.Object({topic:o.String(),metadata:A(o.Object({duration:A(o.Number())})),detections:o.Array(o.Partial(Ek))})}))),Nk={faceWorkerEvent:$k,objectWorkerEvent:Tk};class Lk extends U{constructor(n){super(n,Nk);h(this,"logFaceWorkerEvent",async({sessionId:n,event:r})=>{await tt(super.fetch(`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}))});h(this,"logObjectWorkerEvent",async({sessionId:n,event:r})=>{await tt(super.fetch(`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}))})}}const Il={logStartRecording:new v(o.String())};class Ak extends U{constructor(n){super(n,Il);h(this,"logStartRecording",async({sessionId:n,recordingDetails:r})=>{const i=await tt(super.fetch(`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"session",name:"start recording",time:new Date,details:{...r,success:!0}})}));try{const s=await i.json();if(!Il.logStartRecording.validate(s))throw new f(new Error(`Invalid log start recording: ${JSON.stringify(s)}`));return s}catch{return""}});h(this,"logEndRecording",async({sessionId:n,recordingDetails:r})=>{await tt(super.fetch(`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"session",name:"end recording",time:new Date,details:{...r,success:!0}})}))});h(this,"logEndUpload",async({sessionId:n,recordingDetails:r})=>{await tt(super.fetch(`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"session",name:"end upload",time:new Date,details:r})}))})}}function E(e,t,n){function r(c,u){var l;Object.defineProperty(c,"_zod",{value:c._zod??{},enumerable:!1}),(l=c._zod).traits??(l.traits=new Set),c._zod.traits.add(e),t(c,u);for(const m in a.prototype)m in c||Object.defineProperty(c,m,{value:a.prototype[m].bind(c)});c._zod.constr=a,c._zod.def=u}const i=(n==null?void 0:n.Parent)??Object;class s extends i{}Object.defineProperty(s,"name",{value:e});function a(c){var u;const l=n!=null&&n.Parent?new s:this;r(l,c),(u=l._zod).deferred??(u.deferred=[]);for(const m of l._zod.deferred)m();return l}return Object.defineProperty(a,"init",{value:r}),Object.defineProperty(a,Symbol.hasInstance,{value:c=>{var u,l;return n!=null&&n.Parent&&c instanceof n.Parent?!0:(l=(u=c==null?void 0:c._zod)==null?void 0:u.traits)==null?void 0:l.has(e)}}),Object.defineProperty(a,"name",{value:e}),a}class Mr extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const Yo={};function Sn(e){return e&&Object.assign(Yo,e),Yo}function Pk(e){const t=Object.values(e).filter(r=>typeof r=="number");return Object.entries(e).filter(([r,i])=>t.indexOf(+r)===-1).map(([r,i])=>i)}function Rk(e,t){return typeof t=="bigint"?t.toString():t}function Xo(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function Qo(e){return e==null}function ea(e){const t=e.startsWith("^")?1:0,n=e.endsWith("$")?e.length-1:e.length;return e.slice(t,n)}function re(e,t,n){Object.defineProperty(e,t,{get(){{const r=n();return e[t]=r,r}},set(r){Object.defineProperty(e,t,{value:r})},configurable:!0})}function ta(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0})}function Fr(e){return JSON.stringify(e)}const $l=Error.captureStackTrace?Error.captureStackTrace:(...e)=>{};function Wi(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const _k=Xo(()=>{var e;if(typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)!=null&&e.includes("Cloudflare")))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function na(e){if(Wi(e)===!1)return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(Wi(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}const Ck=new Set(["string","number","symbol"]),jk=new Set(["string","number","bigint","boolean","symbol","undefined"]);function Wn(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function kn(e,t,n){const r=new e._zod.constr(t??e._zod.def);return(!t||n!=null&&n.parent)&&(r._zod.parent=e),r}function j(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if((t==null?void 0:t.message)!==void 0){if((t==null?void 0:t.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function Uk(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}function xk(e,t){const n={},r=e._zod.def;for(const i in t){if(!(i in r.shape))throw new Error(`Unrecognized key: "${i}"`);t[i]&&(n[i]=r.shape[i])}return kn(e,{...e._zod.def,shape:n,checks:[]})}function Mk(e,t){const n={...e._zod.def.shape},r=e._zod.def;for(const i in t){if(!(i in r.shape))throw new Error(`Unrecognized key: "${i}"`);t[i]&&delete n[i]}return kn(e,{...e._zod.def,shape:n,checks:[]})}function Fk(e,t){if(!na(t))throw new Error("Invalid input to extend: expected a plain object");const n={...e._zod.def,get shape(){const r={...e._zod.def.shape,...t};return ta(this,"shape",r),r},checks:[]};return kn(e,n)}function Dk(e,t){return kn(e,{...e._zod.def,get shape(){const n={...e._zod.def.shape,...t._zod.def.shape};return ta(this,"shape",n),n},catchall:t._zod.def.catchall,checks:[]})}function Bk(e,t,n){const r=t._zod.def.shape,i={...r};if(n)for(const s in n){if(!(s in r))throw new Error(`Unrecognized key: "${s}"`);n[s]&&(i[s]=e?new e({type:"optional",innerType:r[s]}):r[s])}else for(const s in r)i[s]=e?new e({type:"optional",innerType:r[s]}):r[s];return kn(t,{...t._zod.def,shape:i,checks:[]})}function zk(e,t,n){const r=t._zod.def.shape,i={...r};if(n)for(const s in n){if(!(s in i))throw new Error(`Unrecognized key: "${s}"`);n[s]&&(i[s]=new e({type:"nonoptional",innerType:r[s]}))}else for(const s in r)i[s]=new e({type:"nonoptional",innerType:r[s]});return kn(t,{...t._zod.def,shape:i,checks:[]})}function Dr(e,t=0){var n;for(let r=t;r<e.issues.length;r++)if(((n=e.issues[r])==null?void 0:n.continue)!==!0)return!0;return!1}function ra(e,t){return t.map(n=>{var r;return(r=n).path??(r.path=[]),n.path.unshift(e),n})}function Hi(e){return typeof e=="string"?e:e==null?void 0:e.message}function On(e,t,n){var i,s,a,c,u,l;const r={...e,path:e.path??[]};if(!e.message){const m=Hi((a=(s=(i=e.inst)==null?void 0:i._zod.def)==null?void 0:s.error)==null?void 0:a.call(s,e))??Hi((c=t==null?void 0:t.error)==null?void 0:c.call(t,e))??Hi((u=n.customError)==null?void 0:u.call(n,e))??Hi((l=n.localeError)==null?void 0:l.call(n,e))??"Invalid input";r.message=m}return delete r.inst,delete r.continue,t!=null&&t.reportInput||delete r.input,r}function ia(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function Br(...e){const[t,n,r]=e;return typeof t=="string"?{message:t,code:"custom",input:n,inst:r}:{...t}}const El=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),Object.defineProperty(e,"message",{get(){return JSON.stringify(t,Rk,2)},enumerable:!0}),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Tl=E("$ZodError",El),Nl=E("$ZodError",El,{Parent:Error});function Vk(e,t=n=>n.message){const n={},r=[];for(const i of e.issues)i.path.length>0?(n[i.path[0]]=n[i.path[0]]||[],n[i.path[0]].push(t(i))):r.push(t(i));return{formErrors:r,fieldErrors:n}}function qk(e,t){const n=t||function(s){return s.message},r={_errors:[]},i=s=>{for(const a of s.issues)if(a.code==="invalid_union"&&a.errors.length)a.errors.map(c=>i({issues:c}));else if(a.code==="invalid_key")i({issues:a.issues});else if(a.code==="invalid_element")i({issues:a.issues});else if(a.path.length===0)r._errors.push(n(a));else{let c=r,u=0;for(;u<a.path.length;){const l=a.path[u];u===a.path.length-1?(c[l]=c[l]||{_errors:[]},c[l]._errors.push(n(a))):c[l]=c[l]||{_errors:[]},c=c[l],u++}}};return i(e),r}const Gk=e=>(t,n,r,i)=>{const s=r?Object.assign(r,{async:!1}):{async:!1},a=t._zod.run({value:n,issues:[]},s);if(a instanceof Promise)throw new Mr;if(a.issues.length){const c=new((i==null?void 0:i.Err)??e)(a.issues.map(u=>On(u,s,Sn())));throw $l(c,i==null?void 0:i.callee),c}return a.value},Zk=e=>async(t,n,r,i)=>{const s=r?Object.assign(r,{async:!0}):{async:!0};let a=t._zod.run({value:n,issues:[]},s);if(a instanceof Promise&&(a=await a),a.issues.length){const c=new((i==null?void 0:i.Err)??e)(a.issues.map(u=>On(u,s,Sn())));throw $l(c,i==null?void 0:i.callee),c}return a.value},Ll=e=>(t,n,r)=>{const i=r?{...r,async:!1}:{async:!1},s=t._zod.run({value:n,issues:[]},i);if(s instanceof Promise)throw new Mr;return s.issues.length?{success:!1,error:new(e??Tl)(s.issues.map(a=>On(a,i,Sn())))}:{success:!0,data:s.value}},Jk=Ll(Nl),Al=e=>async(t,n,r)=>{const i=r?Object.assign(r,{async:!0}):{async:!0};let s=t._zod.run({value:n,issues:[]},i);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new e(s.issues.map(a=>On(a,i,Sn())))}:{success:!0,data:s.value}},Kk=Al(Nl),Wk=/^[cC][^\s-]{8,}$/,Hk=/^[0-9a-z]+$/,Yk=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Xk=/^[0-9a-vA-V]{20}$/,Qk=/^[A-Za-z0-9]{27}$/,eO=/^[a-zA-Z0-9_-]{21}$/,tO=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,nO=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Pl=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,rO=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,iO="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function sO(){return new RegExp(iO,"u")}const oO=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,aO=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,cO=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,uO=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,lO=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Rl=/^[A-Za-z0-9_-]*$/,fO=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,dO=/^\+(?:[0-9]){6,14}[0-9]$/,_l="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",pO=new RegExp(`^${_l}$`);function Cl(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function hO(e){return new RegExp(`^${Cl(e)}$`)}function mO(e){const t=Cl({precision:e.precision}),n=["Z"];e.local&&n.push(""),e.offset&&n.push("([+-]\\d{2}:\\d{2})");const r=`${t}(?:${n.join("|")})`;return new RegExp(`^${_l}T(?:${r})$`)}const gO=e=>{const t=e?`[\\s\\S]{${(e==null?void 0:e.minimum)??0},${(e==null?void 0:e.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},yO=/true|false/i,wO=/^[^A-Z]*$/,bO=/^[^a-z]*$/,ut=E("$ZodCheck",(e,t)=>{var n;e._zod??(e._zod={}),e._zod.def=t,(n=e._zod).onattach??(n.onattach=[])}),jl={number:"number",bigint:"bigint",object:"date"},vO=E("$ZodCheckLessThan",(e,t)=>{ut.init(e,t);const n=jl[typeof t.value];e._zod.onattach.push(r=>{const i=r._zod.bag,s=(t.inclusive?i.maximum:i.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<s&&(t.inclusive?i.maximum=t.value:i.exclusiveMaximum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value<=t.value:r.value<t.value)||r.issues.push({origin:n,code:"too_big",maximum:t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),SO=E("$ZodCheckGreaterThan",(e,t)=>{ut.init(e,t);const n=jl[typeof t.value];e._zod.onattach.push(r=>{const i=r._zod.bag,s=(t.inclusive?i.minimum:i.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>s&&(t.inclusive?i.minimum=t.value:i.exclusiveMinimum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value>=t.value:r.value>t.value)||r.issues.push({origin:n,code:"too_small",minimum:t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),kO=E("$ZodCheckMaxLength",(e,t)=>{var n;ut.init(e,t),(n=e._zod.def).when??(n.when=r=>{const i=r.value;return!Qo(i)&&i.length!==void 0}),e._zod.onattach.push(r=>{const i=r._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<i&&(r._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{const i=r.value;if(i.length<=t.maximum)return;const a=ia(i);r.issues.push({origin:a,code:"too_big",maximum:t.maximum,inclusive:!0,input:i,inst:e,continue:!t.abort})}}),OO=E("$ZodCheckMinLength",(e,t)=>{var n;ut.init(e,t),(n=e._zod.def).when??(n.when=r=>{const i=r.value;return!Qo(i)&&i.length!==void 0}),e._zod.onattach.push(r=>{const i=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>i&&(r._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{const i=r.value;if(i.length>=t.minimum)return;const a=ia(i);r.issues.push({origin:a,code:"too_small",minimum:t.minimum,inclusive:!0,input:i,inst:e,continue:!t.abort})}}),IO=E("$ZodCheckLengthEquals",(e,t)=>{var n;ut.init(e,t),(n=e._zod.def).when??(n.when=r=>{const i=r.value;return!Qo(i)&&i.length!==void 0}),e._zod.onattach.push(r=>{const i=r._zod.bag;i.minimum=t.length,i.maximum=t.length,i.length=t.length}),e._zod.check=r=>{const i=r.value,s=i.length;if(s===t.length)return;const a=ia(i),c=s>t.length;r.issues.push({origin:a,...c?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),Yi=E("$ZodCheckStringFormat",(e,t)=>{var n,r;ut.init(e,t),e._zod.onattach.push(i=>{const s=i._zod.bag;s.format=t.format,t.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(t.pattern))}),t.pattern?(n=e._zod).check??(n.check=i=>{t.pattern.lastIndex=0,!t.pattern.test(i.value)&&i.issues.push({origin:"string",code:"invalid_format",format:t.format,input:i.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(r=e._zod).check??(r.check=()=>{})}),$O=E("$ZodCheckRegex",(e,t)=>{Yi.init(e,t),e._zod.check=n=>{t.pattern.lastIndex=0,!t.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),EO=E("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=wO),Yi.init(e,t)}),TO=E("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=bO),Yi.init(e,t)}),NO=E("$ZodCheckIncludes",(e,t)=>{ut.init(e,t);const n=Wn(t.includes),r=new RegExp(typeof t.position=="number"?`^.{${t.position}}${n}`:n);t.pattern=r,e._zod.onattach.push(i=>{const s=i._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(r)}),e._zod.check=i=>{i.value.includes(t.includes,t.position)||i.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:i.value,inst:e,continue:!t.abort})}}),LO=E("$ZodCheckStartsWith",(e,t)=>{ut.init(e,t);const n=new RegExp(`^${Wn(t.prefix)}.*`);t.pattern??(t.pattern=n),e._zod.onattach.push(r=>{const i=r._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(n)}),e._zod.check=r=>{r.value.startsWith(t.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:r.value,inst:e,continue:!t.abort})}}),AO=E("$ZodCheckEndsWith",(e,t)=>{ut.init(e,t);const n=new RegExp(`.*${Wn(t.suffix)}$`);t.pattern??(t.pattern=n),e._zod.onattach.push(r=>{const i=r._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(n)}),e._zod.check=r=>{r.value.endsWith(t.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:r.value,inst:e,continue:!t.abort})}}),PO=E("$ZodCheckOverwrite",(e,t)=>{ut.init(e,t),e._zod.check=n=>{n.value=t.tx(n.value)}});class RO{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const r=t.split(`
`).filter(a=>a),i=Math.min(...r.map(a=>a.length-a.trimStart().length)),s=r.map(a=>a.slice(i)).map(a=>" ".repeat(this.indent*2)+a);for(const a of s)this.content.push(a)}compile(){const t=Function,n=this==null?void 0:this.args,i=[...((this==null?void 0:this.content)??[""]).map(s=>`  ${s}`)];return new t(...n,i.join(`
`))}}const _O={major:4,minor:0,patch:0},ne=E("$ZodType",(e,t)=>{var i;var n;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=_O;const r=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&r.unshift(e);for(const s of r)for(const a of s._zod.onattach)a(e);if(r.length===0)(n=e._zod).deferred??(n.deferred=[]),(i=e._zod.deferred)==null||i.push(()=>{e._zod.run=e._zod.parse});else{const s=(a,c,u)=>{let l=Dr(a),m;for(const g of c){if(g._zod.def.when){if(!g._zod.def.when(a))continue}else if(l)continue;const d=a.issues.length,p=g._zod.check(a);if(p instanceof Promise&&(u==null?void 0:u.async)===!1)throw new Mr;if(m||p instanceof Promise)m=(m??Promise.resolve()).then(async()=>{await p,a.issues.length!==d&&(l||(l=Dr(a,d)))});else{if(a.issues.length===d)continue;l||(l=Dr(a,d))}}return m?m.then(()=>a):a};e._zod.run=(a,c)=>{const u=e._zod.parse(a,c);if(u instanceof Promise){if(c.async===!1)throw new Mr;return u.then(l=>s(l,r,c))}return s(u,r,c)}}e["~standard"]={validate:s=>{var a;try{const c=Jk(e,s);return c.success?{value:c.data}:{issues:(a=c.error)==null?void 0:a.issues}}catch{return Kk(e,s).then(u=>{var l;return u.success?{value:u.data}:{issues:(l=u.error)==null?void 0:l.issues}})}},vendor:"zod",version:1}}),sa=E("$ZodString",(e,t)=>{var n;ne.init(e,t),e._zod.pattern=[...((n=e==null?void 0:e._zod.bag)==null?void 0:n.patterns)??[]].pop()??gO(e._zod.bag),e._zod.parse=(r,i)=>{if(t.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}),oe=E("$ZodStringFormat",(e,t)=>{Yi.init(e,t),sa.init(e,t)}),CO=E("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=nO),oe.init(e,t)}),jO=E("$ZodUUID",(e,t)=>{if(t.version){const r={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(r===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Pl(r))}else t.pattern??(t.pattern=Pl());oe.init(e,t)}),UO=E("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=rO),oe.init(e,t)}),xO=E("$ZodURL",(e,t)=>{oe.init(e,t),e._zod.check=n=>{try{const r=n.value,i=new URL(r),s=i.href;t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(i.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:fO.source,input:n.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:n.value,inst:e,continue:!t.abort})),!r.endsWith("/")&&s.endsWith("/")?n.value=s.slice(0,-1):n.value=s;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:e,continue:!t.abort})}}}),MO=E("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=sO()),oe.init(e,t)}),FO=E("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=eO),oe.init(e,t)}),DO=E("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=Wk),oe.init(e,t)}),BO=E("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=Hk),oe.init(e,t)}),zO=E("$ZodULID",(e,t)=>{t.pattern??(t.pattern=Yk),oe.init(e,t)}),VO=E("$ZodXID",(e,t)=>{t.pattern??(t.pattern=Xk),oe.init(e,t)}),qO=E("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=Qk),oe.init(e,t)}),GO=E("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=mO(t)),oe.init(e,t)}),ZO=E("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=pO),oe.init(e,t)}),JO=E("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=hO(t)),oe.init(e,t)}),KO=E("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=tO),oe.init(e,t)}),WO=E("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=oO),oe.init(e,t),e._zod.onattach.push(n=>{const r=n._zod.bag;r.format="ipv4"})}),HO=E("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=aO),oe.init(e,t),e._zod.onattach.push(n=>{const r=n._zod.bag;r.format="ipv6"}),e._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:e,continue:!t.abort})}}}),YO=E("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=cO),oe.init(e,t)}),XO=E("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=uO),oe.init(e,t),e._zod.check=n=>{const[r,i]=n.value.split("/");try{if(!i)throw new Error;const s=Number(i);if(`${s}`!==i)throw new Error;if(s<0||s>128)throw new Error;new URL(`http://[${r}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:e,continue:!t.abort})}}});function Ul(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const QO=E("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=lO),oe.init(e,t),e._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64"}),e._zod.check=n=>{Ul(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:e,continue:!t.abort})}});function eI(e){if(!Rl.test(e))return!1;const t=e.replace(/[-_]/g,r=>r==="-"?"+":"/"),n=t.padEnd(Math.ceil(t.length/4)*4,"=");return Ul(n)}const tI=E("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=Rl),oe.init(e,t),e._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64url"}),e._zod.check=n=>{eI(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:e,continue:!t.abort})}}),nI=E("$ZodE164",(e,t)=>{t.pattern??(t.pattern=dO),oe.init(e,t)});function rI(e,t=null){try{const n=e.split(".");if(n.length!==3)return!1;const[r]=n;if(!r)return!1;const i=JSON.parse(atob(r));return!("typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||t&&(!("alg"in i)||i.alg!==t))}catch{return!1}}const iI=E("$ZodJWT",(e,t)=>{oe.init(e,t),e._zod.check=n=>{rI(n.value,t.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:e,continue:!t.abort})}}),sI=E("$ZodBoolean",(e,t)=>{ne.init(e,t),e._zod.pattern=yO,e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=!!n.value}catch{}const i=n.value;return typeof i=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:e}),n}}),oI=E("$ZodAny",(e,t)=>{ne.init(e,t),e._zod.parse=n=>n}),aI=E("$ZodUnknown",(e,t)=>{ne.init(e,t),e._zod.parse=n=>n}),cI=E("$ZodNever",(e,t)=>{ne.init(e,t),e._zod.parse=(n,r)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:e}),n)}),uI=E("$ZodDate",(e,t)=>{ne.init(e,t),e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=new Date(n.value)}catch{}const i=n.value,s=i instanceof Date;return s&&!Number.isNaN(i.getTime())||n.issues.push({expected:"date",code:"invalid_type",input:i,...s?{received:"Invalid Date"}:{},inst:e}),n}});function xl(e,t,n){e.issues.length&&t.issues.push(...ra(n,e.issues)),t.value[n]=e.value}const lI=E("$ZodArray",(e,t)=>{ne.init(e,t),e._zod.parse=(n,r)=>{const i=n.value;if(!Array.isArray(i))return n.issues.push({expected:"array",code:"invalid_type",input:i,inst:e}),n;n.value=Array(i.length);const s=[];for(let a=0;a<i.length;a++){const c=i[a],u=t.element._zod.run({value:c,issues:[]},r);u instanceof Promise?s.push(u.then(l=>xl(l,n,a))):xl(u,n,a)}return s.length?Promise.all(s).then(()=>n):n}});function Xi(e,t,n){e.issues.length&&t.issues.push(...ra(n,e.issues)),t.value[n]=e.value}function Ml(e,t,n,r){e.issues.length?r[n]===void 0?n in r?t.value[n]=void 0:t.value[n]=e.value:t.issues.push(...ra(n,e.issues)):e.value===void 0?n in r&&(t.value[n]=void 0):t.value[n]=e.value}const fI=E("$ZodObject",(e,t)=>{ne.init(e,t);const n=Xo(()=>{const g=Object.keys(t.shape);for(const p of g)if(!(t.shape[p]instanceof ne))throw new Error(`Invalid element at key "${p}": expected a Zod schema`);const d=Uk(t.shape);return{shape:t.shape,keys:g,keySet:new Set(g),numKeys:g.length,optionalKeys:new Set(d)}});re(e._zod,"propValues",()=>{const g=t.shape,d={};for(const p in g){const y=g[p]._zod;if(y.values){d[p]??(d[p]=new Set);for(const w of y.values)d[p].add(w)}}return d});const r=g=>{const d=new RO(["shape","payload","ctx"]),p=n.value,y=N=>{const $=Fr(N);return`shape[${$}]._zod.run({ value: input[${$}], issues: [] }, ctx)`};d.write("const input = payload.value;");const w=Object.create(null);let b=0;for(const N of p.keys)w[N]=`key_${b++}`;d.write("const newResult = {}");for(const N of p.keys)if(p.optionalKeys.has(N)){const $=w[N];d.write(`const ${$} = ${y(N)};`);const I=Fr(N);d.write(`
        if (${$}.issues.length) {
          if (input[${I}] === undefined) {
            if (${I} in input) {
              newResult[${I}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${$}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${I}, ...iss.path] : [${I}],
              }))
            );
          }
        } else if (${$}.value === undefined) {
          if (${I} in input) newResult[${I}] = undefined;
        } else {
          newResult[${I}] = ${$}.value;
        }
        `)}else{const $=w[N];d.write(`const ${$} = ${y(N)};`),d.write(`
          if (${$}.issues.length) payload.issues = payload.issues.concat(${$}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${Fr(N)}, ...iss.path] : [${Fr(N)}]
          })));`),d.write(`newResult[${Fr(N)}] = ${$}.value`)}d.write("payload.value = newResult;"),d.write("return payload;");const P=d.compile();return(N,$)=>P(g,N,$)};let i;const s=Wi,a=!Yo.jitless,u=a&&_k.value,l=t.catchall;let m;e._zod.parse=(g,d)=>{m??(m=n.value);const p=g.value;if(!s(p))return g.issues.push({expected:"object",code:"invalid_type",input:p,inst:e}),g;const y=[];if(a&&u&&(d==null?void 0:d.async)===!1&&d.jitless!==!0)i||(i=r(t.shape)),g=i(g,d);else{g.value={};const $=m.shape;for(const I of m.keys){const _=$[I],L=_._zod.run({value:p[I],issues:[]},d),z=_._zod.optin==="optional"&&_._zod.optout==="optional";L instanceof Promise?y.push(L.then(J=>z?Ml(J,g,I,p):Xi(J,g,I))):z?Ml(L,g,I,p):Xi(L,g,I)}}if(!l)return y.length?Promise.all(y).then(()=>g):g;const w=[],b=m.keySet,P=l._zod,N=P.def.type;for(const $ of Object.keys(p)){if(b.has($))continue;if(N==="never"){w.push($);continue}const I=P.run({value:p[$],issues:[]},d);I instanceof Promise?y.push(I.then(_=>Xi(_,g,$))):Xi(I,g,$)}return w.length&&g.issues.push({code:"unrecognized_keys",keys:w,input:p,inst:e}),y.length?Promise.all(y).then(()=>g):g}});function Fl(e,t,n,r){for(const i of e)if(i.issues.length===0)return t.value=i.value,t;return t.issues.push({code:"invalid_union",input:t.value,inst:n,errors:e.map(i=>i.issues.map(s=>On(s,r,Sn())))}),t}const Dl=E("$ZodUnion",(e,t)=>{ne.init(e,t),re(e._zod,"optin",()=>t.options.some(n=>n._zod.optin==="optional")?"optional":void 0),re(e._zod,"optout",()=>t.options.some(n=>n._zod.optout==="optional")?"optional":void 0),re(e._zod,"values",()=>{if(t.options.every(n=>n._zod.values))return new Set(t.options.flatMap(n=>Array.from(n._zod.values)))}),re(e._zod,"pattern",()=>{if(t.options.every(n=>n._zod.pattern)){const n=t.options.map(r=>r._zod.pattern);return new RegExp(`^(${n.map(r=>ea(r.source)).join("|")})$`)}}),e._zod.parse=(n,r)=>{let i=!1;const s=[];for(const a of t.options){const c=a._zod.run({value:n.value,issues:[]},r);if(c instanceof Promise)s.push(c),i=!0;else{if(c.issues.length===0)return c;s.push(c)}}return i?Promise.all(s).then(a=>Fl(a,n,e,r)):Fl(s,n,e,r)}}),dI=E("$ZodDiscriminatedUnion",(e,t)=>{Dl.init(e,t);const n=e._zod.parse;re(e._zod,"propValues",()=>{const i={};for(const s of t.options){const a=s._zod.propValues;if(!a||Object.keys(a).length===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(s)}"`);for(const[c,u]of Object.entries(a)){i[c]||(i[c]=new Set);for(const l of u)i[c].add(l)}}return i});const r=Xo(()=>{const i=t.options,s=new Map;for(const a of i){const c=a._zod.propValues[t.discriminator];if(!c||c.size===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(a)}"`);for(const u of c){if(s.has(u))throw new Error(`Duplicate discriminator value "${String(u)}"`);s.set(u,a)}}return s});e._zod.parse=(i,s)=>{const a=i.value;if(!Wi(a))return i.issues.push({code:"invalid_type",expected:"object",input:a,inst:e}),i;const c=r.value.get(a==null?void 0:a[t.discriminator]);return c?c._zod.run(i,s):t.unionFallback?n(i,s):(i.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:a,path:[t.discriminator],inst:e}),i)}}),pI=E("$ZodIntersection",(e,t)=>{ne.init(e,t),e._zod.parse=(n,r)=>{const i=n.value,s=t.left._zod.run({value:i,issues:[]},r),a=t.right._zod.run({value:i,issues:[]},r);return s instanceof Promise||a instanceof Promise?Promise.all([s,a]).then(([u,l])=>Bl(n,u,l)):Bl(n,s,a)}});function oa(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(na(e)&&na(t)){const n=Object.keys(t),r=Object.keys(e).filter(s=>n.indexOf(s)!==-1),i={...e,...t};for(const s of r){const a=oa(e[s],t[s]);if(!a.valid)return{valid:!1,mergeErrorPath:[s,...a.mergeErrorPath]};i[s]=a.data}return{valid:!0,data:i}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let r=0;r<e.length;r++){const i=e[r],s=t[r],a=oa(i,s);if(!a.valid)return{valid:!1,mergeErrorPath:[r,...a.mergeErrorPath]};n.push(a.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function Bl(e,t,n){if(t.issues.length&&e.issues.push(...t.issues),n.issues.length&&e.issues.push(...n.issues),Dr(e))return e;const r=oa(t.value,n.value);if(!r.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(r.mergeErrorPath)}`);return e.value=r.data,e}const hI=E("$ZodEnum",(e,t)=>{ne.init(e,t);const n=Pk(t.entries);e._zod.values=new Set(n),e._zod.pattern=new RegExp(`^(${n.filter(r=>Ck.has(typeof r)).map(r=>typeof r=="string"?Wn(r):r.toString()).join("|")})$`),e._zod.parse=(r,i)=>{const s=r.value;return e._zod.values.has(s)||r.issues.push({code:"invalid_value",values:n,input:s,inst:e}),r}}),mI=E("$ZodLiteral",(e,t)=>{ne.init(e,t),e._zod.values=new Set(t.values),e._zod.pattern=new RegExp(`^(${t.values.map(n=>typeof n=="string"?Wn(n):n?n.toString():String(n)).join("|")})$`),e._zod.parse=(n,r)=>{const i=n.value;return e._zod.values.has(i)||n.issues.push({code:"invalid_value",values:t.values,input:i,inst:e}),n}}),gI=E("$ZodTransform",(e,t)=>{ne.init(e,t),e._zod.parse=(n,r)=>{const i=t.transform(n.value,n);if(r.async)return(i instanceof Promise?i:Promise.resolve(i)).then(a=>(n.value=a,n));if(i instanceof Promise)throw new Mr;return n.value=i,n}}),yI=E("$ZodOptional",(e,t)=>{ne.init(e,t),e._zod.optin="optional",e._zod.optout="optional",re(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),re(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${ea(n.source)})?$`):void 0}),e._zod.parse=(n,r)=>t.innerType._zod.optin==="optional"?t.innerType._zod.run(n,r):n.value===void 0?n:t.innerType._zod.run(n,r)}),wI=E("$ZodNullable",(e,t)=>{ne.init(e,t),re(e._zod,"optin",()=>t.innerType._zod.optin),re(e._zod,"optout",()=>t.innerType._zod.optout),re(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${ea(n.source)}|null)$`):void 0}),re(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(n,r)=>n.value===null?n:t.innerType._zod.run(n,r)}),bI=E("$ZodDefault",(e,t)=>{ne.init(e,t),e._zod.optin="optional",re(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>{if(n.value===void 0)return n.value=t.defaultValue,n;const i=t.innerType._zod.run(n,r);return i instanceof Promise?i.then(s=>zl(s,t)):zl(i,t)}});function zl(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const vI=E("$ZodPrefault",(e,t)=>{ne.init(e,t),e._zod.optin="optional",re(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>(n.value===void 0&&(n.value=t.defaultValue),t.innerType._zod.run(n,r))}),SI=E("$ZodNonOptional",(e,t)=>{ne.init(e,t),re(e._zod,"values",()=>{const n=t.innerType._zod.values;return n?new Set([...n].filter(r=>r!==void 0)):void 0}),e._zod.parse=(n,r)=>{const i=t.innerType._zod.run(n,r);return i instanceof Promise?i.then(s=>Vl(s,e)):Vl(i,e)}});function Vl(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const kI=E("$ZodCatch",(e,t)=>{ne.init(e,t),e._zod.optin="optional",re(e._zod,"optout",()=>t.innerType._zod.optout),re(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>{const i=t.innerType._zod.run(n,r);return i instanceof Promise?i.then(s=>(n.value=s.value,s.issues.length&&(n.value=t.catchValue({...n,error:{issues:s.issues.map(a=>On(a,r,Sn()))},input:n.value}),n.issues=[]),n)):(n.value=i.value,i.issues.length&&(n.value=t.catchValue({...n,error:{issues:i.issues.map(s=>On(s,r,Sn()))},input:n.value}),n.issues=[]),n)}}),OI=E("$ZodPipe",(e,t)=>{ne.init(e,t),re(e._zod,"values",()=>t.in._zod.values),re(e._zod,"optin",()=>t.in._zod.optin),re(e._zod,"optout",()=>t.out._zod.optout),e._zod.parse=(n,r)=>{const i=t.in._zod.run(n,r);return i instanceof Promise?i.then(s=>ql(s,t,r)):ql(i,t,r)}});function ql(e,t,n){return Dr(e)?e:t.out._zod.run({value:e.value,issues:e.issues},n)}const II=E("$ZodReadonly",(e,t)=>{ne.init(e,t),re(e._zod,"propValues",()=>t.innerType._zod.propValues),re(e._zod,"values",()=>t.innerType._zod.values),re(e._zod,"optin",()=>t.innerType._zod.optin),re(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(n,r)=>{const i=t.innerType._zod.run(n,r);return i instanceof Promise?i.then(Gl):Gl(i)}});function Gl(e){return e.value=Object.freeze(e.value),e}const $I=E("$ZodTemplateLiteral",(e,t)=>{ne.init(e,t);const n=[];for(const r of t.parts)if(r instanceof ne){if(!r._zod.pattern)throw new Error(`Invalid template literal part, no pattern found: ${[...r._zod.traits].shift()}`);const i=r._zod.pattern instanceof RegExp?r._zod.pattern.source:r._zod.pattern;if(!i)throw new Error(`Invalid template literal part: ${r._zod.traits}`);const s=i.startsWith("^")?1:0,a=i.endsWith("$")?i.length-1:i.length;n.push(i.slice(s,a))}else if(r===null||jk.has(typeof r))n.push(Wn(`${r}`));else throw new Error(`Invalid template literal part: ${r}`);e._zod.pattern=new RegExp(`^${n.join("")}$`),e._zod.parse=(r,i)=>typeof r.value!="string"?(r.issues.push({input:r.value,inst:e,expected:"template_literal",code:"invalid_type"}),r):(e._zod.pattern.lastIndex=0,e._zod.pattern.test(r.value)||r.issues.push({input:r.value,inst:e,code:"invalid_format",format:"template_literal",pattern:e._zod.pattern.source}),r)}),EI=E("$ZodCustom",(e,t)=>{ut.init(e,t),ne.init(e,t),e._zod.parse=(n,r)=>n,e._zod.check=n=>{const r=n.value,i=t.fn(r);if(i instanceof Promise)return i.then(s=>Zl(s,n,r,e));Zl(i,n,r,e)}});function Zl(e,t,n,r){if(!e){const i={code:"custom",input:n,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(i.params=r._zod.def.params),t.issues.push(Br(i))}}class TI{constructor(){this._map=new Map,this._idmap=new Map}add(t,...n){const r=n[0];if(this._map.set(t,r),r&&typeof r=="object"&&"id"in r){if(this._idmap.has(r.id))throw new Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,t)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(t){const n=this._map.get(t);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(t),this}get(t){const n=t._zod.parent;if(n){const r={...this.get(n)??{}};return delete r.id,{...r,...this._map.get(t)}}return this._map.get(t)}has(t){return this._map.has(t)}}function NI(){return new TI}const Qi=NI();function LI(e,t){return new e({type:"string",...j(t)})}function AI(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...j(t)})}function Jl(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...j(t)})}function PI(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...j(t)})}function RI(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...j(t)})}function _I(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...j(t)})}function CI(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...j(t)})}function jI(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...j(t)})}function UI(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...j(t)})}function xI(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...j(t)})}function MI(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...j(t)})}function FI(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...j(t)})}function DI(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...j(t)})}function BI(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...j(t)})}function zI(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...j(t)})}function VI(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...j(t)})}function qI(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...j(t)})}function GI(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...j(t)})}function ZI(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...j(t)})}function JI(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...j(t)})}function KI(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...j(t)})}function WI(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...j(t)})}function HI(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...j(t)})}function YI(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...j(t)})}function XI(e,t){return new e({type:"string",format:"date",check:"string_format",...j(t)})}function QI(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...j(t)})}function e0(e,t){return new e({type:"string",format:"duration",check:"string_format",...j(t)})}function t0(e,t){return new e({type:"boolean",...j(t)})}function n0(e){return new e({type:"any"})}function r0(e){return new e({type:"unknown"})}function i0(e,t){return new e({type:"never",...j(t)})}function s0(e,t){return new e({type:"date",...j(t)})}function o0(e,t){return new vO({check:"less_than",...j(t),value:e,inclusive:!0})}function a0(e,t){return new SO({check:"greater_than",...j(t),value:e,inclusive:!0})}function Kl(e,t){return new kO({check:"max_length",...j(t),maximum:e})}function es(e,t){return new OO({check:"min_length",...j(t),minimum:e})}function Wl(e,t){return new IO({check:"length_equals",...j(t),length:e})}function c0(e,t){return new $O({check:"string_format",format:"regex",...j(t),pattern:e})}function u0(e){return new EO({check:"string_format",format:"lowercase",...j(e)})}function l0(e){return new TO({check:"string_format",format:"uppercase",...j(e)})}function f0(e,t){return new NO({check:"string_format",format:"includes",...j(t),includes:e})}function d0(e,t){return new LO({check:"string_format",format:"starts_with",...j(t),prefix:e})}function p0(e,t){return new AO({check:"string_format",format:"ends_with",...j(t),suffix:e})}function zr(e){return new PO({check:"overwrite",tx:e})}function h0(e){return zr(t=>t.normalize(e))}function m0(){return zr(e=>e.trim())}function g0(){return zr(e=>e.toLowerCase())}function y0(){return zr(e=>e.toUpperCase())}function w0(e,t,n){return new e({type:"array",element:t,...j(n)})}function b0(e,t,n){return new e({type:"custom",check:"custom",fn:t,...j(n)})}const v0=E("ZodISODateTime",(e,t)=>{GO.init(e,t),le.init(e,t)});function S0(e){return YI(v0,e)}const k0=E("ZodISODate",(e,t)=>{ZO.init(e,t),le.init(e,t)});function O0(e){return XI(k0,e)}const I0=E("ZodISOTime",(e,t)=>{JO.init(e,t),le.init(e,t)});function $0(e){return QI(I0,e)}const E0=E("ZodISODuration",(e,t)=>{KO.init(e,t),le.init(e,t)});function T0(e){return e0(E0,e)}const ts=E("ZodError",(e,t)=>{Tl.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:n=>qk(e,n)},flatten:{value:n=>Vk(e,n)},addIssue:{value:n=>e.issues.push(n)},addIssues:{value:n=>e.issues.push(...n)},isEmpty:{get(){return e.issues.length===0}}})},{Parent:Error}),N0=Gk(ts),L0=Zk(ts),A0=Ll(ts),P0=Al(ts),ue=E("ZodType",(e,t)=>(ne.init(e,t),e.def=t,Object.defineProperty(e,"_def",{value:t}),e.check=(...n)=>e.clone({...t,checks:[...t.checks??[],...n.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:r)]}),e.clone=(n,r)=>kn(e,n,r),e.brand=()=>e,e.register=(n,r)=>(n.add(e,r),e),e.parse=(n,r)=>N0(e,n,r,{callee:e.parse}),e.safeParse=(n,r)=>A0(e,n,r),e.parseAsync=async(n,r)=>L0(e,n,r,{callee:e.parseAsync}),e.safeParseAsync=async(n,r)=>P0(e,n,r),e.spa=e.safeParseAsync,e.refine=(n,r)=>e.check(L$(n,r)),e.superRefine=n=>e.check(A$(n)),e.overwrite=n=>e.check(zr(n)),e.optional=()=>nf(e),e.nullable=()=>rf(e),e.nullish=()=>nf(rf(e)),e.nonoptional=n=>b$(e,n),e.array=()=>aa(e),e.or=n=>Mt([e,n]),e.and=n=>u$(e,n),e.transform=n=>of(e,p$(n)),e.default=n=>g$(e,n),e.prefault=n=>w$(e,n),e.catch=n=>S$(e,n),e.pipe=n=>of(e,n),e.readonly=()=>I$(e),e.describe=n=>{const r=e.clone();return Qi.add(r,{description:n}),r},Object.defineProperty(e,"description",{get(){var n;return(n=Qi.get(e))==null?void 0:n.description},configurable:!0}),e.meta=(...n)=>{if(n.length===0)return Qi.get(e);const r=e.clone();return Qi.add(r,n[0]),r},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),Hl=E("_ZodString",(e,t)=>{sa.init(e,t),ue.init(e,t);const n=e._zod.bag;e.format=n.format??null,e.minLength=n.minimum??null,e.maxLength=n.maximum??null,e.regex=(...r)=>e.check(c0(...r)),e.includes=(...r)=>e.check(f0(...r)),e.startsWith=(...r)=>e.check(d0(...r)),e.endsWith=(...r)=>e.check(p0(...r)),e.min=(...r)=>e.check(es(...r)),e.max=(...r)=>e.check(Kl(...r)),e.length=(...r)=>e.check(Wl(...r)),e.nonempty=(...r)=>e.check(es(1,...r)),e.lowercase=r=>e.check(u0(r)),e.uppercase=r=>e.check(l0(r)),e.trim=()=>e.check(m0()),e.normalize=(...r)=>e.check(h0(...r)),e.toLowerCase=()=>e.check(g0()),e.toUpperCase=()=>e.check(y0())}),R0=E("ZodString",(e,t)=>{sa.init(e,t),Hl.init(e,t),e.email=n=>e.check(AI(_0,n)),e.url=n=>e.check(jI(C0,n)),e.jwt=n=>e.check(HI(W0,n)),e.emoji=n=>e.check(UI(j0,n)),e.guid=n=>e.check(Jl(Yl,n)),e.uuid=n=>e.check(PI(ns,n)),e.uuidv4=n=>e.check(RI(ns,n)),e.uuidv6=n=>e.check(_I(ns,n)),e.uuidv7=n=>e.check(CI(ns,n)),e.nanoid=n=>e.check(xI(U0,n)),e.guid=n=>e.check(Jl(Yl,n)),e.cuid=n=>e.check(MI(x0,n)),e.cuid2=n=>e.check(FI(M0,n)),e.ulid=n=>e.check(DI(F0,n)),e.base64=n=>e.check(JI(Z0,n)),e.base64url=n=>e.check(KI(J0,n)),e.xid=n=>e.check(BI(D0,n)),e.ksuid=n=>e.check(zI(B0,n)),e.ipv4=n=>e.check(VI(z0,n)),e.ipv6=n=>e.check(qI(V0,n)),e.cidrv4=n=>e.check(GI(q0,n)),e.cidrv6=n=>e.check(ZI(G0,n)),e.e164=n=>e.check(WI(K0,n)),e.datetime=n=>e.check(S0(n)),e.date=n=>e.check(O0(n)),e.time=n=>e.check($0(n)),e.duration=n=>e.check(T0(n))});function Ze(e){return LI(R0,e)}const le=E("ZodStringFormat",(e,t)=>{oe.init(e,t),Hl.init(e,t)}),_0=E("ZodEmail",(e,t)=>{UO.init(e,t),le.init(e,t)}),Yl=E("ZodGUID",(e,t)=>{CO.init(e,t),le.init(e,t)}),ns=E("ZodUUID",(e,t)=>{jO.init(e,t),le.init(e,t)}),C0=E("ZodURL",(e,t)=>{xO.init(e,t),le.init(e,t)}),j0=E("ZodEmoji",(e,t)=>{MO.init(e,t),le.init(e,t)}),U0=E("ZodNanoID",(e,t)=>{FO.init(e,t),le.init(e,t)}),x0=E("ZodCUID",(e,t)=>{DO.init(e,t),le.init(e,t)}),M0=E("ZodCUID2",(e,t)=>{BO.init(e,t),le.init(e,t)}),F0=E("ZodULID",(e,t)=>{zO.init(e,t),le.init(e,t)}),D0=E("ZodXID",(e,t)=>{VO.init(e,t),le.init(e,t)}),B0=E("ZodKSUID",(e,t)=>{qO.init(e,t),le.init(e,t)}),z0=E("ZodIPv4",(e,t)=>{WO.init(e,t),le.init(e,t)}),V0=E("ZodIPv6",(e,t)=>{HO.init(e,t),le.init(e,t)}),q0=E("ZodCIDRv4",(e,t)=>{YO.init(e,t),le.init(e,t)}),G0=E("ZodCIDRv6",(e,t)=>{XO.init(e,t),le.init(e,t)}),Z0=E("ZodBase64",(e,t)=>{QO.init(e,t),le.init(e,t)}),J0=E("ZodBase64URL",(e,t)=>{tI.init(e,t),le.init(e,t)}),K0=E("ZodE164",(e,t)=>{nI.init(e,t),le.init(e,t)}),W0=E("ZodJWT",(e,t)=>{iI.init(e,t),le.init(e,t)}),H0=E("ZodBoolean",(e,t)=>{sI.init(e,t),ue.init(e,t)});function Xl(e){return t0(H0,e)}const Y0=E("ZodAny",(e,t)=>{oI.init(e,t),ue.init(e,t)});function X0(){return n0(Y0)}const Q0=E("ZodUnknown",(e,t)=>{aI.init(e,t),ue.init(e,t)});function Ql(){return r0(Q0)}const e$=E("ZodNever",(e,t)=>{cI.init(e,t),ue.init(e,t)});function t$(e){return i0(e$,e)}const n$=E("ZodDate",(e,t)=>{uI.init(e,t),ue.init(e,t),e.min=(r,i)=>e.check(a0(r,i)),e.max=(r,i)=>e.check(o0(r,i));const n=e._zod.bag;e.minDate=n.minimum?new Date(n.minimum):null,e.maxDate=n.maximum?new Date(n.maximum):null});function r$(e){return s0(n$,e)}const i$=E("ZodArray",(e,t)=>{lI.init(e,t),ue.init(e,t),e.element=t.element,e.min=(n,r)=>e.check(es(n,r)),e.nonempty=n=>e.check(es(1,n)),e.max=(n,r)=>e.check(Kl(n,r)),e.length=(n,r)=>e.check(Wl(n,r)),e.unwrap=()=>e.element});function aa(e,t){return w0(i$,e,t)}const s$=E("ZodObject",(e,t)=>{fI.init(e,t),ue.init(e,t),re(e,"shape",()=>t.shape),e.keyof=()=>l$(Object.keys(e._zod.def.shape)),e.catchall=n=>e.clone({...e._zod.def,catchall:n}),e.passthrough=()=>e.clone({...e._zod.def,catchall:Ql()}),e.loose=()=>e.clone({...e._zod.def,catchall:Ql()}),e.strict=()=>e.clone({...e._zod.def,catchall:t$()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=n=>Fk(e,n),e.merge=n=>Dk(e,n),e.pick=n=>xk(e,n),e.omit=n=>Mk(e,n),e.partial=(...n)=>Bk(tf,e,n[0]),e.required=(...n)=>zk(sf,e,n[0])});function de(e,t){const n={type:"object",get shape(){return ta(this,"shape",{...e}),this.shape},...j(t)};return new s$(n)}const ef=E("ZodUnion",(e,t)=>{Dl.init(e,t),ue.init(e,t),e.options=t.options});function Mt(e,t){return new ef({type:"union",options:e,...j(t)})}const o$=E("ZodDiscriminatedUnion",(e,t)=>{ef.init(e,t),dI.init(e,t)});function a$(e,t,n){return new o$({type:"union",options:t,discriminator:e,...j(n)})}const c$=E("ZodIntersection",(e,t)=>{pI.init(e,t),ue.init(e,t)});function u$(e,t){return new c$({type:"intersection",left:e,right:t})}const ca=E("ZodEnum",(e,t)=>{hI.init(e,t),ue.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const n=new Set(Object.keys(t.entries));e.extract=(r,i)=>{const s={};for(const a of r)if(n.has(a))s[a]=t.entries[a];else throw new Error(`Key ${a} not found in enum`);return new ca({...t,checks:[],...j(i),entries:s})},e.exclude=(r,i)=>{const s={...t.entries};for(const a of r)if(n.has(a))delete s[a];else throw new Error(`Key ${a} not found in enum`);return new ca({...t,checks:[],...j(i),entries:s})}});function l$(e,t){const n=Array.isArray(e)?Object.fromEntries(e.map(r=>[r,r])):e;return new ca({type:"enum",entries:n,...j(t)})}const f$=E("ZodLiteral",(e,t)=>{mI.init(e,t),ue.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function fe(e,t){return new f$({type:"literal",values:Array.isArray(e)?e:[e],...j(t)})}const d$=E("ZodTransform",(e,t)=>{gI.init(e,t),ue.init(e,t),e._zod.parse=(n,r)=>{n.addIssue=s=>{if(typeof s=="string")n.issues.push(Br(s,n.value,t));else{const a=s;a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=n.value),a.inst??(a.inst=e),a.continue??(a.continue=!0),n.issues.push(Br(a))}};const i=t.transform(n.value,n);return i instanceof Promise?i.then(s=>(n.value=s,n)):(n.value=i,n)}});function p$(e){return new d$({type:"transform",transform:e})}const tf=E("ZodOptional",(e,t)=>{yI.init(e,t),ue.init(e,t),e.unwrap=()=>e._zod.def.innerType});function nf(e){return new tf({type:"optional",innerType:e})}const h$=E("ZodNullable",(e,t)=>{wI.init(e,t),ue.init(e,t),e.unwrap=()=>e._zod.def.innerType});function rf(e){return new h$({type:"nullable",innerType:e})}const m$=E("ZodDefault",(e,t)=>{bI.init(e,t),ue.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function g$(e,t){return new m$({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():t}})}const y$=E("ZodPrefault",(e,t)=>{vI.init(e,t),ue.init(e,t),e.unwrap=()=>e._zod.def.innerType});function w$(e,t){return new y$({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():t}})}const sf=E("ZodNonOptional",(e,t)=>{SI.init(e,t),ue.init(e,t),e.unwrap=()=>e._zod.def.innerType});function b$(e,t){return new sf({type:"nonoptional",innerType:e,...j(t)})}const v$=E("ZodCatch",(e,t)=>{kI.init(e,t),ue.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function S$(e,t){return new v$({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const k$=E("ZodPipe",(e,t)=>{OI.init(e,t),ue.init(e,t),e.in=t.in,e.out=t.out});function of(e,t){return new k$({type:"pipe",in:e,out:t})}const O$=E("ZodReadonly",(e,t)=>{II.init(e,t),ue.init(e,t)});function I$(e){return new O$({type:"readonly",innerType:e})}const $$=E("ZodTemplateLiteral",(e,t)=>{$I.init(e,t),ue.init(e,t)});function E$(e,t){return new $$({type:"template_literal",parts:e,...j(t)})}const T$=E("ZodCustom",(e,t)=>{EI.init(e,t),ue.init(e,t)});function N$(e){const t=new ut({check:"custom"});return t._zod.check=e,t}function L$(e,t={}){return b0(T$,e,t)}function A$(e){const t=N$(n=>(n.addIssue=r=>{if(typeof r=="string")n.issues.push(Br(r,n.value,t._zod.def));else{const i=r;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=n.value),i.inst??(i.inst=t),i.continue??(i.continue=!t._zod.def.abort),n.issues.push(Br(i))}},e(n.value,n)));return t}var Hn=(e,t,n,r,i)=>({method:e,router:t,route:n,path:`${t}${n}`,request:r,response:i}),Yn=e=>({...e,fetch:async(n,r,i=globalThis.fetch)=>{let s=`${n}${e.path}`;const a={...r};if(r&&"pathParams"in r&&r.pathParams)for(const[c,u]of Object.entries(r.pathParams))s=s.replace(`:${c}`,String(u));if(r&&"queryParams"in r&&r.queryParams){s+="?";const c=new URLSearchParams;for(const[u,l]of Object.entries(r.queryParams))c.set(u,String(l));s+=c.toString()}return r&&"body"in a&&a.body&&typeof a.body=="object"&&(a.body=JSON.stringify(a.body)),await i(s,{...a})}}),af=Mt([fe("machine-learning-face-detection"),fe("machine-learning-object-detection")]),cf=Mt([fe("application/json"),fe("application/octet-stream"),fe("application/xml")]),uf=Yn(Hn("POST","/data-dump","/:proctoringSessionUuid/grant",{pathParams:de({proctoringSessionUuid:Ze()}),body:de({source:af,mimeType:cf})},{body:de({grantId:Ze(),uploadUrl:Ze()})})),P$=Yn(Hn("POST","/data-dump","/:proctoringSessionUuid/callback",{pathParams:de({proctoringSessionUuid:Ze()}),body:de({grantId:Ze()})},{})),lf=Yn(Hn("GET","/data-dump","/:proctoringSessionUuid/links",{pathParams:de({proctoringSessionUuid:Ze()})},{body:de({links:aa(de({source:af,mimeType:cf,downloadUrl:Ze()}))})})),ff=de({type:fe("machine-learning"),time:r$()}),df=Mt([fe("detected-no-face"),fe("detected-target-face"),fe("detected-unknown-face"),fe("detected-many-faces")]),R$=ff.extend({name:fe("face-detection"),details:de({previousState:df,currentState:df})}),_$=Mt([fe("cell-phone"),fe("laptop"),fe("book")]),pf=Mt([fe("detected-no-object"),E$(["detected-",_$],"-object"),fe("detected-many-objects")]),C$=ff.extend({name:fe("object-detection"),details:de({previousState:pf,currentState:pf})}),j$=Yn(Hn("POST","/quiz/event","/:proctoringSessionUuid",{pathParams:de({proctoringSessionUuid:Ze()}),body:Mt([R$,C$])},{})),U$=(e,t,n)=>({namespace:e,queryParams:t.queryParams,events:n}),ua=(e,t)=>de({key:fe(e),...t.shape}),x$=(...e)=>a$("key",e),M$=de({isLocked:Xl()});U$("/restricted-device",{queryParams:de({secret:Ze(),peerId:Ze()})},{message:x$(ua("pollRequest",de({})),ua("pollResponse",de({devices:aa(de({peerId:Ze(),connected:Xl(),data:X0()}))})),ua("stateUpdate",M$))});var F$=Mt([fe("source"),fe("sink")]),D$=Mt([fe("extension"),fe("mobile"),fe("lockdown")]),hf=Yn(Hn("POST","/restricted-device","/register",{body:de({role:F$,platform:D$,proctoringSessionUuid:Ze()})},{body:de({peerId:Ze()})})),mf=Yn(Hn("POST","/restricted-device","/:restrictedDevicePeerId/grant",{pathParams:de({restrictedDevicePeerId:Ze()})},{body:de({secret:Ze()})}));class B$ extends U{constructor(n){super(n,{});h(this,"logMachineLearningQuizEvent",Zn(async n=>(await j$.fetch(`${this.config.verityOrigin}/api/verity`,{method:"POST",headers:{"Content-Type":"application/json"},pathParams:n.pathParams,body:n.body},this.fetch.bind(this))).ok))}}const gf={idEvent:new v(o.Object({type:o.Literal("id"),name:o.Union([o.Literal("face id mismatch"),o.Literal("bypassed ai detection")]),time:o.Date(),details:o.Object({similarity:o.Optional(o.Number({minimum:0,maximum:1})),success:o.Optional(o.Boolean())})}))};class z$ extends U{constructor(n,r){super(n,gf);h(this,"emitter");h(this,"logIdEvent",async({proctoringSessionId:n,name:r,details:i})=>{try{const s={type:"id",name:r,time:new Date,details:r==="face id mismatch"?i:{success:!0}};if(this.emitter.emit("log",s),gf.idEvent.validate(s)&&(await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/event/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s),credentials:"include"})).ok)return!0}catch(s){if(s instanceof Error)throw new f(s)}throw new f});this.emitter=r}}const xe=new Yc;class V$ extends U{constructor(n){super(n,{});h(this,"TabLoggerClient");h(this,"HttpLoggerClient");h(this,"AccessCodeLoggerClient");h(this,"ClipboardLoggerClient");h(this,"ScreenshotLoggerClient");h(this,"SessionLoggerClient");h(this,"InterruptLoggerClient");h(this,"KeyboardLoggerClient");h(this,"LiveLoggerClient");h(this,"SystemLoggerClient");h(this,"FaceDetectionLoggerClient");h(this,"UserActionLoggerClient");h(this,"WorkerLoggerClient");h(this,"MediaLoggerClient");h(this,"MachineLearningLoggerClient");h(this,"IdLoggerClient");h(this,"on");h(this,"off");h(this,"once");this.TabLoggerClient=new Jo(n,xe),this.HttpLoggerClient=new GS(n,xe),this.AccessCodeLoggerClient=new Vo(n,xe),this.ClipboardLoggerClient=new qo(n,xe),this.ScreenshotLoggerClient=new Go(n,xe),this.SessionLoggerClient=new Zo(n,xe),this.InterruptLoggerClient=new Wo(n,xe),this.KeyboardLoggerClient=new Ko(n,xe),this.LiveLoggerClient=new fk(n,xe),this.SystemLoggerClient=new pk(n),this.FaceDetectionLoggerClient=new yk(n),this.UserActionLoggerClient=new Ho(n,xe),this.WorkerLoggerClient=new Lk(n),this.MediaLoggerClient=new Ak(n),this.MachineLearningLoggerClient=new B$(n),this.IdLoggerClient=new z$(n,xe),this.on=xe.on.bind(xe),this.once=xe.once.bind(xe),this.off=xe.off.bind(xe)}}function yf(e){const t=e.map(n=>o.Literal(n));return o.Union(t)}const q$=new v(o.Object({sessionId:o.String()})),G$=new v(o.Object({proctoringSessionId:o.String(),recordingType:o.Union([o.Literal("display"),o.Literal("webcam")]),recordingNumber:o.Number(),blobNumber:o.Number()})),wf=new v(o.Object({url:o.String()})),Z$=new v(o.Object({institute:o.Object({id:o.Number(),origin:o.String(),accessControlUuid:o.String()}),course:o.Object({id:o.Number(),courseId:o.String(),accessControlUuid:o.String()}),assessment:o.Object({id:o.Number(),quizId:o.String()})})),bf=yf(["unavailable","processing","available","error"]),J$=yf(["unflagged","flagged","incomplete","pending","error","unavailable"]),vf=o.Object({available:o.Array(o.Union([o.Number(),o.String(),o.Null()])),processing:o.Array(o.Union([o.Number(),o.String(),o.Null()]))}),K$=o.Object({username:A(o.String()),full_name:A(o.String()),given_name:A(o.String()),family_name:A(o.String()),email:A(o.String()),profile_picture:A(o.String())}),W$=new v(o.Array(o.Object({id:o.Number(),studentId:o.Number(),lmsQuizId:o.Number(),uuid:o.String(),screencaptureAvailability:bf,webcamAvailability:bf,screencaptureVideos:A(vf),webcamVideos:A(vf),idPhotoAvailable:o.Boolean(),personPhotoAvailable:o.Boolean(),userInfo:A(K$),startTime:A(o.String()),endTime:A(o.String()),status:A(J$),lmsQuizName:A(o.String()),createdAt:A(o.String()),realQuizId:A(o.String()),lmsUserId:A(o.String()),flagLevel:A(o.Number()),hasNotes:o.Boolean(),hasRoomScanNotes:o.Boolean(),isRoomScanDeleted:o.Boolean(),isWebcamAndScreenCaptureDeleted:o.Boolean()}))),H$=new v(o.Object({events:o.Array(o.Object({type:o.String(),name:o.String(),details:o.Record(o.String(),o.Any()),time:o.String(),proctoringSessionId:o.Number(),anomalyRef:A(o.Number())})),anomalies:o.Array(o.Object({type:o.String(),flagLevel:o.Number(),timeStart:A(o.String()),timeEnd:A(o.String()),id:o.Number(),resolveComment:A(o.String())}))})),Y$=new v(o.Array(o.Object({id:o.Number(),content:o.String(),timestamp:o.String()}))),X$=new v(o.Array(o.Object({id:o.Number(),content:o.String(),timestamp:o.Number()}))),Q$=new v(o.Number()),eE=new v(o.Object({requestId:o.String()})),tE=new v(o.Object({status:o.Union([o.Literal("POSTPROCESS_STARTED"),o.Literal("POSTPROCESS_COMPLETE"),o.Literal("POSTPROCESS_FAILED")])})),nE=new v(o.Object({id:o.Number(),uuid:o.String(),studentId:o.Number()})),Sf={startProctoring:q$,lmsContext:Z$,testResults:W$,proctoringEvent:H$,recordingBlobInfo:G$,uploadS3Url:wf,url:wf,sessionNotes:Y$,roomScanNotes:X$,count:Q$,concatenationRequestId:eE,concatenationRequest:tE,proctoringSession:nE},rE={proctoringSessionState:new v(o.Object({status:o.Union([o.String(),o.Undefined()])}))};class iE extends U{constructor(n){super(n,rE);h(this,"get",async n=>{try{const r=await super.fetch(new URL(`${this.config.verityOrigin}/api/verity/quiz/state/${n}`),{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.proctoringSessionState.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"set",async(n,r)=>{try{const i=await super.fetch(new URL(`${this.config.verityOrigin}/api/verity/quiz/state/${n}`),{headers:{"Content-Type":"application/json"},method:"POST",credentials:"include",body:JSON.stringify({status:r})});if(i.ok){const s=await i.json();if(this.schemaValidators.proctoringSessionState.validate(s))return s}}catch(i){if(i instanceof Error)throw new f(i)}throw new f})}}class sE extends U{constructor(n){super(n,Sf);h(this,"logger");h(this,"stateClient");h(this,"startProctoring",async(n,r,i)=>{try{const s=await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/event/${n.lms}/${n.hostname}/${n.courseId}/${n.quizId}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"session",name:"start proctoring",time:new Date,details:{success:!0,devicesInfo:r,capabilities:i}}),credentials:"include"});if(s.ok){const a=await s.json();if(this.schemaValidators.startProctoring.validate(a))return a.sessionId}throw new f(new Error(`Invalid Response: ${s.status} - ${s.statusText}`))}catch(s){if(s instanceof Error)throw new f(s)}throw new f});h(this,"upload",async(n,r)=>{const i=new URLSearchParams({segment:`${n.blobNumber}`,url:"upload"}),s=await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/recording/${n.proctoringSessionId}/${n.recordingType==="display"?"screencapture":n.recordingType}/${n.recordingNumber}?${i.toString()}`,{credentials:"include"});if(!s.ok)throw new f(new Error(`Upload to get S3 pre-signed URL: ${s.status} - ${s.statusText}`));const a=await s.json();if(Sf.uploadS3Url.validate(a)){const c=await super.fetch(a.url,{method:"PUT",body:r});if(!c.ok)throw new f(new Error(`Upload to S3 failed: ${c.status} - ${c.statusText}`))}});h(this,"uploadRoomScan",async(n,r)=>{const i=await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/recording/${n}/room_scan.webm`,{method:"PUT",body:r});if(!i.ok)throw new f(new Error(`Upload to S3 failed: ${i.status} - ${i.statusText}`))});h(this,"getRoomScanUrl",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/recording/${n}/room_scan/latest.webm`,{method:"GET"});if(!r.ok)throw new f(new Error(`Failed to retrieve room scan video: ${r.status} - ${r.statusText}`));return r.url}catch(r){throw console.error("Error fetching room scan video: ",r),r}});h(this,"getCachedRoomScanUrl",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/recording/${n}/room_scan/url`);if(r.ok){const i=await r.json();if(this.schemaValidators.url.validate(i)&&(await super.fetch(i.url,{method:"HEAD"})).ok)return i.url}}catch(r){if(console.error("Error fetching room scan video: ",r),r instanceof Error)throw new f(r)}});h(this,"getIdPhotoUrl",async(n,r)=>{const i="png";try{const s=await super.fetch(`${this.config.verityOrigin}/api/verity/photo/${n}-${r}.${i}`);if(s.ok){const a=await s.blob();return URL.createObjectURL(a)}}catch(s){if(console.error("Error fetching ID photo: ",s),s instanceof Error)throw new f(s)}});h(this,"getLmsContext",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/proctoring-session/${n}/lms-context`);if(r.ok){const i=await r.json();if(this.schemaValidators.lmsContext.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});this.logger=new V$(n),this.stateClient=new iE(n)}async isCorrectProctoringSessionId(n,r){try{const i=await this.getLmsContext(n);return r.quizId===i.assessment.quizId}catch(i){console.error(i)}return!1}async getSessionResultList(n,r){try{const i=await super.fetch(`${this.config.verityOrigin}/api/verity/test-results/${r}/${n}?session=all`,{credentials:"include"});if(i.ok){const s=await i.json();if(this.schemaValidators.testResults.validate(s))return s}}catch(i){if(i instanceof Error)throw new f(i)}throw new f}async getSessionList(n){try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/test-results/${n}?session=all`,{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.testResults.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f}async getSessionLoggedEvents({sessionId:n,courseId:r}){try{const i=await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/event/${r}/${n}`,{credentials:"include"});if(i.ok){const s=await i.json();if(this.schemaValidators.proctoringEvent.validate(s))return s}}catch(i){if(i instanceof Error)throw new f(i)}throw new f}async getVideoUrl({sessionId:n,recordingType:r,courseId:i}){try{const s=await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/recording/url/${i}/${n}/${r}`,{credentials:"include"});if(s.ok)return await s.json()}catch(s){if(s instanceof Error)throw new f(s)}throw new f}async requestVideoConcatenation(n){return Ee(super.fetch(`${this.config.verityOrigin}/api/verity/quiz/recording/${n}/concatenated-recording`,{method:"POST",credentials:"include"}),this.schemaValidators.concatenationRequestId)}async getConcatenationRequest(n,r){return Ee(super.fetch(`${this.config.verityOrigin}/api/verity/quiz/recording/${n}/concatenation-request/${r}`,{credentials:"include"}),this.schemaValidators.concatenationRequest)}async deleteRecordingsFromSession(n){try{if(!(await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/recording/${n}`,{method:"DELETE"})).ok)throw new f;return!0}catch(r){if(r instanceof Error)throw new f(r)}throw new f}async deleteRoomScanFromSession(n){try{if(!(await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/recording/${n}/room_scan.webm`,{method:"DELETE"})).ok)throw new f;return!0}catch(r){if(r instanceof Error)throw new f(r)}throw new f}async getSessionNotes({sessionId:n,courseId:r}){try{const i=await super.fetch(`${this.config.verityOrigin}/api/verity/session-notes/${r}/${n}`,{credentials:"include"});if(i.ok){const s=await i.json();if(this.schemaValidators.sessionNotes.validate(s))return s}}catch(i){if(i instanceof Error)throw new f(i)}throw new f}async addSessionNote({sessionId:n,courseId:r,content:i,timestamp:s}){try{return(await super.fetch(`${this.config.verityOrigin}/api/verity/session-notes/${r}/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({content:i,timestamp:s})})).ok}catch(a){if(a instanceof Error)throw new f(a)}throw new f}async editSessionNote({sessionId:n,courseId:r,noteId:i,content:s}){try{return(await super.fetch(`${this.config.verityOrigin}/api/verity/session-notes/${r}/${n}/${i}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({content:s})})).ok}catch(a){if(a instanceof Error)throw new f(a)}throw new f}async deleteSessionNote({sessionId:n,courseId:r,noteId:i}){try{return(await super.fetch(`${this.config.verityOrigin}/api/verity/session-notes/${r}/${n}/${i}`,{method:"DELETE",credentials:"include"})).ok}catch(s){if(s instanceof Error)throw new f(s)}throw new f}async getRoomScanNotes({sessionId:n,courseId:r}){try{const i=await super.fetch(`${this.config.verityOrigin}/api/verity/roomscan-notes/${r}/${n}`,{credentials:"include"});if(i.ok){const s=await i.json();if(this.schemaValidators.roomScanNotes.validate(s))return s}}catch(i){if(i instanceof Error)throw new f(i)}throw new f}async addRoomScanNote({sessionId:n,courseId:r,content:i,timestamp:s}){try{return(await super.fetch(`${this.config.verityOrigin}/api/verity/roomscan-notes/${r}/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({content:i,timestamp:s})})).ok}catch(a){if(a instanceof Error)throw new f(a)}throw new f}async editRoomScanNote({sessionId:n,courseId:r,noteId:i,content:s}){try{return(await super.fetch(`${this.config.verityOrigin}/api/verity/roomscan-notes/${r}/${n}/${i}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({content:s})})).ok}catch(a){if(a instanceof Error)throw new f(a)}throw new f}async deleteRoomScanNote({sessionId:n,courseId:r,noteId:i}){try{return(await super.fetch(`${this.config.verityOrigin}/api/verity/roomscan-notes/${r}/${n}/${i}`,{method:"DELETE",credentials:"include"})).ok}catch(s){if(s instanceof Error)throw new f(s)}throw new f}async getOwnResultsCount(n,r){return Ee(super.fetch(`${this.config.verityOrigin}/api/verity/test-results/${n}/${r}/count`,{credentials:"include"}),this.schemaValidators.count)}async get(n){return Ee(super.fetch(`${this.config.verityOrigin}/api/verity/proctoring-session/${n}`,{credentials:"include"}),this.schemaValidators.proctoringSession)}}function la(e){return o.Object({currentPage:o.Number(),totalElements:o.Number(),totalPages:o.Number(),results:o.Array(e)})}const oE=new v(o.Object({liveSessionId:o.String()})),fa=o.Object({id:o.Number(),name:o.String(),ownerInstituteId:o.String(),createdAt:o.String(),updatedAt:o.String()}),rs=o.Object({liveSessionId:o.String(),userId:o.String(),role:o.Union([o.Literal("proctor"),o.Literal("student")]),createdAt:o.String(),updatedAt:o.String()}),aE=new v(rs),cE=o.Object({id:o.String(),userId:o.String(),liveSessionId:o.String(),role:o.Union([o.Literal("proctor"),o.Literal("student")]),connectionState:o.Union([o.Literal("connecting"),o.Literal("connected"),o.Literal("reconnecting"),o.Literal("failed")])}),uE=new v(cE),is=o.Object({liveSessionId:o.String(),proctorGroupId:o.Number(),state:o.Object({selectedProctorId:A(o.String()),firstJoinedAt:A(o.String()),cancelledAt:A(o.String())}),createdAt:o.String(),updatedAt:o.String()}),lE=new v(o.Array(is)),fE=o.Object({id:o.String(),liveSessionId:o.String(),student:o.String(),edits:o.Array(o.Object({id:o.String(),editor:o.String(),content:o.String(),timestamp:o.Number()}))}),dE=new v(o.Array(fE)),da={id:o.String(),instituteId:A(o.String()),courseId:A(o.String()),assessmentId:A(o.String()),name:o.String(),startTime:o.String(),proctorGuide:A(o.String()),endTime:o.String(),capacity:o.Number(),registrationStartTime:A(o.String()),registrationEndTime:A(o.String()),createdAt:o.String(),updatedAt:o.String()},kf=o.Object({...da,users:o.Array(rs)}),pE=new v(o.Object(da)),hE=new v(kf),mE=new v(la(o.Object(da))),gE=new v(la(kf)),yE=new v(o.Array(o.Object({id:o.Number(),uuid:o.String(),name:o.String(),email:A(o.String())}))),wE=new v(la(o.Intersect([fa,o.Object({allowedInstitutes:o.Array(o.Object({instituteId:o.String(),minHoursNotice:o.Number(),trackCancellationHoursBefore:o.Number(),trackCancellationMessage:o.String(),autoCancelEmptyHoursBefore:A(o.Number())}))})]))),bE=new v(rs),vE=new v(rs),SE=new v(A(is)),kE=new v(is),OE=new v(is),IE=new v(o.Object({id:o.String(),userSessionIds:o.Array(o.String())})),$E=new v(fa),EE=new v(o.Array(fa)),TE={liveSession:oE,singleLiveSession:hE,liveSessionUser:aE,liveSessionUserSession:uE,liveSessionInvitation:OE,liveSessionList:mE,liveSessionListWithUsers:gE,liveSessionInvitations:lE,courseLiveProctorInfo:yE,instituteProctorGroups:wE,liveSessionNotes:dE,baseAssessmentLiveSession:pE,registerLiveSessionInstituteUser:bE,deregisterLiveSessionInstituteUser:vE,registerLiveSessionProctorGroup:SE,deregisterLiveSessionProctorGroup:kE,liveSessionLiveState:IE,liveProctorGroup:$E,liveProctorGroups:EE},Of={currentPage:0,totalElements:0,totalPages:1,results:[]};class NE extends U{constructor(n){super(n,TE);h(this,"getLiveSessionsWithUsers",({instituteUuid:n,courseUuid:r,assessmentUuid:i,sortBy:s,order:a,size:c,page:u=0})=>{const l=new URLSearchParams;return n&&l.set("instituteId",n),r&&l.set("courseId",r),i&&l.set("assessmentId",i),s&&l.set("sortBy",s),a&&l.set("order",a),c!=null&&l.set("size",String(c)),u!=null&&l.set("page",String(u)),l.set("includeUsers","true"),Ee(super.fetch(new URL(`/api/live/liveSession?${l}`,`${this.config.verityOrigin}`)),this.schemaValidators.liveSessionListWithUsers)});h(this,"getCourseLiveSessionInfo",async(n,r)=>{try{const i=await super.fetch(new URL(`/api/live/liveSession?instituteId=${n}&courseId=${r}`,`${this.config.verityOrigin}`));if(i.ok){const s=await i.json();if(this.schemaValidators.liveSessionList.validate(s))return s}}catch(i){if(i instanceof Error)throw new f(i)}return console.error("Failed to retrieve course live session info"),Of});h(this,"getLiveSession",async n=>{try{const r=await super.fetch(new URL(`/api/live/liveSession/${n}`,`${this.config.verityOrigin}`));if(r.ok){const i=await r.json();if(this.schemaValidators.singleLiveSession.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getLiveSessionLiveState",async n=>{try{const r=await super.fetch(new URL(`/api/live/liveSession/${n}/liveState`,`${this.config.verityOrigin}`));if(r.ok){const i=await r.json();if(this.schemaValidators.liveSessionLiveState.validate(i))return i}else return}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getLiveSessionUser",async(n,r)=>{try{const i=await super.fetch(new URL(`/api/live/liveSession/${n}/user/${r}`,`${this.config.verityOrigin}`));if(i.ok){const s=await i.json();if(this.schemaValidators.liveSessionUser.validate(s))return s}}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"getLiveSessionInvitations",async n=>{try{const r=await super.fetch(new URL(`/api/live/liveSession/${n}/invitation`,`${this.config.verityOrigin}`),{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.liveSessionInvitations.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getCourseLiveProctorInfo",async n=>{try{const r=await super.fetch(new URL(`/api/verity/user/instructor-roster/${n}`,`${this.config.verityOrigin}`),{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.courseLiveProctorInfo.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}return console.error("Failed to retrieve course live proctor info"),[]});h(this,"getLiveProctorGroup",async n=>Ee(super.fetch(new URL(`/api/live/proctorGroup/${n}`,`${this.config.verityOrigin}`),{credentials:"include"}),this.schemaValidators.liveProctorGroup));h(this,"getUserProctorGroups",async n=>Ee(super.fetch(new URL(`/api/live/user/${n}/proctorGroup`,`${this.config.verityOrigin}`),{credentials:"include"}),this.schemaValidators.liveProctorGroups));h(this,"getLiveInstituteProctorGroup",async n=>{try{const r=await super.fetch(new URL(`/api/live/proctorGroup?instituteId=${n}`,`${this.config.verityOrigin}`),{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.instituteProctorGroups.validate(i))return{...i,results:i.results.filter(({allowedInstitutes:s})=>s.some(({instituteId:a})=>a===n)).map(s=>{const{minHoursNotice:a,trackCancellationHoursBefore:c,trackCancellationMessage:u,autoCancelEmptyHoursBefore:l}=s.allowedInstitutes.find(({instituteId:m})=>m===n);return{...s,minHoursNotice:a,trackCancellationHoursBefore:c,trackCancellationMessage:u,autoCancelEmptyHoursBefore:l}})}}}catch(r){if(r instanceof Error)throw new f(r)}return console.error("Failed to retrieve institute proctor groups"),Of});h(this,"getAssessmentLiveSessionInfo",async({instituteUuid:n,courseUuid:r,assessmentUuid:i})=>{try{const a=await(await super.fetch(`${this.config.verityOrigin}/api/live/liveSession?instituteId=${n}&courseId=${r}&assessmentId=${i}&isPopIn=any`)).json();if(this.schemaValidators.liveSessionList.validate(a))return a}catch(s){if(s instanceof Error)throw new f(s)}throw new f});h(this,"getLiveSessionNotes",async n=>{try{const i=await(await super.fetch(`${this.config.verityOrigin}/api/live/liveSession/${n}/notes`)).json();if(this.schemaValidators.liveSessionNotes.validate(i))return i}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getUserCourseLiveSessions",async(n,r)=>{try{const i=await(await super.fetch(`${this.config.verityOrigin}/api/live/user/${n}/liveSession?courseId=${r}`)).json();if(this.schemaValidators.liveSessionList.validate(i))return i.results}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"getUserAssessmentLiveSessions",async n=>{var r;try{const i=await(await super.fetch(`${this.config.verityOrigin}/api/live/user/${(r=await this.getJwt())==null?void 0:r.uid}/liveSession?assessmentId=${n}&sortBy=endTime`)).json();if(this.schemaValidators.liveSessionList.validate(i))return i.results}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"doesLiveSessionExistForAssessment",async n=>(await this.getAssessmentLiveSessionInfo(n)).totalElements>0);h(this,"getInstituteLiveSessions",async n=>{try{const r=await(await super.fetch(`${this.config.verityOrigin}/api/live/liveSession?instituteId=${n}`)).json();if(this.schemaValidators.liveSessionList.validate(r))return r}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getCourseLiveSessions",async(n,r)=>{try{const i=await(await super.fetch(`${this.config.verityOrigin}/api/live/liveSession?instituteId=${n}&courseId=${r}`)).json();if(this.schemaValidators.liveSessionList.validate(i))return i}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"getStudentInstituteId",async()=>{try{const n=await(await super.fetch(`${this.config.verityOrigin}/api/verity/user/institute-id`)).json();if(typeof n=="number")return n}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"addLiveSession",async({instituteUuid:n,courseUuid:r,assessmentUuid:i},s)=>{try{const a=await super.fetch(new URL("/api/live/liveSession",`${this.config.verityOrigin}`),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...s,users:s.users??[],instituteId:n,courseId:r,assessmentId:i}),credentials:"include"});if(a.ok){const c=await a.json();if(this.schemaValidators.singleLiveSession.validate(c))return{success:a.ok,status:a.status,error:void 0,updatedSession:c}}else{const c=await a.text();return{success:a.ok,status:a.status,error:c.includes("html")?void 0:JSON.parse(c),updatedSession:void 0}}}catch(a){if(a instanceof Error)throw new f(a)}return{success:!1,error:void 0,updatedSession:void 0}});h(this,"deleteLiveSession",async({liveSessionId:n})=>{try{const r=await super.fetch(new URL(`/api/live/liveSession/${n}`,`${this.config.verityOrigin}`),{method:"DELETE",credentials:"include"});if(r.ok)return{success:r.ok,status:r.status,error:void 0};{const i=await r.text();return{success:r.ok,status:r.status,error:i.includes("html")?void 0:JSON.parse(i),updatedSession:void 0}}}catch(r){if(r instanceof Error)throw new f(r)}return{success:!1,error:void 0}});h(this,"modifyLiveSession",async({liveSessionId:n,payload:r})=>{try{const i=await super.fetch(new URL(`/api/live/liveSession/${n}`,`${this.config.verityOrigin}`),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r),credentials:"include"});if(i.ok){const s=await i.json();if(this.schemaValidators.singleLiveSession.validate(s))return{success:i.ok,status:i.status,error:void 0,updatedSession:s}}else{const s=await i.text();return{success:i.ok,status:i.status,error:s.includes("<!DOCTYPE html>")?void 0:JSON.parse(s),updatedSession:void 0}}}catch(i){if(i instanceof Error)throw new f(i)}return{success:!1,error:void 0,updatedSession:void 0}});h(this,"saveLiveSessionInstituteUser",async({liveSessionId:n,action:r,role:i,userId:s})=>{try{let a;if(r==="register"?a=await super.fetch(new URL(`/api/live/liveSession/${n}/user`,`${this.config.verityOrigin}`),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:s,role:i}),credentials:"include"}):a=await super.fetch(new URL(`/api/live/liveSession/${n}/user/${s}`,`${this.config.verityOrigin}`),{method:"DELETE",credentials:"include"}),a.ok){if(r==="register"){const c=await a.json();if(this.schemaValidators.registerLiveSessionInstituteUser.validate(c))return{success:a.ok,error:void 0,updatedSession:c}}else if(r==="deregister")return{success:a.ok,error:void 0,updatedSession:void 0}}else{const c=await a.text();return{success:a.ok,error:c.includes("<!DOCTYPE html>")?void 0:JSON.parse(c),updatedSession:void 0}}}catch(a){if(a instanceof Error)throw new f(a)}return{success:!1,error:void 0,updatedSession:void 0}});h(this,"addLiveSessionUser",({liveSessionId:n,role:r,userId:i})=>Ee(super.fetch(new URL(`/api/live/liveSession/${n}/user`,`${this.config.verityOrigin}`),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:i,role:r}),credentials:"include"}),this.schemaValidators.registerLiveSessionInstituteUser));h(this,"removeLiveSessionUser",async(n,r)=>{await tt(super.fetch(new URL(`/api/live/liveSession/${n}/user/${r}`,`${this.config.verityOrigin}`),{method:"DELETE",credentials:"include"}))});h(this,"registerSelfAsProctor",async n=>{var i;const r=(i=await this.getJwt())==null?void 0:i.uid;if(!r)throw new Gn;try{await this.addLiveSessionUser({liveSessionId:n,userId:r,role:"proctor"})}catch(s){if(!(s instanceof cl)||s.code!=="userExists")throw s}});h(this,"saveLiveSessionProctorGroup",async({liveSessionId:n,action:r,proctorGroupId:i})=>{try{let s;if(r==="registerGroup"?s=await super.fetch(new URL(`/api/live/liveSession/${n}/invitation/${i}`,`${this.config.verityOrigin}`),{method:"POST",credentials:"include"}):s=await super.fetch(new URL(`/api/live/liveSession/${n}/invitation/${i}`,`${this.config.verityOrigin}`),{method:"DELETE",credentials:"include"}),s.ok){if(r==="registerGroup"){const a=await s.json();if(this.schemaValidators.registerLiveSessionProctorGroup.validate(a))return{success:s.ok,error:void 0,updatedSession:a}}else if(r==="deregisterGroup")return{success:s.ok,error:void 0}}else{const a=await s.text();return{success:s.ok,error:a.includes("<!DOCTYPE html>")?void 0:JSON.parse(a),updatedSession:void 0}}}catch(s){if(s instanceof Error)throw new f(s)}return{success:!1,error:void 0,updatedSession:void 0}});h(this,"createProctorGroupInvitation",(n,r)=>Ee(super.fetch(new URL(`/api/live/liveSession/${n}/invitation/${r}`,`${this.config.verityOrigin}`),{method:"POST",credentials:"include"}),this.schemaValidators.liveSessionInvitation));h(this,"deleteProctorGroupInvitation",async(n,r)=>{await tt(super.fetch(new URL(`/api/live/liveSession/${n}/invitation/${r}`,`${this.config.verityOrigin}`),{method:"DELETE",credentials:"include"}))});h(this,"markLiveSessionViewed",async n=>{try{if((await super.fetch(new URL(`/api/live/liveSession/${n}/view`,`${this.config.verityOrigin}`),{method:"POST",credentials:"include"})).ok)return!0}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"endLiveSession",async n=>{try{if((await super.fetch(new URL(`/api/live/liveSession/${n}/end`,`${this.config.verityOrigin}`),{method:"POST",credentials:"include"})).ok)return!0}catch(r){if(r instanceof Error)throw new f(r)}throw new f})}}const LE=new v(o.Object({platform:o.Union([o.Literal("none"),o.Literal("lockdown"),o.Literal("extension"),o.Literal("mobile")]),version:A(o.String()),versionSupported:o.Boolean()})),AE=new v(o.Object({versionSupported:o.Boolean()})),PE={platformInfo:LE,versionSupported:AE};class RE extends U{constructor(n){super(n,PE);h(this,"current",async()=>{try{const n=await super.fetch(`${this.config.verityOrigin}/api/verity/platform-info`);if(n.ok){const r=await n.json();if(this.schemaValidators.platformInfo.validate(r))return r}}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"isVersionSupported",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/platform-info/version/${n}`);if(r.ok){const i=await r.json();if(this.schemaValidators.versionSupported.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f})}}const _E=new v(o.Object({verified:o.Boolean()})),CE=new v(o.Array(o.Union([o.Literal("InstituteEdit"),o.Literal("CourseEdit"),o.Literal("VeritySettingsEdit"),o.Literal("CourseView"),o.Literal("LiveProctoringPrivilege"),o.Literal("LiveProctoring")]))),jE=new v(o.Object({assessment:o.Array(o.Union([o.Literal("create"),o.Literal("update"),o.Literal("read")]))})),UE=new v(o.Record(o.String(),o.Array(o.Object({courseId:A(o.String()),instituteId:A(o.String()),resourceId:A(o.Unknown())})))),xE={verityResultPermission:_E,portalPermission:CE,assessmentPermissions:jE,scopedPrivileges:UE};class ME extends U{constructor(n){super(n,xE);h(this,"doesUserHaveTestResultPermission",async n=>{try{const r=await super.fetch(new URL(`/api/verity/test-results/${n.lms}/${n.courseId??""}/${n.quizId}?verify=permissions`,`${this.config.verityOrigin}`),{credentials:"include"});if(r.status===403)return!1;const i=await r.json();return this.schemaValidators.verityResultPermission.validate(i)?i.verified:!1}catch(r){if(r instanceof Error)throw new f(r);return!1}});h(this,"portalPermissions",async n=>{try{const r=await super.fetch(new URL(`/api/verity/portal/permissions?lmsCourseId=${n}`,`${this.config.verityOrigin}`),{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.portalPermission.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}return[]});h(this,"fromHostname",async n=>{try{const r=await super.fetch(new URL(`/api/verity/permissions/hostname/${n.hostname}`,`${this.config.verityOrigin}`));if(r.ok){const i=await r.json();if(this.schemaValidators.assessmentPermissions.validate(i))return i}else if(r.status===401)throw new Gn}catch(r){if(r instanceof Error)throw new f(r)}return{assessment:[]}});h(this,"doesUserHaveInstituteProfilePermissions",async()=>{try{const n=await super.fetch(new URL("/api/verity/permissions/institute-profiles",`${this.config.verityOrigin}`));if(n.ok)return!0;if(n.status===401)throw new Gn;return!1}catch(n){if(n instanceof Error)throw new f(n)}return!1});h(this,"getUserPrivileges",()=>Ee(super.fetch(new URL("/api/access-control/user/self/privilege",`${this.config.verityOrigin}`)),this.schemaValidators.scopedPrivileges))}}const pa=new v(o.Union([o.Literal("canvas"),o.Literal("moodle"),o.Literal("BlackboardLearn"),o.Literal("desire2learn")])),FE=new v(o.Object({lms:pa.schema,hostname:o.String(),courseId:o.Optional(o.String()),quizId:o.String(),quizInfo:o.Optional(o.Record(o.String(),o.Any())),quizOther:o.Optional(o.Record(o.String(),o.Any()))})),DE=new v(o.Object({id:o.Number(),courseId:o.Number(),quizId:o.String(),quizInfo:o.Optional(o.Record(o.String(),o.Any())),other:o.Optional(o.Record(o.String(),o.Any())),isDeleted:o.Boolean(),createdAt:o.String(),updatedAt:o.String()})),BE=new v(o.Object({lms:pa.schema,hostname:o.String(),lmsProvidedCourseId:o.Optional(o.String()),lmsProvidedAssessmentId:o.String()})),zE=new v(o.String()),VE=new v(o.Object({id:o.Number(),instituteName:o.Union([o.Null(),o.String()]),origin:o.Optional(o.Union([o.Null(),o.String()])),lmsApiClientId:o.Optional(o.Union([o.Null(),o.String()]))})),qE=new v(o.Object({exists:o.Boolean()})),GE=new v(o.Array(o.Object({key:o.String(),relativePath:o.String(),requestType:o.String(),status:o.String()}))),ZE=new v(o.Object({success:o.Boolean(),lmsResponse:o.Optional(o.Unknown())})),JE={lms:pa,assessmentInfo:FE,url:zE,instituteLmsInfo:VE,tokenExists:qE,tokenTestResults:GE,deleteResponse:ZE,assessmentInfoAlternate:BE,deleteAssessmentInfo:DE};class KE extends U{constructor(n){super(n,JE);h(this,"getAssessmentUrl",async(n,r,i)=>Ee(super.fetch(`${this.config.verityOrigin}/api/verity/lms-course/${n}/assessment/${r}/link?type=${i}`,{credentials:"include"}),this.schemaValidators.url));h(this,"getCourseUrl",async(n,r)=>Ee(super.fetch(`${this.config.verityOrigin}/api/verity/lms-course/${n}/link?type=${r}`,{credentials:"include"}),this.schemaValidators.url));h(this,"getInstituteLmsInfo",async()=>{try{const n=await super.fetch(`${this.config.verityOrigin}/api/verity/lms`,{credentials:"include"});if(n.ok){const r=await n.json();if(this.schemaValidators.instituteLmsInfo.validate(r))return r}}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"createMoodleToken",async n=>{try{if((await super.fetch(`${this.config.verityOrigin}/api/verity/lms/moodle-token`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({accessToken:n})})).ok)return!0}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getTokenExists",async()=>{try{const n=await super.fetch(`${this.config.verityOrigin}/api/verity/lms/token`,{credentials:"include"});if(n.ok){const r=await n.json();if(this.schemaValidators.tokenExists.validate(r))return r.exists}}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"deleteToken",async()=>{try{if((await super.fetch(`${this.config.verityOrigin}/api/verity/lms/token`,{method:"DELETE",credentials:"include"})).ok)return!0}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"getLTIRef",async n=>{try{const r=await super.fetch(new URL(`/api/verity/ltiRef/${n}`,`${this.config.verityOrigin}`),{credentials:"include"});if(r.ok){const i=await r.text();if(typeof i=="string")return i}}catch(r){if(r instanceof Error)throw new f(r)}});h(this,"getLTIRefByHostname",async n=>{try{const r=await super.fetch(new URL(`/api/verity/ltiRef/hostname/${n}`,`${this.config.verityOrigin}`),{credentials:"include"});if(r.ok){const i=await r.text();if(typeof i=="string")return i}}catch(r){if(r instanceof Error)throw new f(r)}});h(this,"getSessionToken",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/lms/session-token?lmsCourseId=${n}`,{credentials:"include"});if(r.ok)return(await r.json()).sessionToken}catch(r){console.error(r)}});h(this,"testToken",async({lms:n,category:r,lmsProvidedCourseId:i,accessToken:s})=>{try{const a=await super.fetch(`${this.config.verityOrigin}/api/verity/scope/${r}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lms:n,lmsProvidedCourseId:i,accessToken:s}),credentials:"include"});if(a.ok){const c=await a.json();if(this.schemaValidators.tokenTestResults.validate(c))return c}}catch(a){if(a instanceof Error)throw new f(a)}throw new f});h(this,"createAssessment",async(n,r)=>{try{const i=await super.fetch(`${this.config.verityOrigin}/api/verity/lms/${n}/lms-course/${r}/lms-assessment`,{method:"POST",credentials:"include"});if(i.ok)return await i.json()}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"updateAssessment",async(n,r,i,s)=>{try{return(await super.fetch(`${this.config.verityOrigin}/api/verity/lms-course/${r}/lms-assessment/${i}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({lms:n,accessCode:s}),credentials:"include"})).ok}catch(a){if(a instanceof Error)throw new f(a)}throw new f});h(this,"addQuestionToAssessment",async(n,r,i,s,a)=>{try{return(await super.fetch(`${this.config.verityOrigin}/api/verity/lms-course/${r}/lms-assessment/${i}/question`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lms:n,origin:s,question:a}),credentials:"include"})).ok}catch(c){if(c instanceof Error)throw new f(c)}throw new f});h(this,"deleteAssessment",async(n,r)=>{try{const i=new URL(`${this.config.verityOrigin}/api/verity/assessment/${n}`);r&&i.searchParams.set("deleteFromLms","true");const s=await super.fetch(i,{method:"DELETE",credentials:"include"});if(s.ok){const a=await s.json();if(this.schemaValidators.deleteResponse.validate(a))return a}}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"getAllAssessmentInfoById",async n=>{try{const r=await super.fetch(new URL(`/api/verity/assessment/${n}`,`${this.config.verityOrigin}`),{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.deleteAssessmentInfo.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getAssessmentInfoById",async n=>{try{const r=await super.fetch(new URL(`/api/verity/assessment/${n}/info`,`${this.config.verityOrigin}`),{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.assessmentInfoAlternate.validate(i))return{...i,courseId:i.lmsProvidedCourseId,quizId:i.lmsProvidedAssessmentId}}}catch(r){if(r instanceof Error)throw new f(r)}throw new f})}}const WE=new v(o.Object({path:o.String(),files:o.Array(o.Object({url:o.String()}))})),HE=new v(o.Object({ready:o.Boolean(),emailDestination:o.String()})),YE={lockdownDownloadPath:WE,requestProctoringSessionDownloadResponse:HE},ha=Symbol.for("yaml.alias"),ma=Symbol.for("yaml.document"),en=Symbol.for("yaml.map"),If=Symbol.for("yaml.pair"),Ft=Symbol.for("yaml.scalar"),Xn=Symbol.for("yaml.seq"),lt=Symbol.for("yaml.node.type"),Qn=e=>!!e&&typeof e=="object"&&e[lt]===ha,ss=e=>!!e&&typeof e=="object"&&e[lt]===ma,Vr=e=>!!e&&typeof e=="object"&&e[lt]===en,we=e=>!!e&&typeof e=="object"&&e[lt]===If,ie=e=>!!e&&typeof e=="object"&&e[lt]===Ft,qr=e=>!!e&&typeof e=="object"&&e[lt]===Xn;function be(e){if(e&&typeof e=="object")switch(e[lt]){case en:case Xn:return!0}return!1}function Te(e){if(e&&typeof e=="object")switch(e[lt]){case ha:case en:case Ft:case Xn:return!0}return!1}const XE=e=>(ie(e)||be(e))&&!!e.anchor,In=Symbol("break visit"),QE=Symbol("skip children"),Gr=Symbol("remove node");function $n(e,t){const n=eT(t);ss(e)?er(null,e.contents,n,Object.freeze([e]))===Gr&&(e.contents=null):er(null,e,n,Object.freeze([]))}$n.BREAK=In,$n.SKIP=QE,$n.REMOVE=Gr;function er(e,t,n,r){const i=tT(e,t,n,r);if(Te(i)||we(i))return nT(e,r,i),er(e,i,n,r);if(typeof i!="symbol"){if(be(t)){r=Object.freeze(r.concat(t));for(let s=0;s<t.items.length;++s){const a=er(s,t.items[s],n,r);if(typeof a=="number")s=a-1;else{if(a===In)return In;a===Gr&&(t.items.splice(s,1),s-=1)}}}else if(we(t)){r=Object.freeze(r.concat(t));const s=er("key",t.key,n,r);if(s===In)return In;s===Gr&&(t.key=null);const a=er("value",t.value,n,r);if(a===In)return In;a===Gr&&(t.value=null)}}return i}function eT(e){return typeof e=="object"&&(e.Collection||e.Node||e.Value)?Object.assign({Alias:e.Node,Map:e.Node,Scalar:e.Node,Seq:e.Node},e.Value&&{Map:e.Value,Scalar:e.Value,Seq:e.Value},e.Collection&&{Map:e.Collection,Seq:e.Collection},e):e}function tT(e,t,n,r){var i,s,a,c,u;if(typeof n=="function")return n(e,t,r);if(Vr(t))return(i=n.Map)==null?void 0:i.call(n,e,t,r);if(qr(t))return(s=n.Seq)==null?void 0:s.call(n,e,t,r);if(we(t))return(a=n.Pair)==null?void 0:a.call(n,e,t,r);if(ie(t))return(c=n.Scalar)==null?void 0:c.call(n,e,t,r);if(Qn(t))return(u=n.Alias)==null?void 0:u.call(n,e,t,r)}function nT(e,t,n){const r=t[t.length-1];if(be(r))r.items[e]=n;else if(we(r))e==="key"?r.key=n:r.value=n;else if(ss(r))r.contents=n;else{const i=Qn(r)?"alias":"scalar";throw new Error(`Cannot replace node with ${i} parent`)}}const rT={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},iT=e=>e.replace(/[!,[\]{}]/g,t=>rT[t]);class Je{constructor(t,n){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},Je.defaultYaml,t),this.tags=Object.assign({},Je.defaultTags,n)}clone(){const t=new Je(this.yaml,this.tags);return t.docStart=this.docStart,t}atDocument(){const t=new Je(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:Je.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},Je.defaultTags);break}return t}add(t,n){this.atNextDocument&&(this.yaml={explicit:Je.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},Je.defaultTags),this.atNextDocument=!1);const r=t.trim().split(/[ \t]+/),i=r.shift();switch(i){case"%TAG":{if(r.length!==2&&(n(0,"%TAG directive should contain exactly two parts"),r.length<2))return!1;const[s,a]=r;return this.tags[s]=a,!0}case"%YAML":{if(this.yaml.explicit=!0,r.length!==1)return n(0,"%YAML directive should contain exactly one part"),!1;const[s]=r;if(s==="1.1"||s==="1.2")return this.yaml.version=s,!0;{const a=/^\d+\.\d+$/.test(s);return n(6,`Unsupported YAML version ${s}`,a),!1}}default:return n(0,`Unknown directive ${i}`,!0),!1}}tagName(t,n){if(t==="!")return"!";if(t[0]!=="!")return n(`Not a valid tag: ${t}`),null;if(t[1]==="<"){const a=t.slice(2,-1);return a==="!"||a==="!!"?(n(`Verbatim tags aren't resolved, so ${t} is invalid.`),null):(t[t.length-1]!==">"&&n("Verbatim tags must end with a >"),a)}const[,r,i]=t.match(/^(.*!)([^!]*)$/);i||n(`The ${t} tag has no suffix`);const s=this.tags[r];return s?s+decodeURIComponent(i):r==="!"?t:(n(`Could not resolve tag: ${t}`),null)}tagString(t){for(const[n,r]of Object.entries(this.tags))if(t.startsWith(r))return n+iT(t.substring(r.length));return t[0]==="!"?t:`!<${t}>`}toString(t){const n=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],r=Object.entries(this.tags);let i;if(t&&r.length>0&&Te(t.contents)){const s={};$n(t.contents,(a,c)=>{Te(c)&&c.tag&&(s[c.tag]=!0)}),i=Object.keys(s)}else i=[];for(const[s,a]of r)s==="!!"&&a==="tag:yaml.org,2002:"||(!t||i.some(c=>c.startsWith(a)))&&n.push(`%TAG ${s} ${a}`);return n.join(`
`)}}Je.defaultYaml={explicit:!1,version:"1.2"},Je.defaultTags={"!!":"tag:yaml.org,2002:"};function $f(e){if(/[\x00-\x19\s,[\]{}]/.test(e)){const n=`Anchor must not contain whitespace or control characters: ${JSON.stringify(e)}`;throw new Error(n)}return!0}function Ef(e){const t=new Set;return $n(e,{Value(n,r){r.anchor&&t.add(r.anchor)}}),t}function Tf(e,t){for(let n=1;;++n){const r=`${e}${n}`;if(!t.has(r))return r}}function sT(e,t){const n=[],r=new Map;let i=null;return{onAnchor:s=>{n.push(s),i||(i=Ef(e));const a=Tf(t,i);return i.add(a),a},setAnchors:()=>{for(const s of n){const a=r.get(s);if(typeof a=="object"&&a.anchor&&(ie(a.node)||be(a.node)))a.node.anchor=a.anchor;else{const c=new Error("Failed to resolve repeated object (this should not happen)");throw c.source=s,c}}},sourceObjects:r}}function tr(e,t,n,r){if(r&&typeof r=="object")if(Array.isArray(r))for(let i=0,s=r.length;i<s;++i){const a=r[i],c=tr(e,r,String(i),a);c===void 0?delete r[i]:c!==a&&(r[i]=c)}else if(r instanceof Map)for(const i of Array.from(r.keys())){const s=r.get(i),a=tr(e,r,i,s);a===void 0?r.delete(i):a!==s&&r.set(i,a)}else if(r instanceof Set)for(const i of Array.from(r)){const s=tr(e,r,i,i);s===void 0?r.delete(i):s!==i&&(r.delete(i),r.add(s))}else for(const[i,s]of Object.entries(r)){const a=tr(e,r,i,s);a===void 0?delete r[i]:a!==s&&(r[i]=a)}return e.call(t,n,r)}function ft(e,t,n){if(Array.isArray(e))return e.map((r,i)=>ft(r,String(i),n));if(e&&typeof e.toJSON=="function"){if(!n||!XE(e))return e.toJSON(t,n);const r={aliasCount:0,count:1,res:void 0};n.anchors.set(e,r),n.onCreate=s=>{r.res=s,delete n.onCreate};const i=e.toJSON(t,n);return n.onCreate&&n.onCreate(i),i}return typeof e=="bigint"&&!(n!=null&&n.keep)?Number(e):e}class ga{constructor(t){Object.defineProperty(this,lt,{value:t})}clone(){const t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(t.range=this.range.slice()),t}toJS(t,{mapAsMap:n,maxAliasCount:r,onAnchor:i,reviver:s}={}){if(!ss(t))throw new TypeError("A document argument is required");const a={anchors:new Map,doc:t,keep:!0,mapAsMap:n===!0,mapKeyWarned:!1,maxAliasCount:typeof r=="number"?r:100},c=ft(this,"",a);if(typeof i=="function")for(const{count:u,res:l}of a.anchors.values())i(l,u);return typeof s=="function"?tr(s,{"":c},"",c):c}}class ya extends ga{constructor(t){super(ha),this.source=t,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(t){let n;return $n(t,{Node:(r,i)=>{if(i===this)return $n.BREAK;i.anchor===this.source&&(n=i)}}),n}toJSON(t,n){if(!n)return{source:this.source};const{anchors:r,doc:i,maxAliasCount:s}=n,a=this.resolve(i);if(!a){const u=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(u)}let c=r.get(a);if(c||(ft(a,null,n),c=r.get(a)),!c||c.res===void 0){const u="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(u)}if(s>=0&&(c.count+=1,c.aliasCount===0&&(c.aliasCount=os(i,a,r)),c.count*c.aliasCount>s)){const u="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(u)}return c.res}toString(t,n,r){const i=`*${this.source}`;if(t){if($f(this.source),t.options.verifyAliasOrder&&!t.anchors.has(this.source)){const s=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(s)}if(t.implicitKey)return`${i} `}return i}}function os(e,t,n){if(Qn(t)){const r=t.resolve(e),i=n&&r&&n.get(r);return i?i.count*i.aliasCount:0}else if(be(t)){let r=0;for(const i of t.items){const s=os(e,i,n);s>r&&(r=s)}return r}else if(we(t)){const r=os(e,t.key,n),i=os(e,t.value,n);return Math.max(r,i)}return 1}const Nf=e=>!e||typeof e!="function"&&typeof e!="object";class F extends ga{constructor(t){super(Ft),this.value=t}toJSON(t,n){return n!=null&&n.keep?this.value:ft(this.value,t,n)}toString(){return String(this.value)}}F.BLOCK_FOLDED="BLOCK_FOLDED",F.BLOCK_LITERAL="BLOCK_LITERAL",F.PLAIN="PLAIN",F.QUOTE_DOUBLE="QUOTE_DOUBLE",F.QUOTE_SINGLE="QUOTE_SINGLE";const oT="tag:yaml.org,2002:";function aT(e,t,n){if(t){const r=n.filter(s=>s.tag===t),i=r.find(s=>!s.format)??r[0];if(!i)throw new Error(`Tag ${t} not found`);return i}return n.find(r=>{var i;return((i=r.identify)==null?void 0:i.call(r,e))&&!r.format})}function Zr(e,t,n){var g,d,p;if(ss(e)&&(e=e.contents),Te(e))return e;if(we(e)){const y=(d=(g=n.schema[en]).createNode)==null?void 0:d.call(g,n.schema,null,n);return y.items.push(e),y}(e instanceof String||e instanceof Number||e instanceof Boolean||typeof BigInt<"u"&&e instanceof BigInt)&&(e=e.valueOf());const{aliasDuplicateObjects:r,onAnchor:i,onTagObj:s,schema:a,sourceObjects:c}=n;let u;if(r&&e&&typeof e=="object"){if(u=c.get(e),u)return u.anchor||(u.anchor=i(e)),new ya(u.anchor);u={anchor:null,node:null},c.set(e,u)}t!=null&&t.startsWith("!!")&&(t=oT+t.slice(2));let l=aT(e,t,a.tags);if(!l){if(e&&typeof e.toJSON=="function"&&(e=e.toJSON()),!e||typeof e!="object"){const y=new F(e);return u&&(u.node=y),y}l=e instanceof Map?a[en]:Symbol.iterator in Object(e)?a[Xn]:a[en]}s&&(s(l),delete n.onTagObj);const m=l!=null&&l.createNode?l.createNode(n.schema,e,n):typeof((p=l==null?void 0:l.nodeClass)==null?void 0:p.from)=="function"?l.nodeClass.from(n.schema,e,n):new F(e);return t?m.tag=t:l.default||(m.tag=l.tag),u&&(u.node=m),m}function as(e,t,n){let r=n;for(let i=t.length-1;i>=0;--i){const s=t[i];if(typeof s=="number"&&Number.isInteger(s)&&s>=0){const a=[];a[s]=r,r=a}else r=new Map([[s,r]])}return Zr(r,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:e,sourceObjects:new Map})}const Jr=e=>e==null||typeof e=="object"&&!!e[Symbol.iterator]().next().done;class cs extends ga{constructor(t,n){super(t),Object.defineProperty(this,"schema",{value:n,configurable:!0,enumerable:!1,writable:!0})}clone(t){const n=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return t&&(n.schema=t),n.items=n.items.map(r=>Te(r)||we(r)?r.clone(t):r),this.range&&(n.range=this.range.slice()),n}addIn(t,n){if(Jr(t))this.add(n);else{const[r,...i]=t,s=this.get(r,!0);if(be(s))s.addIn(i,n);else if(s===void 0&&this.schema)this.set(r,as(this.schema,i,n));else throw new Error(`Expected YAML collection at ${r}. Remaining path: ${i}`)}}deleteIn(t){const[n,...r]=t;if(r.length===0)return this.delete(n);const i=this.get(n,!0);if(be(i))return i.deleteIn(r);throw new Error(`Expected YAML collection at ${n}. Remaining path: ${r}`)}getIn(t,n){const[r,...i]=t,s=this.get(r,!0);return i.length===0?!n&&ie(s)?s.value:s:be(s)?s.getIn(i,n):void 0}hasAllNullValues(t){return this.items.every(n=>{if(!we(n))return!1;const r=n.value;return r==null||t&&ie(r)&&r.value==null&&!r.commentBefore&&!r.comment&&!r.tag})}hasIn(t){const[n,...r]=t;if(r.length===0)return this.has(n);const i=this.get(n,!0);return be(i)?i.hasIn(r):!1}setIn(t,n){const[r,...i]=t;if(i.length===0)this.set(r,n);else{const s=this.get(r,!0);if(be(s))s.setIn(i,n);else if(s===void 0&&this.schema)this.set(r,as(this.schema,i,n));else throw new Error(`Expected YAML collection at ${r}. Remaining path: ${i}`)}}}cs.maxFlowStringSingleLineLength=60;const cT=e=>e.replace(/^(?!$)(?: $)?/gm,"#");function Dt(e,t){return/^\n+$/.test(e)?e.substring(1):t?e.replace(/^(?! *$)/gm,t):e}const tn=(e,t,n)=>e.endsWith(`
`)?Dt(n,t):n.includes(`
`)?`
`+Dt(n,t):(e.endsWith(" ")?"":" ")+n,Lf="flow",wa="block",us="quoted";function ls(e,t,n="flow",{indentAtStart:r,lineWidth:i=80,minContentWidth:s=20,onFold:a,onOverflow:c}={}){if(!i||i<0)return e;const u=Math.max(1+s,1+i-t.length);if(e.length<=u)return e;const l=[],m={};let g=i-t.length;typeof r=="number"&&(r>i-Math.max(2,s)?l.push(0):g=i-r);let d,p,y=!1,w=-1,b=-1,P=-1;n===wa&&(w=Af(e,w),w!==-1&&(g=w+u));for(let $;$=e[w+=1];){if(n===us&&$==="\\"){switch(b=w,e[w+1]){case"x":w+=3;break;case"u":w+=5;break;case"U":w+=9;break;default:w+=1}P=w}if($===`
`)n===wa&&(w=Af(e,w)),g=w+u,d=void 0;else{if($===" "&&p&&p!==" "&&p!==`
`&&p!=="	"){const I=e[w+1];I&&I!==" "&&I!==`
`&&I!=="	"&&(d=w)}if(w>=g)if(d)l.push(d),g=d+u,d=void 0;else if(n===us){for(;p===" "||p==="	";)p=$,$=e[w+=1],y=!0;const I=w>P+1?w-2:b-1;if(m[I])return e;l.push(I),m[I]=!0,g=I+u,d=void 0}else y=!0}p=$}if(y&&c&&c(),l.length===0)return e;a&&a();let N=e.slice(0,l[0]);for(let $=0;$<l.length;++$){const I=l[$],_=l[$+1]||e.length;I===0?N=`
${t}${e.slice(0,_)}`:(n===us&&m[I]&&(N+=`${e[I]}\\`),N+=`
${t}${e.slice(I+1,_)}`)}return N}function Af(e,t){let n=e[t+1];for(;n===" "||n==="	";){do n=e[t+=1];while(n&&n!==`
`);n=e[t+1]}return t}const fs=(e,t)=>({indentAtStart:t?e.indent.length:e.indentAtStart,lineWidth:e.options.lineWidth,minContentWidth:e.options.minContentWidth}),ds=e=>/^(%|---|\.\.\.)/m.test(e);function uT(e,t,n){if(!t||t<0)return!1;const r=t-n,i=e.length;if(i<=r)return!1;for(let s=0,a=0;s<i;++s)if(e[s]===`
`){if(s-a>r)return!0;if(a=s+1,i-a<=r)return!1}return!0}function Kr(e,t){const n=JSON.stringify(e);if(t.options.doubleQuotedAsJSON)return n;const{implicitKey:r}=t,i=t.options.doubleQuotedMinMultiLineLength,s=t.indent||(ds(e)?"  ":"");let a="",c=0;for(let u=0,l=n[u];l;l=n[++u])if(l===" "&&n[u+1]==="\\"&&n[u+2]==="n"&&(a+=n.slice(c,u)+"\\ ",u+=1,c=u,l="\\"),l==="\\")switch(n[u+1]){case"u":{a+=n.slice(c,u);const m=n.substr(u+2,4);switch(m){case"0000":a+="\\0";break;case"0007":a+="\\a";break;case"000b":a+="\\v";break;case"001b":a+="\\e";break;case"0085":a+="\\N";break;case"00a0":a+="\\_";break;case"2028":a+="\\L";break;case"2029":a+="\\P";break;default:m.substr(0,2)==="00"?a+="\\x"+m.substr(2):a+=n.substr(u,6)}u+=5,c=u+1}break;case"n":if(r||n[u+2]==='"'||n.length<i)u+=1;else{for(a+=n.slice(c,u)+`

`;n[u+2]==="\\"&&n[u+3]==="n"&&n[u+4]!=='"';)a+=`
`,u+=2;a+=s,n[u+2]===" "&&(a+="\\"),u+=1,c=u+1}break;default:u+=1}return a=c?a+n.slice(c):n,r?a:ls(a,s,us,fs(t,!1))}function ba(e,t){if(t.options.singleQuote===!1||t.implicitKey&&e.includes(`
`)||/[ \t]\n|\n[ \t]/.test(e))return Kr(e,t);const n=t.indent||(ds(e)?"  ":""),r="'"+e.replace(/'/g,"''").replace(/\n+/g,`$&
${n}`)+"'";return t.implicitKey?r:ls(r,n,Lf,fs(t,!1))}function nr(e,t){const{singleQuote:n}=t.options;let r;if(n===!1)r=Kr;else{const i=e.includes('"'),s=e.includes("'");i&&!s?r=ba:s&&!i?r=Kr:r=n?ba:Kr}return r(e,t)}let va;try{va=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{va=/\n+(?!\n|$)/g}function ps({comment:e,type:t,value:n},r,i,s){const{blockQuote:a,commentString:c,lineWidth:u}=r.options;if(!a||/\n[\t ]+$/.test(n)||/^\s*$/.test(n))return nr(n,r);const l=r.indent||(r.forceBlockIndent||ds(n)?"  ":""),m=a==="literal"?!0:a==="folded"||t===F.BLOCK_FOLDED?!1:t===F.BLOCK_LITERAL?!0:!uT(n,u,l.length);if(!n)return m?`|
`:`>
`;let g,d;for(d=n.length;d>0;--d){const L=n[d-1];if(L!==`
`&&L!=="	"&&L!==" ")break}let p=n.substring(d);const y=p.indexOf(`
`);y===-1?g="-":n===p||y!==p.length-1?(g="+",s&&s()):g="",p&&(n=n.slice(0,-p.length),p[p.length-1]===`
`&&(p=p.slice(0,-1)),p=p.replace(va,`$&${l}`));let w=!1,b,P=-1;for(b=0;b<n.length;++b){const L=n[b];if(L===" ")w=!0;else if(L===`
`)P=b;else break}let N=n.substring(0,P<b?P+1:b);N&&(n=n.substring(N.length),N=N.replace(/\n+/g,`$&${l}`));let I=(m?"|":">")+(w?l?"2":"1":"")+g;if(e&&(I+=" "+c(e.replace(/ ?[\r\n]+/g," ")),i&&i()),m)return n=n.replace(/\n+/g,`$&${l}`),`${I}
${l}${N}${n}${p}`;n=n.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${l}`);const _=ls(`${N}${n}${p}`,l,wa,fs(r,!0));return`${I}
${l}${_}`}function lT(e,t,n,r){const{type:i,value:s}=e,{actualString:a,implicitKey:c,indent:u,indentStep:l,inFlow:m}=t;if(c&&/[\n[\]{},]/.test(s)||m&&/[[\]{},]/.test(s))return nr(s,t);if(!s||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(s))return c||m||!s.includes(`
`)?nr(s,t):ps(e,t,n,r);if(!c&&!m&&i!==F.PLAIN&&s.includes(`
`))return ps(e,t,n,r);if(ds(s)){if(u==="")return t.forceBlockIndent=!0,ps(e,t,n,r);if(c&&u===l)return nr(s,t)}const g=s.replace(/\n+/g,`$&
${u}`);if(a){const d=w=>{var b;return w.default&&w.tag!=="tag:yaml.org,2002:str"&&((b=w.test)==null?void 0:b.test(g))},{compat:p,tags:y}=t.doc.schema;if(y.some(d)||p!=null&&p.some(d))return nr(s,t)}return c?g:ls(g,u,Lf,fs(t,!1))}function Sa(e,t,n,r){const{implicitKey:i,inFlow:s}=t,a=typeof e.value=="string"?e:Object.assign({},e,{value:String(e.value)});let{type:c}=e;c!==F.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(a.value)&&(c=F.QUOTE_DOUBLE);const u=m=>{switch(m){case F.BLOCK_FOLDED:case F.BLOCK_LITERAL:return i||s?nr(a.value,t):ps(a,t,n,r);case F.QUOTE_DOUBLE:return Kr(a.value,t);case F.QUOTE_SINGLE:return ba(a.value,t);case F.PLAIN:return lT(a,t,n,r);default:return null}};let l=u(c);if(l===null){const{defaultKeyType:m,defaultStringType:g}=t.options,d=i&&m||g;if(l=u(d),l===null)throw new Error(`Unsupported default string type ${d}`)}return l}function Pf(e,t){const n=Object.assign({blockQuote:!0,commentString:cT,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},e.schema.toStringOptions,t);let r;switch(n.collectionStyle){case"block":r=!1;break;case"flow":r=!0;break;default:r=null}return{anchors:new Set,doc:e,flowCollectionPadding:n.flowCollectionPadding?" ":"",indent:"",indentStep:typeof n.indent=="number"?" ".repeat(n.indent):"  ",inFlow:r,options:n}}function fT(e,t){var i;if(t.tag){const s=e.filter(a=>a.tag===t.tag);if(s.length>0)return s.find(a=>a.format===t.format)??s[0]}let n,r;if(ie(t)){r=t.value;const s=e.filter(a=>{var c;return(c=a.identify)==null?void 0:c.call(a,r)});n=s.find(a=>a.format===t.format)??s.find(a=>!a.format)}else r=t,n=e.find(s=>s.nodeClass&&r instanceof s.nodeClass);if(!n){const s=((i=r==null?void 0:r.constructor)==null?void 0:i.name)??typeof r;throw new Error(`Tag not resolved for ${s} value`)}return n}function dT(e,t,{anchors:n,doc:r}){if(!r.directives)return"";const i=[],s=(ie(e)||be(e))&&e.anchor;s&&$f(s)&&(n.add(s),i.push(`&${s}`));const a=e.tag?e.tag:t.default?null:t.tag;return a&&i.push(r.directives.tagString(a)),i.join(" ")}function rr(e,t,n,r){var u;if(we(e))return e.toString(t,n,r);if(Qn(e)){if(t.doc.directives)return e.toString(t);if((u=t.resolvedAliases)!=null&&u.has(e))throw new TypeError("Cannot stringify circular structure without alias nodes");t.resolvedAliases?t.resolvedAliases.add(e):t.resolvedAliases=new Set([e]),e=e.resolve(t.doc)}let i;const s=Te(e)?e:t.doc.createNode(e,{onTagObj:l=>i=l});i||(i=fT(t.doc.schema.tags,s));const a=dT(s,i,t);a.length>0&&(t.indentAtStart=(t.indentAtStart??0)+a.length+1);const c=typeof i.stringify=="function"?i.stringify(s,t,n,r):ie(s)?Sa(s,t,n,r):s.toString(t,n,r);return a?ie(s)||c[0]==="{"||c[0]==="["?`${a} ${c}`:`${a}
${t.indent}${c}`:c}function pT({key:e,value:t},n,r,i){const{allNullValues:s,doc:a,indent:c,indentStep:u,options:{commentString:l,indentSeq:m,simpleKeys:g}}=n;let d=Te(e)&&e.comment||null;if(g){if(d)throw new Error("With simple keys, key nodes cannot have comments");if(be(e)){const z="With simple keys, collection cannot be used as a key value";throw new Error(z)}}let p=!g&&(!e||d&&t==null&&!n.inFlow||be(e)||(ie(e)?e.type===F.BLOCK_FOLDED||e.type===F.BLOCK_LITERAL:typeof e=="object"));n=Object.assign({},n,{allNullValues:!1,implicitKey:!p&&(g||!s),indent:c+u});let y=!1,w=!1,b=rr(e,n,()=>y=!0,()=>w=!0);if(!p&&!n.inFlow&&b.length>1024){if(g)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");p=!0}if(n.inFlow){if(s||t==null)return y&&r&&r(),b===""?"?":p?`? ${b}`:b}else if(s&&!g||t==null&&p)return b=`? ${b}`,d&&!y?b+=tn(b,n.indent,l(d)):w&&i&&i(),b;y&&(d=null),p?(d&&(b+=tn(b,n.indent,l(d))),b=`? ${b}
${c}:`):(b=`${b}:`,d&&(b+=tn(b,n.indent,l(d))));let P,N,$;Te(t)?(P=!!t.spaceBefore,N=t.commentBefore,$=t.comment):(P=!1,N=null,$=null,t&&typeof t=="object"&&(t=a.createNode(t))),n.implicitKey=!1,!p&&!d&&ie(t)&&(n.indentAtStart=b.length+1),w=!1,!m&&u.length>=2&&!n.inFlow&&!p&&qr(t)&&!t.flow&&!t.tag&&!t.anchor&&(n.indent=n.indent.substring(2));let I=!1;const _=rr(t,n,()=>I=!0,()=>w=!0);let L=" ";if(d||P||N){if(L=P?`
`:"",N){const z=l(N);L+=`
${Dt(z,n.indent)}`}_===""&&!n.inFlow?L===`
`&&(L=`

`):L+=`
${n.indent}`}else if(!p&&be(t)){const z=_[0],J=_.indexOf(`
`),ae=J!==-1,Ye=n.inFlow??t.flow??t.items.length===0;if(ae||!Ye){let Et=!1;if(ae&&(z==="&"||z==="!")){let Ie=_.indexOf(" ");z==="&"&&Ie!==-1&&Ie<J&&_[Ie+1]==="!"&&(Ie=_.indexOf(" ",Ie+1)),(Ie===-1||J<Ie)&&(Et=!0)}Et||(L=`
${n.indent}`)}}else(_===""||_[0]===`
`)&&(L="");return b+=L+_,n.inFlow?I&&r&&r():$&&!I?b+=tn(b,n.indent,l($)):w&&i&&i(),b}function Rf(e,t){(e==="debug"||e==="warn")&&(typeof process<"u"&&process.emitWarning?process.emitWarning(t):console.warn(t))}const _f="<<";function Cf(e,t,{key:n,value:r}){if(e!=null&&e.doc.schema.merge&&hT(n))if(r=Qn(r)?r.resolve(e.doc):r,qr(r))for(const i of r.items)ka(e,t,i);else if(Array.isArray(r))for(const i of r)ka(e,t,i);else ka(e,t,r);else{const i=ft(n,"",e);if(t instanceof Map)t.set(i,ft(r,i,e));else if(t instanceof Set)t.add(i);else{const s=mT(n,i,e),a=ft(r,s,e);s in t?Object.defineProperty(t,s,{value:a,writable:!0,enumerable:!0,configurable:!0}):t[s]=a}}return t}const hT=e=>e===_f||ie(e)&&e.value===_f&&(!e.type||e.type===F.PLAIN);function ka(e,t,n){const r=e&&Qn(n)?n.resolve(e.doc):n;if(!Vr(r))throw new Error("Merge sources must be maps or map aliases");const i=r.toJSON(null,e,Map);for(const[s,a]of i)t instanceof Map?t.has(s)||t.set(s,a):t instanceof Set?t.add(s):Object.prototype.hasOwnProperty.call(t,s)||Object.defineProperty(t,s,{value:a,writable:!0,enumerable:!0,configurable:!0});return t}function mT(e,t,n){if(t===null)return"";if(typeof t!="object")return String(t);if(Te(e)&&n&&n.doc){const r=Pf(n.doc,{});r.anchors=new Set;for(const s of n.anchors.keys())r.anchors.add(s.anchor);r.inFlow=!0,r.inStringifyKey=!0;const i=e.toString(r);if(!n.mapKeyWarned){let s=JSON.stringify(i);s.length>40&&(s=s.substring(0,36)+'..."'),Rf(n.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${s}. Set mapAsMap: true to use object keys.`),n.mapKeyWarned=!0}return i}return JSON.stringify(t)}function Oa(e,t,n){const r=Zr(e,void 0,n),i=Zr(t,void 0,n);return new Ke(r,i)}class Ke{constructor(t,n=null){Object.defineProperty(this,lt,{value:If}),this.key=t,this.value=n}clone(t){let{key:n,value:r}=this;return Te(n)&&(n=n.clone(t)),Te(r)&&(r=r.clone(t)),new Ke(n,r)}toJSON(t,n){const r=n!=null&&n.mapAsMap?new Map:{};return Cf(n,r,this)}toString(t,n,r){return t!=null&&t.doc?pT(this,t,n,r):JSON.stringify(this)}}function jf(e,t,n){return(t.inFlow??e.flow?yT:gT)(e,t,n)}function gT({comment:e,items:t},n,{blockItemPrefix:r,flowChars:i,itemIndent:s,onChompKeep:a,onComment:c}){const{indent:u,options:{commentString:l}}=n,m=Object.assign({},n,{indent:s,type:null});let g=!1;const d=[];for(let y=0;y<t.length;++y){const w=t[y];let b=null;if(Te(w))!g&&w.spaceBefore&&d.push(""),hs(n,d,w.commentBefore,g),w.comment&&(b=w.comment);else if(we(w)){const N=Te(w.key)?w.key:null;N&&(!g&&N.spaceBefore&&d.push(""),hs(n,d,N.commentBefore,g))}g=!1;let P=rr(w,m,()=>b=null,()=>g=!0);b&&(P+=tn(P,s,l(b))),g&&b&&(g=!1),d.push(r+P)}let p;if(d.length===0)p=i.start+i.end;else{p=d[0];for(let y=1;y<d.length;++y){const w=d[y];p+=w?`
${u}${w}`:`
`}}return e?(p+=`
`+Dt(l(e),u),c&&c()):g&&a&&a(),p}function yT({comment:e,items:t},n,{flowChars:r,itemIndent:i,onComment:s}){const{indent:a,indentStep:c,flowCollectionPadding:u,options:{commentString:l}}=n;i+=c;const m=Object.assign({},n,{indent:i,inFlow:!0,type:null});let g=!1,d=0;const p=[];for(let P=0;P<t.length;++P){const N=t[P];let $=null;if(Te(N))N.spaceBefore&&p.push(""),hs(n,p,N.commentBefore,!1),N.comment&&($=N.comment);else if(we(N)){const _=Te(N.key)?N.key:null;_&&(_.spaceBefore&&p.push(""),hs(n,p,_.commentBefore,!1),_.comment&&(g=!0));const L=Te(N.value)?N.value:null;L?(L.comment&&($=L.comment),L.commentBefore&&(g=!0)):N.value==null&&_&&_.comment&&($=_.comment)}$&&(g=!0);let I=rr(N,m,()=>$=null);P<t.length-1&&(I+=","),$&&(I+=tn(I,i,l($))),!g&&(p.length>d||I.includes(`
`))&&(g=!0),p.push(I),d=p.length}let y;const{start:w,end:b}=r;if(p.length===0)y=w+b;else if(g||(g=p.reduce((N,$)=>N+$.length+2,2)>cs.maxFlowStringSingleLineLength),g){y=w;for(const P of p)y+=P?`
${c}${a}${P}`:`
`;y+=`
${a}${b}`}else y=`${w}${u}${p.join(" ")}${u}${b}`;return e&&(y+=tn(y,a,l(e)),s&&s()),y}function hs({indent:e,options:{commentString:t}},n,r,i){if(r&&i&&(r=r.replace(/^\n+/,"")),r){const s=Dt(t(r),e);n.push(s.trimStart())}}function En(e,t){const n=ie(t)?t.value:t;for(const r of e)if(we(r)&&(r.key===t||r.key===n||ie(r.key)&&r.key.value===n))return r}class dt extends cs{static get tagName(){return"tag:yaml.org,2002:map"}constructor(t){super(en,t),this.items=[]}static from(t,n,r){const{keepUndefined:i,replacer:s}=r,a=new this(t),c=(u,l)=>{if(typeof s=="function")l=s.call(n,u,l);else if(Array.isArray(s)&&!s.includes(u))return;(l!==void 0||i)&&a.items.push(Oa(u,l,r))};if(n instanceof Map)for(const[u,l]of n)c(u,l);else if(n&&typeof n=="object")for(const u of Object.keys(n))c(u,n[u]);return typeof t.sortMapEntries=="function"&&a.items.sort(t.sortMapEntries),a}add(t,n){var a;let r;we(t)?r=t:!t||typeof t!="object"||!("key"in t)?r=new Ke(t,t==null?void 0:t.value):r=new Ke(t.key,t.value);const i=En(this.items,r.key),s=(a=this.schema)==null?void 0:a.sortMapEntries;if(i){if(!n)throw new Error(`Key ${r.key} already set`);ie(i.value)&&Nf(r.value)?i.value.value=r.value:i.value=r.value}else if(s){const c=this.items.findIndex(u=>s(r,u)<0);c===-1?this.items.push(r):this.items.splice(c,0,r)}else this.items.push(r)}delete(t){const n=En(this.items,t);return n?this.items.splice(this.items.indexOf(n),1).length>0:!1}get(t,n){const r=En(this.items,t),i=r==null?void 0:r.value;return(!n&&ie(i)?i.value:i)??void 0}has(t){return!!En(this.items,t)}set(t,n){this.add(new Ke(t,n),!0)}toJSON(t,n,r){const i=r?new r:n!=null&&n.mapAsMap?new Map:{};n!=null&&n.onCreate&&n.onCreate(i);for(const s of this.items)Cf(n,i,s);return i}toString(t,n,r){if(!t)return JSON.stringify(this);for(const i of this.items)if(!we(i))throw new Error(`Map items must all be pairs; found ${JSON.stringify(i)} instead`);return!t.allNullValues&&this.hasAllNullValues(!1)&&(t=Object.assign({},t,{allNullValues:!0})),jf(this,t,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:t.indent||"",onChompKeep:r,onComment:n})}}const ir={collection:"map",default:!0,nodeClass:dt,tag:"tag:yaml.org,2002:map",resolve(e,t){return Vr(e)||t("Expected a mapping for this tag"),e},createNode:(e,t,n)=>dt.from(e,t,n)};class Tn extends cs{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(t){super(Xn,t),this.items=[]}add(t){this.items.push(t)}delete(t){const n=ms(t);return typeof n!="number"?!1:this.items.splice(n,1).length>0}get(t,n){const r=ms(t);if(typeof r!="number")return;const i=this.items[r];return!n&&ie(i)?i.value:i}has(t){const n=ms(t);return typeof n=="number"&&n<this.items.length}set(t,n){const r=ms(t);if(typeof r!="number")throw new Error(`Expected a valid index, not ${t}.`);const i=this.items[r];ie(i)&&Nf(n)?i.value=n:this.items[r]=n}toJSON(t,n){const r=[];n!=null&&n.onCreate&&n.onCreate(r);let i=0;for(const s of this.items)r.push(ft(s,String(i++),n));return r}toString(t,n,r){return t?jf(this,t,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(t.indent||"")+"  ",onChompKeep:r,onComment:n}):JSON.stringify(this)}static from(t,n,r){const{replacer:i}=r,s=new this(t);if(n&&Symbol.iterator in Object(n)){let a=0;for(let c of n){if(typeof i=="function"){const u=n instanceof Set?c:String(a++);c=i.call(n,u,c)}s.items.push(Zr(c,void 0,r))}}return s}}function ms(e){let t=ie(e)?e.value:e;return t&&typeof t=="string"&&(t=Number(t)),typeof t=="number"&&Number.isInteger(t)&&t>=0?t:null}const sr={collection:"seq",default:!0,nodeClass:Tn,tag:"tag:yaml.org,2002:seq",resolve(e,t){return qr(e)||t("Expected a sequence for this tag"),e},createNode:(e,t,n)=>Tn.from(e,t,n)},gs={identify:e=>typeof e=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify(e,t,n,r){return t=Object.assign({actualString:!0},t),Sa(e,t,n,r)}},ys={identify:e=>e==null,createNode:()=>new F(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new F(null),stringify:({source:e},t)=>typeof e=="string"&&ys.test.test(e)?e:t.options.nullStr},Ia={identify:e=>typeof e=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:e=>new F(e[0]==="t"||e[0]==="T"),stringify({source:e,value:t},n){if(e&&Ia.test.test(e)){const r=e[0]==="t"||e[0]==="T";if(t===r)return e}return t?n.options.trueStr:n.options.falseStr}};function Ot({format:e,minFractionDigits:t,tag:n,value:r}){if(typeof r=="bigint")return String(r);const i=typeof r=="number"?r:Number(r);if(!isFinite(i))return isNaN(i)?".nan":i<0?"-.inf":".inf";let s=JSON.stringify(r);if(!e&&t&&(!n||n==="tag:yaml.org,2002:float")&&/^\d/.test(s)){let a=s.indexOf(".");a<0&&(a=s.length,s+=".");let c=t-(s.length-a-1);for(;c-- >0;)s+="0"}return s}const Uf={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN))$/,resolve:e=>e.slice(-3).toLowerCase()==="nan"?NaN:e[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Ot},xf={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e),stringify(e){const t=Number(e.value);return isFinite(t)?t.toExponential():Ot(e)}},Mf={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(e){const t=new F(parseFloat(e)),n=e.indexOf(".");return n!==-1&&e[e.length-1]==="0"&&(t.minFractionDigits=e.length-n-1),t},stringify:Ot},ws=e=>typeof e=="bigint"||Number.isInteger(e),$a=(e,t,n,{intAsBigInt:r})=>r?BigInt(e):parseInt(e.substring(t),n);function Ff(e,t,n){const{value:r}=e;return ws(r)&&r>=0?n+r.toString(t):Ot(e)}const Df={identify:e=>ws(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(e,t,n)=>$a(e,2,8,n),stringify:e=>Ff(e,8,"0o")},Bf={identify:ws,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(e,t,n)=>$a(e,0,10,n),stringify:Ot},zf={identify:e=>ws(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(e,t,n)=>$a(e,2,16,n),stringify:e=>Ff(e,16,"0x")},wT=[ir,sr,gs,ys,Ia,Df,Bf,zf,Uf,xf,Mf];function Vf(e){return typeof e=="bigint"||Number.isInteger(e)}const bs=({value:e})=>JSON.stringify(e),bT=[{identify:e=>typeof e=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:bs},{identify:e=>e==null,createNode:()=>new F(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:bs},{identify:e=>typeof e=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true|false$/,resolve:e=>e==="true",stringify:bs},{identify:Vf,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(e,t,{intAsBigInt:n})=>n?BigInt(e):parseInt(e,10),stringify:({value:e})=>Vf(e)?e.toString():JSON.stringify(e)},{identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:e=>parseFloat(e),stringify:bs}],vT={default:!0,tag:"",test:/^/,resolve(e,t){return t(`Unresolved plain scalar ${JSON.stringify(e)}`),e}},ST=[ir,sr].concat(bT,vT),Ea={identify:e=>e instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(e,t){if(typeof Buffer=="function")return Buffer.from(e,"base64");if(typeof atob=="function"){const n=atob(e.replace(/[\n\r]/g,"")),r=new Uint8Array(n.length);for(let i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}else return t("This environment does not support reading binary tags; either Buffer or atob is required"),e},stringify({comment:e,type:t,value:n},r,i,s){const a=n;let c;if(typeof Buffer=="function")c=a instanceof Buffer?a.toString("base64"):Buffer.from(a.buffer).toString("base64");else if(typeof btoa=="function"){let u="";for(let l=0;l<a.length;++l)u+=String.fromCharCode(a[l]);c=btoa(u)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(t||(t=F.BLOCK_LITERAL),t!==F.QUOTE_DOUBLE){const u=Math.max(r.options.lineWidth-r.indent.length,r.options.minContentWidth),l=Math.ceil(c.length/u),m=new Array(l);for(let g=0,d=0;g<l;++g,d+=u)m[g]=c.substr(d,u);c=m.join(t===F.BLOCK_LITERAL?`
`:" ")}return Sa({comment:e,type:t,value:c},r,i,s)}};function qf(e,t){if(qr(e))for(let n=0;n<e.items.length;++n){let r=e.items[n];if(!we(r)){if(Vr(r)){r.items.length>1&&t("Each pair must have its own sequence indicator");const i=r.items[0]||new Ke(new F(null));if(r.commentBefore&&(i.key.commentBefore=i.key.commentBefore?`${r.commentBefore}
${i.key.commentBefore}`:r.commentBefore),r.comment){const s=i.value??i.key;s.comment=s.comment?`${r.comment}
${s.comment}`:r.comment}r=i}e.items[n]=we(r)?r:new Ke(r)}}else t("Expected a sequence for this tag");return e}function Gf(e,t,n){const{replacer:r}=n,i=new Tn(e);i.tag="tag:yaml.org,2002:pairs";let s=0;if(t&&Symbol.iterator in Object(t))for(let a of t){typeof r=="function"&&(a=r.call(t,String(s++),a));let c,u;if(Array.isArray(a))if(a.length===2)c=a[0],u=a[1];else throw new TypeError(`Expected [key, value] tuple: ${a}`);else if(a&&a instanceof Object){const l=Object.keys(a);if(l.length===1)c=l[0],u=a[c];else throw new TypeError(`Expected { key: value } tuple: ${a}`)}else c=a;i.items.push(Oa(c,u,n))}return i}const Ta={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:qf,createNode:Gf};class or extends Tn{constructor(){super(),this.add=dt.prototype.add.bind(this),this.delete=dt.prototype.delete.bind(this),this.get=dt.prototype.get.bind(this),this.has=dt.prototype.has.bind(this),this.set=dt.prototype.set.bind(this),this.tag=or.tag}toJSON(t,n){if(!n)return super.toJSON(t);const r=new Map;n!=null&&n.onCreate&&n.onCreate(r);for(const i of this.items){let s,a;if(we(i)?(s=ft(i.key,"",n),a=ft(i.value,s,n)):s=ft(i,"",n),r.has(s))throw new Error("Ordered maps must not include duplicate keys");r.set(s,a)}return r}static from(t,n,r){const i=Gf(t,n,r),s=new this;return s.items=i.items,s}}or.tag="tag:yaml.org,2002:omap";const Na={collection:"seq",identify:e=>e instanceof Map,nodeClass:or,default:!1,tag:"tag:yaml.org,2002:omap",resolve(e,t){const n=qf(e,t),r=[];for(const{key:i}of n.items)ie(i)&&(r.includes(i.value)?t(`Ordered maps must not include duplicate keys: ${i.value}`):r.push(i.value));return Object.assign(new or,n)},createNode:(e,t,n)=>or.from(e,t,n)};function Zf({value:e,source:t},n){return t&&(e?Jf:Kf).test.test(t)?t:e?n.options.trueStr:n.options.falseStr}const Jf={identify:e=>e===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new F(!0),stringify:Zf},Kf={identify:e=>e===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/i,resolve:()=>new F(!1),stringify:Zf},kT={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN)$/,resolve:e=>e.slice(-3).toLowerCase()==="nan"?NaN:e[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Ot},OT={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e.replace(/_/g,"")),stringify(e){const t=Number(e.value);return isFinite(t)?t.toExponential():Ot(e)}},IT={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(e){const t=new F(parseFloat(e.replace(/_/g,""))),n=e.indexOf(".");if(n!==-1){const r=e.substring(n+1).replace(/_/g,"");r[r.length-1]==="0"&&(t.minFractionDigits=r.length)}return t},stringify:Ot},Wr=e=>typeof e=="bigint"||Number.isInteger(e);function vs(e,t,n,{intAsBigInt:r}){const i=e[0];if((i==="-"||i==="+")&&(t+=1),e=e.substring(t).replace(/_/g,""),r){switch(n){case 2:e=`0b${e}`;break;case 8:e=`0o${e}`;break;case 16:e=`0x${e}`;break}const a=BigInt(e);return i==="-"?BigInt(-1)*a:a}const s=parseInt(e,n);return i==="-"?-1*s:s}function La(e,t,n){const{value:r}=e;if(Wr(r)){const i=r.toString(t);return r<0?"-"+n+i.substr(1):n+i}return Ot(e)}const $T={identify:Wr,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(e,t,n)=>vs(e,2,2,n),stringify:e=>La(e,2,"0b")},ET={identify:Wr,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(e,t,n)=>vs(e,1,8,n),stringify:e=>La(e,8,"0")},TT={identify:Wr,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(e,t,n)=>vs(e,0,10,n),stringify:Ot},NT={identify:Wr,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(e,t,n)=>vs(e,2,16,n),stringify:e=>La(e,16,"0x")};class ar extends dt{constructor(t){super(t),this.tag=ar.tag}add(t){let n;we(t)?n=t:t&&typeof t=="object"&&"key"in t&&"value"in t&&t.value===null?n=new Ke(t.key,null):n=new Ke(t,null),En(this.items,n.key)||this.items.push(n)}get(t,n){const r=En(this.items,t);return!n&&we(r)?ie(r.key)?r.key.value:r.key:r}set(t,n){if(typeof n!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof n}`);const r=En(this.items,t);r&&!n?this.items.splice(this.items.indexOf(r),1):!r&&n&&this.items.push(new Ke(t))}toJSON(t,n){return super.toJSON(t,n,Set)}toString(t,n,r){if(!t)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},t,{allNullValues:!0}),n,r);throw new Error("Set items must all have null values")}static from(t,n,r){const{replacer:i}=r,s=new this(t);if(n&&Symbol.iterator in Object(n))for(let a of n)typeof i=="function"&&(a=i.call(n,a,a)),s.items.push(Oa(a,null,r));return s}}ar.tag="tag:yaml.org,2002:set";const Aa={collection:"map",identify:e=>e instanceof Set,nodeClass:ar,default:!1,tag:"tag:yaml.org,2002:set",createNode:(e,t,n)=>ar.from(e,t,n),resolve(e,t){if(Vr(e)){if(e.hasAllNullValues(!0))return Object.assign(new ar,e);t("Set items must all have null values")}else t("Expected a mapping for this tag");return e}};function Pa(e,t){const n=e[0],r=n==="-"||n==="+"?e.substring(1):e,i=a=>t?BigInt(a):Number(a),s=r.replace(/_/g,"").split(":").reduce((a,c)=>a*i(60)+i(c),i(0));return n==="-"?i(-1)*s:s}function Wf(e){let{value:t}=e,n=a=>a;if(typeof t=="bigint")n=a=>BigInt(a);else if(isNaN(t)||!isFinite(t))return Ot(e);let r="";t<0&&(r="-",t*=n(-1));const i=n(60),s=[t%i];return t<60?s.unshift(0):(t=(t-s[0])/i,s.unshift(t%i),t>=60&&(t=(t-s[0])/i,s.unshift(t))),r+s.map(a=>String(a).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const Hf={identify:e=>typeof e=="bigint"||Number.isInteger(e),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(e,t,{intAsBigInt:n})=>Pa(e,n),stringify:Wf},Yf={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:e=>Pa(e,!1),stringify:Wf},Ss={identify:e=>e instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(e){const t=e.match(Ss.test);if(!t)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,n,r,i,s,a,c]=t.map(Number),u=t[7]?Number((t[7]+"00").substr(1,3)):0;let l=Date.UTC(n,r-1,i,s||0,a||0,c||0,u);const m=t[8];if(m&&m!=="Z"){let g=Pa(m,!1);Math.abs(g)<30&&(g*=60),l-=6e4*g}return new Date(l)},stringify:({value:e})=>e.toISOString().replace(/((T00:00)?:00)?\.000Z$/,"")},Xf=[ir,sr,gs,ys,Jf,Kf,$T,ET,TT,NT,kT,OT,IT,Ea,Na,Ta,Aa,Hf,Yf,Ss],Qf=new Map([["core",wT],["failsafe",[ir,sr,gs]],["json",ST],["yaml11",Xf],["yaml-1.1",Xf]]),ed={binary:Ea,bool:Ia,float:Mf,floatExp:xf,floatNaN:Uf,floatTime:Yf,int:Bf,intHex:zf,intOct:Df,intTime:Hf,map:ir,null:ys,omap:Na,pairs:Ta,seq:sr,set:Aa,timestamp:Ss},LT={"tag:yaml.org,2002:binary":Ea,"tag:yaml.org,2002:omap":Na,"tag:yaml.org,2002:pairs":Ta,"tag:yaml.org,2002:set":Aa,"tag:yaml.org,2002:timestamp":Ss};function Ra(e,t){let n=Qf.get(t);if(!n)if(Array.isArray(e))n=[];else{const r=Array.from(Qf.keys()).filter(i=>i!=="yaml11").map(i=>JSON.stringify(i)).join(", ");throw new Error(`Unknown schema "${t}"; use one of ${r} or define customTags array`)}if(Array.isArray(e))for(const r of e)n=n.concat(r);else typeof e=="function"&&(n=e(n.slice()));return n.map(r=>{if(typeof r!="string")return r;const i=ed[r];if(i)return i;const s=Object.keys(ed).map(a=>JSON.stringify(a)).join(", ");throw new Error(`Unknown custom tag "${r}"; use one of ${s}`)})}const AT=(e,t)=>e.key<t.key?-1:e.key>t.key?1:0;class _a{constructor({compat:t,customTags:n,merge:r,resolveKnownTags:i,schema:s,sortMapEntries:a,toStringDefaults:c}){this.compat=Array.isArray(t)?Ra(t,"compat"):t?Ra(null,t):null,this.merge=!!r,this.name=typeof s=="string"&&s||"core",this.knownTags=i?LT:{},this.tags=Ra(n,this.name),this.toStringOptions=c??null,Object.defineProperty(this,en,{value:ir}),Object.defineProperty(this,Ft,{value:gs}),Object.defineProperty(this,Xn,{value:sr}),this.sortMapEntries=typeof a=="function"?a:a===!0?AT:null}clone(){const t=Object.create(_a.prototype,Object.getOwnPropertyDescriptors(this));return t.tags=this.tags.slice(),t}}function PT(e,t){var u;const n=[];let r=t.directives===!0;if(t.directives!==!1&&e.directives){const l=e.directives.toString(e);l?(n.push(l),r=!0):e.directives.docStart&&(r=!0)}r&&n.push("---");const i=Pf(e,t),{commentString:s}=i.options;if(e.commentBefore){n.length!==1&&n.unshift("");const l=s(e.commentBefore);n.unshift(Dt(l,""))}let a=!1,c=null;if(e.contents){if(Te(e.contents)){if(e.contents.spaceBefore&&r&&n.push(""),e.contents.commentBefore){const g=s(e.contents.commentBefore);n.push(Dt(g,""))}i.forceBlockIndent=!!e.comment,c=e.contents.comment}const l=c?void 0:()=>a=!0;let m=rr(e.contents,i,()=>c=null,l);c&&(m+=tn(m,"",s(c))),(m[0]==="|"||m[0]===">")&&n[n.length-1]==="---"?n[n.length-1]=`--- ${m}`:n.push(m)}else n.push(rr(e.contents,i));if((u=e.directives)!=null&&u.docEnd)if(e.comment){const l=s(e.comment);l.includes(`
`)?(n.push("..."),n.push(Dt(l,""))):n.push(`... ${l}`)}else n.push("...");else{let l=e.comment;l&&a&&(l=l.replace(/^\n+/,"")),l&&((!a||c)&&n[n.length-1]!==""&&n.push(""),n.push(Dt(s(l),"")))}return n.join(`
`)+`
`}class ks{constructor(t,n,r){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,lt,{value:ma});let i=null;typeof n=="function"||Array.isArray(n)?i=n:r===void 0&&n&&(r=n,n=void 0);const s=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,uniqueKeys:!0,version:"1.2"},r);this.options=s;let{version:a}=s;r!=null&&r._directives?(this.directives=r._directives.atDocument(),this.directives.yaml.explicit&&(a=this.directives.yaml.version)):this.directives=new Je({version:a}),this.setSchema(a,r),this.contents=t===void 0?null:this.createNode(t,i,r)}clone(){const t=Object.create(ks.prototype,{[lt]:{value:ma}});return t.commentBefore=this.commentBefore,t.comment=this.comment,t.errors=this.errors.slice(),t.warnings=this.warnings.slice(),t.options=Object.assign({},this.options),this.directives&&(t.directives=this.directives.clone()),t.schema=this.schema.clone(),t.contents=Te(this.contents)?this.contents.clone(t.schema):this.contents,this.range&&(t.range=this.range.slice()),t}add(t){cr(this.contents)&&this.contents.add(t)}addIn(t,n){cr(this.contents)&&this.contents.addIn(t,n)}createAlias(t,n){if(!t.anchor){const r=Ef(this);t.anchor=!n||r.has(n)?Tf(n||"a",r):n}return new ya(t.anchor)}createNode(t,n,r){let i;if(typeof n=="function")t=n.call({"":t},"",t),i=n;else if(Array.isArray(n)){const b=N=>typeof N=="number"||N instanceof String||N instanceof Number,P=n.filter(b).map(String);P.length>0&&(n=n.concat(P)),i=n}else r===void 0&&n&&(r=n,n=void 0);const{aliasDuplicateObjects:s,anchorPrefix:a,flow:c,keepUndefined:u,onTagObj:l,tag:m}=r??{},{onAnchor:g,setAnchors:d,sourceObjects:p}=sT(this,a||"a"),y={aliasDuplicateObjects:s??!0,keepUndefined:u??!1,onAnchor:g,onTagObj:l,replacer:i,schema:this.schema,sourceObjects:p},w=Zr(t,m,y);return c&&be(w)&&(w.flow=!0),d(),w}createPair(t,n,r={}){const i=this.createNode(t,null,r),s=this.createNode(n,null,r);return new Ke(i,s)}delete(t){return cr(this.contents)?this.contents.delete(t):!1}deleteIn(t){return Jr(t)?this.contents==null?!1:(this.contents=null,!0):cr(this.contents)?this.contents.deleteIn(t):!1}get(t,n){return be(this.contents)?this.contents.get(t,n):void 0}getIn(t,n){return Jr(t)?!n&&ie(this.contents)?this.contents.value:this.contents:be(this.contents)?this.contents.getIn(t,n):void 0}has(t){return be(this.contents)?this.contents.has(t):!1}hasIn(t){return Jr(t)?this.contents!==void 0:be(this.contents)?this.contents.hasIn(t):!1}set(t,n){this.contents==null?this.contents=as(this.schema,[t],n):cr(this.contents)&&this.contents.set(t,n)}setIn(t,n){Jr(t)?this.contents=n:this.contents==null?this.contents=as(this.schema,Array.from(t),n):cr(this.contents)&&this.contents.setIn(t,n)}setSchema(t,n={}){typeof t=="number"&&(t=String(t));let r;switch(t){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new Je({version:"1.1"}),r={merge:!0,resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=t:this.directives=new Je({version:t}),r={merge:!1,resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,r=null;break;default:{const i=JSON.stringify(t);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${i}`)}}if(n.schema instanceof Object)this.schema=n.schema;else if(r)this.schema=new _a(Object.assign(r,n));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:t,jsonArg:n,mapAsMap:r,maxAliasCount:i,onAnchor:s,reviver:a}={}){const c={anchors:new Map,doc:this,keep:!t,mapAsMap:r===!0,mapKeyWarned:!1,maxAliasCount:typeof i=="number"?i:100},u=ft(this.contents,n??"",c);if(typeof s=="function")for(const{count:l,res:m}of c.anchors.values())s(m,l);return typeof a=="function"?tr(a,{"":u},"",u):u}toJSON(t,n){return this.toJS({json:!0,jsonArg:t,mapAsMap:!1,onAnchor:n})}toString(t={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in t&&(!Number.isInteger(t.indent)||Number(t.indent)<=0)){const n=JSON.stringify(t.indent);throw new Error(`"indent" option must be a positive integer, not ${n}`)}return PT(this,t)}}function cr(e){if(be(e))return!0;throw new Error("Expected a YAML collection as document contents")}class td extends Error{constructor(t,n,r,i){super(),this.name=t,this.code=r,this.message=i,this.pos=n}}class Hr extends td{constructor(t,n,r){super("YAMLParseError",t,n,r)}}class RT extends td{constructor(t,n,r){super("YAMLWarning",t,n,r)}}const nd=(e,t)=>n=>{if(n.pos[0]===-1)return;n.linePos=n.pos.map(c=>t.linePos(c));const{line:r,col:i}=n.linePos[0];n.message+=` at line ${r}, column ${i}`;let s=i-1,a=e.substring(t.lineStarts[r-1],t.lineStarts[r]).replace(/[\n\r]+$/,"");if(s>=60&&a.length>80){const c=Math.min(s-39,a.length-79);a="…"+a.substring(c),s-=c-1}if(a.length>80&&(a=a.substring(0,79)+"…"),r>1&&/^ *$/.test(a.substring(0,s))){let c=e.substring(t.lineStarts[r-2],t.lineStarts[r-1]);c.length>80&&(c=c.substring(0,79)+`…
`),a=c+a}if(/[^ ]/.test(a)){let c=1;const u=n.linePos[1];u&&u.line===r&&u.col>i&&(c=Math.max(1,Math.min(u.col-i,80-s)));const l=" ".repeat(s)+"^".repeat(c);n.message+=`:

${a}
${l}
`}};function ur(e,{flow:t,indicator:n,next:r,offset:i,onError:s,startOnNewline:a}){let c=!1,u=a,l=a,m="",g="",d=!1,p=!1,y=!1,w=null,b=null,P=null,N=null,$=null;for(const L of e)switch(y&&(L.type!=="space"&&L.type!=="newline"&&L.type!=="comma"&&s(L.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),y=!1),L.type){case"space":!t&&u&&n!=="doc-start"&&L.source[0]==="	"&&s(L,"TAB_AS_INDENT","Tabs are not allowed as indentation"),l=!0;break;case"comment":{l||s(L,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const z=L.source.substring(1)||" ";m?m+=g+z:m=z,g="",u=!1;break}case"newline":u?m?m+=L.source:c=!0:g+=L.source,u=!0,d=!0,(w||b)&&(p=!0),l=!0;break;case"anchor":w&&s(L,"MULTIPLE_ANCHORS","A node can have at most one anchor"),L.source.endsWith(":")&&s(L.offset+L.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),w=L,$===null&&($=L.offset),u=!1,l=!1,y=!0;break;case"tag":{b&&s(L,"MULTIPLE_TAGS","A node can have at most one tag"),b=L,$===null&&($=L.offset),u=!1,l=!1,y=!0;break}case n:(w||b)&&s(L,"BAD_PROP_ORDER",`Anchors and tags must be after the ${L.source} indicator`),N&&s(L,"UNEXPECTED_TOKEN",`Unexpected ${L.source} in ${t??"collection"}`),N=L,u=!1,l=!1;break;case"comma":if(t){P&&s(L,"UNEXPECTED_TOKEN",`Unexpected , in ${t}`),P=L,u=!1,l=!1;break}default:s(L,"UNEXPECTED_TOKEN",`Unexpected ${L.type} token`),u=!1,l=!1}const I=e[e.length-1],_=I?I.offset+I.source.length:i;return y&&r&&r.type!=="space"&&r.type!=="newline"&&r.type!=="comma"&&(r.type!=="scalar"||r.source!=="")&&s(r.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),{comma:P,found:N,spaceBefore:c,comment:m,hasNewline:d,hasNewlineAfterProp:p,anchor:w,tag:b,end:_,start:$??_}}function Yr(e){if(!e)return null;switch(e.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(e.source.includes(`
`))return!0;if(e.end){for(const t of e.end)if(t.type==="newline")return!0}return!1;case"flow-collection":for(const t of e.items){for(const n of t.start)if(n.type==="newline")return!0;if(t.sep){for(const n of t.sep)if(n.type==="newline")return!0}if(Yr(t.key)||Yr(t.value))return!0}return!1;default:return!0}}function Ca(e,t,n){if((t==null?void 0:t.type)==="flow-collection"){const r=t.end[0];r.indent===e&&(r.source==="]"||r.source==="}")&&Yr(t)&&n(r,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function rd(e,t,n){const{uniqueKeys:r}=e.options;if(r===!1)return!1;const i=typeof r=="function"?r:(s,a)=>s===a||ie(s)&&ie(a)&&s.value===a.value&&!(s.value==="<<"&&e.schema.merge);return t.some(s=>i(s.key,n))}const id="All mapping items must start at the same column";function _T({composeNode:e,composeEmptyNode:t},n,r,i,s){var m;const a=(s==null?void 0:s.nodeClass)??dt,c=new a(n.schema);n.atRoot&&(n.atRoot=!1);let u=r.offset,l=null;for(const g of r.items){const{start:d,key:p,sep:y,value:w}=g,b=ur(d,{indicator:"explicit-key-ind",next:p??(y==null?void 0:y[0]),offset:u,onError:i,startOnNewline:!0}),P=!b.found;if(P){if(p&&(p.type==="block-seq"?i(u,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in p&&p.indent!==r.indent&&i(u,"BAD_INDENT",id)),!b.anchor&&!b.tag&&!y){l=b.end,b.comment&&(c.comment?c.comment+=`
`+b.comment:c.comment=b.comment);continue}(b.hasNewlineAfterProp||Yr(p))&&i(p??d[d.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else((m=b.found)==null?void 0:m.indent)!==r.indent&&i(u,"BAD_INDENT",id);const N=b.end,$=p?e(n,p,b,i):t(n,N,d,null,b,i);n.schema.compat&&Ca(r.indent,p,i),rd(n,c.items,$)&&i(N,"DUPLICATE_KEY","Map keys must be unique");const I=ur(y??[],{indicator:"map-value-ind",next:w,offset:$.range[2],onError:i,startOnNewline:!p||p.type==="block-scalar"});if(u=I.end,I.found){P&&((w==null?void 0:w.type)==="block-map"&&!I.hasNewline&&i(u,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),n.options.strict&&b.start<I.found.offset-1024&&i($.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const _=w?e(n,w,I,i):t(n,u,y,null,I,i);n.schema.compat&&Ca(r.indent,w,i),u=_.range[2];const L=new Ke($,_);n.options.keepSourceTokens&&(L.srcToken=g),c.items.push(L)}else{P&&i($.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),I.comment&&($.comment?$.comment+=`
`+I.comment:$.comment=I.comment);const _=new Ke($);n.options.keepSourceTokens&&(_.srcToken=g),c.items.push(_)}}return l&&l<u&&i(l,"IMPOSSIBLE","Map comment with trailing content"),c.range=[r.offset,u,l??u],c}function CT({composeNode:e,composeEmptyNode:t},n,r,i,s){const a=(s==null?void 0:s.nodeClass)??Tn,c=new a(n.schema);n.atRoot&&(n.atRoot=!1);let u=r.offset,l=null;for(const{start:m,value:g}of r.items){const d=ur(m,{indicator:"seq-item-ind",next:g,offset:u,onError:i,startOnNewline:!0});if(!d.found)if(d.anchor||d.tag||g)g&&g.type==="block-seq"?i(d.end,"BAD_INDENT","All sequence items must start at the same column"):i(u,"MISSING_CHAR","Sequence item without - indicator");else{l=d.end,d.comment&&(c.comment=d.comment);continue}const p=g?e(n,g,d,i):t(n,d.end,m,null,d,i);n.schema.compat&&Ca(r.indent,g,i),u=p.range[2],c.items.push(p)}return c.range=[r.offset,u,l??u],c}function Xr(e,t,n,r){let i="";if(e){let s=!1,a="";for(const c of e){const{source:u,type:l}=c;switch(l){case"space":s=!0;break;case"comment":{n&&!s&&r(c,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const m=u.substring(1)||" ";i?i+=a+m:i=m,a="";break}case"newline":i&&(a+=u),s=!0;break;default:r(c,"UNEXPECTED_TOKEN",`Unexpected ${l} at node end`)}t+=u.length}}return{comment:i,offset:t}}const ja="Block collections are not allowed within flow collections",Ua=e=>e&&(e.type==="block-map"||e.type==="block-seq");function jT({composeNode:e,composeEmptyNode:t},n,r,i,s){const a=r.start.source==="{",c=a?"flow map":"flow sequence",u=(s==null?void 0:s.nodeClass)??(a?dt:Tn),l=new u(n.schema);l.flow=!0;const m=n.atRoot;m&&(n.atRoot=!1);let g=r.offset+r.start.source.length;for(let b=0;b<r.items.length;++b){const P=r.items[b],{start:N,key:$,sep:I,value:_}=P,L=ur(N,{flow:c,indicator:"explicit-key-ind",next:$??(I==null?void 0:I[0]),offset:g,onError:i,startOnNewline:!1});if(!L.found){if(!L.anchor&&!L.tag&&!I&&!_){b===0&&L.comma?i(L.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${c}`):b<r.items.length-1&&i(L.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${c}`),L.comment&&(l.comment?l.comment+=`
`+L.comment:l.comment=L.comment),g=L.end;continue}!a&&n.options.strict&&Yr($)&&i($,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(b===0)L.comma&&i(L.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${c}`);else if(L.comma||i(L.start,"MISSING_CHAR",`Missing , between ${c} items`),L.comment){let z="";e:for(const J of N)switch(J.type){case"comma":case"space":break;case"comment":z=J.source.substring(1);break e;default:break e}if(z){let J=l.items[l.items.length-1];we(J)&&(J=J.value??J.key),J.comment?J.comment+=`
`+z:J.comment=z,L.comment=L.comment.substring(z.length+1)}}if(!a&&!I&&!L.found){const z=_?e(n,_,L,i):t(n,L.end,I,null,L,i);l.items.push(z),g=z.range[2],Ua(_)&&i(z.range,"BLOCK_IN_FLOW",ja)}else{const z=L.end,J=$?e(n,$,L,i):t(n,z,N,null,L,i);Ua($)&&i(J.range,"BLOCK_IN_FLOW",ja);const ae=ur(I??[],{flow:c,indicator:"map-value-ind",next:_,offset:J.range[2],onError:i,startOnNewline:!1});if(ae.found){if(!a&&!L.found&&n.options.strict){if(I)for(const Ie of I){if(Ie===ae.found)break;if(Ie.type==="newline"){i(Ie,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}L.start<ae.found.offset-1024&&i(ae.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else _&&("source"in _&&_.source&&_.source[0]===":"?i(_,"MISSING_CHAR",`Missing space after : in ${c}`):i(ae.start,"MISSING_CHAR",`Missing , or : between ${c} items`));const Ye=_?e(n,_,ae,i):ae.found?t(n,ae.end,I,null,ae,i):null;Ye?Ua(_)&&i(Ye.range,"BLOCK_IN_FLOW",ja):ae.comment&&(J.comment?J.comment+=`
`+ae.comment:J.comment=ae.comment);const Et=new Ke(J,Ye);if(n.options.keepSourceTokens&&(Et.srcToken=P),a){const Ie=l;rd(n,Ie.items,J)&&i(z,"DUPLICATE_KEY","Map keys must be unique"),Ie.items.push(Et)}else{const Ie=new dt(n.schema);Ie.flow=!0,Ie.items.push(Et),l.items.push(Ie)}g=Ye?Ye.range[2]:ae.end}}const d=a?"}":"]",[p,...y]=r.end;let w=g;if(p&&p.source===d)w=p.offset+p.source.length;else{const b=c[0].toUpperCase()+c.substring(1),P=m?`${b} must end with a ${d}`:`${b} in block collection must be sufficiently indented and end with a ${d}`;i(g,m?"MISSING_CHAR":"BAD_INDENT",P),p&&p.source.length!==1&&y.unshift(p)}if(y.length>0){const b=Xr(y,w,n.options.strict,i);b.comment&&(l.comment?l.comment+=`
`+b.comment:l.comment=b.comment),l.range=[r.offset,w,b.offset]}else l.range=[r.offset,w,w];return l}function xa(e,t,n,r,i,s){const a=n.type==="block-map"?_T(e,t,n,r,s):n.type==="block-seq"?CT(e,t,n,r,s):jT(e,t,n,r,s),c=a.constructor;return i==="!"||i===c.tagName?(a.tag=c.tagName,a):(i&&(a.tag=i),a)}function UT(e,t,n,r,i){var g;const s=r?t.directives.tagName(r.source,d=>i(r,"TAG_RESOLVE_FAILED",d)):null,a=n.type==="block-map"?"map":n.type==="block-seq"?"seq":n.start.source==="{"?"map":"seq";if(!r||!s||s==="!"||s===dt.tagName&&a==="map"||s===Tn.tagName&&a==="seq"||!a)return xa(e,t,n,i,s);let c=t.schema.tags.find(d=>d.tag===s&&d.collection===a);if(!c){const d=t.schema.knownTags[s];if(d&&d.collection===a)t.schema.tags.push(Object.assign({},d,{default:!1})),c=d;else return d!=null&&d.collection?i(r,"BAD_COLLECTION_TYPE",`${d.tag} used for ${a} collection, but expects ${d.collection}`,!0):i(r,"TAG_RESOLVE_FAILED",`Unresolved tag: ${s}`,!0),xa(e,t,n,i,s)}const u=xa(e,t,n,i,s,c),l=((g=c.resolve)==null?void 0:g.call(c,u,d=>i(r,"TAG_RESOLVE_FAILED",d),t.options))??u,m=Te(l)?l:new F(l);return m.range=u.range,m.tag=s,c!=null&&c.format&&(m.format=c.format),m}function xT(e,t,n){const r=e.offset,i=MT(e,t,n);if(!i)return{value:"",type:null,comment:"",range:[r,r,r]};const s=i.mode===">"?F.BLOCK_FOLDED:F.BLOCK_LITERAL,a=e.source?FT(e.source):[];let c=a.length;for(let w=a.length-1;w>=0;--w){const b=a[w][1];if(b===""||b==="\r")c=w;else break}if(c===0){const w=i.chomp==="+"&&a.length>0?`
`.repeat(Math.max(1,a.length-1)):"";let b=r+i.length;return e.source&&(b+=e.source.length),{value:w,type:s,comment:i.comment,range:[r,b,b]}}let u=e.indent+i.indent,l=e.offset+i.length,m=0;for(let w=0;w<c;++w){const[b,P]=a[w];if(P===""||P==="\r")i.indent===0&&b.length>u&&(u=b.length);else{if(b.length<u){const N="Block scalars with more-indented leading empty lines must use an explicit indentation indicator";n(l+b.length,"MISSING_CHAR",N)}i.indent===0&&(u=b.length),m=w;break}l+=b.length+P.length+1}for(let w=a.length-1;w>=c;--w)a[w][0].length>u&&(c=w+1);let g="",d="",p=!1;for(let w=0;w<m;++w)g+=a[w][0].slice(u)+`
`;for(let w=m;w<c;++w){let[b,P]=a[w];l+=b.length+P.length+1;const N=P[P.length-1]==="\r";if(N&&(P=P.slice(0,-1)),P&&b.length<u){const I=`Block scalar lines must not be less indented than their ${i.indent?"explicit indentation indicator":"first line"}`;n(l-P.length-(N?2:1),"BAD_INDENT",I),b=""}s===F.BLOCK_LITERAL?(g+=d+b.slice(u)+P,d=`
`):b.length>u||P[0]==="	"?(d===" "?d=`
`:!p&&d===`
`&&(d=`

`),g+=d+b.slice(u)+P,d=`
`,p=!0):P===""?d===`
`?g+=`
`:d=`
`:(g+=d+P,d=" ",p=!1)}switch(i.chomp){case"-":break;case"+":for(let w=c;w<a.length;++w)g+=`
`+a[w][0].slice(u);g[g.length-1]!==`
`&&(g+=`
`);break;default:g+=`
`}const y=r+i.length+e.source.length;return{value:g,type:s,comment:i.comment,range:[r,y,y]}}function MT({offset:e,props:t},n,r){if(t[0].type!=="block-scalar-header")return r(t[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:i}=t[0],s=i[0];let a=0,c="",u=-1;for(let d=1;d<i.length;++d){const p=i[d];if(!c&&(p==="-"||p==="+"))c=p;else{const y=Number(p);!a&&y?a=y:u===-1&&(u=e+d)}}u!==-1&&r(u,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${i}`);let l=!1,m="",g=i.length;for(let d=1;d<t.length;++d){const p=t[d];switch(p.type){case"space":l=!0;case"newline":g+=p.source.length;break;case"comment":n&&!l&&r(p,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),g+=p.source.length,m=p.source.substring(1);break;case"error":r(p,"UNEXPECTED_TOKEN",p.message),g+=p.source.length;break;default:{const y=`Unexpected token in block scalar header: ${p.type}`;r(p,"UNEXPECTED_TOKEN",y);const w=p.source;w&&typeof w=="string"&&(g+=w.length)}}}return{mode:s,indent:a,chomp:c,comment:m,length:g}}function FT(e){const t=e.split(/\n( *)/),n=t[0],r=n.match(/^( *)/),s=[r!=null&&r[1]?[r[1],n.slice(r[1].length)]:["",n]];for(let a=1;a<t.length;a+=2)s.push([t[a],t[a+1]]);return s}function DT(e,t,n){const{offset:r,type:i,source:s,end:a}=e;let c,u;const l=(d,p,y)=>n(r+d,p,y);switch(i){case"scalar":c=F.PLAIN,u=BT(s,l);break;case"single-quoted-scalar":c=F.QUOTE_SINGLE,u=zT(s,l);break;case"double-quoted-scalar":c=F.QUOTE_DOUBLE,u=VT(s,l);break;default:return n(e,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${i}`),{value:"",type:null,comment:"",range:[r,r+s.length,r+s.length]}}const m=r+s.length,g=Xr(a,m,t,n);return{value:u,type:c,comment:g.comment,range:[r,m,g.offset]}}function BT(e,t){let n="";switch(e[0]){case"	":n="a tab character";break;case",":n="flow indicator character ,";break;case"%":n="directive indicator character %";break;case"|":case">":{n=`block scalar indicator ${e[0]}`;break}case"@":case"`":{n=`reserved character ${e[0]}`;break}}return n&&t(0,"BAD_SCALAR_START",`Plain value cannot start with ${n}`),sd(e)}function zT(e,t){return(e[e.length-1]!=="'"||e.length===1)&&t(e.length,"MISSING_CHAR","Missing closing 'quote"),sd(e.slice(1,-1)).replace(/''/g,"'")}function sd(e){let t,n;try{t=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),n=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{t=/(.*?)[ \t]*\r?\n/sy,n=/[ \t]*(.*?)[ \t]*\r?\n/sy}let r=t.exec(e);if(!r)return e;let i=r[1],s=" ",a=t.lastIndex;for(n.lastIndex=a;r=n.exec(e);)r[1]===""?s===`
`?i+=s:s=`
`:(i+=s+r[1],s=" "),a=n.lastIndex;const c=/[ \t]*(.*)/sy;return c.lastIndex=a,r=c.exec(e),i+s+((r==null?void 0:r[1])??"")}function VT(e,t){let n="";for(let r=1;r<e.length-1;++r){const i=e[r];if(!(i==="\r"&&e[r+1]===`
`))if(i===`
`){const{fold:s,offset:a}=qT(e,r);n+=s,r=a}else if(i==="\\"){let s=e[++r];const a=GT[s];if(a)n+=a;else if(s===`
`)for(s=e[r+1];s===" "||s==="	";)s=e[++r+1];else if(s==="\r"&&e[r+1]===`
`)for(s=e[++r+1];s===" "||s==="	";)s=e[++r+1];else if(s==="x"||s==="u"||s==="U"){const c={x:2,u:4,U:8}[s];n+=ZT(e,r+1,c,t),r+=c}else{const c=e.substr(r-1,2);t(r-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${c}`),n+=c}}else if(i===" "||i==="	"){const s=r;let a=e[r+1];for(;a===" "||a==="	";)a=e[++r+1];a!==`
`&&!(a==="\r"&&e[r+2]===`
`)&&(n+=r>s?e.slice(s,r+1):i)}else n+=i}return(e[e.length-1]!=='"'||e.length===1)&&t(e.length,"MISSING_CHAR",'Missing closing "quote'),n}function qT(e,t){let n="",r=e[t+1];for(;(r===" "||r==="	"||r===`
`||r==="\r")&&!(r==="\r"&&e[t+2]!==`
`);)r===`
`&&(n+=`
`),t+=1,r=e[t+1];return n||(n=" "),{fold:n,offset:t}}const GT={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"",_:" ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function ZT(e,t,n,r){const i=e.substr(t,n),a=i.length===n&&/^[0-9a-fA-F]+$/.test(i)?parseInt(i,16):NaN;if(isNaN(a)){const c=e.substr(t-2,n+2);return r(t-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${c}`),c}return String.fromCodePoint(a)}function od(e,t,n,r){const{value:i,type:s,comment:a,range:c}=t.type==="block-scalar"?xT(t,e.options.strict,r):DT(t,e.options.strict,r),u=n?e.directives.tagName(n.source,g=>r(n,"TAG_RESOLVE_FAILED",g)):null,l=n&&u?JT(e.schema,i,u,n,r):t.type==="scalar"?KT(e,i,t,r):e.schema[Ft];let m;try{const g=l.resolve(i,d=>r(n??t,"TAG_RESOLVE_FAILED",d),e.options);m=ie(g)?g:new F(g)}catch(g){const d=g instanceof Error?g.message:String(g);r(n??t,"TAG_RESOLVE_FAILED",d),m=new F(i)}return m.range=c,m.source=i,s&&(m.type=s),u&&(m.tag=u),l.format&&(m.format=l.format),a&&(m.comment=a),m}function JT(e,t,n,r,i){var c;if(n==="!")return e[Ft];const s=[];for(const u of e.tags)if(!u.collection&&u.tag===n)if(u.default&&u.test)s.push(u);else return u;for(const u of s)if((c=u.test)!=null&&c.test(t))return u;const a=e.knownTags[n];return a&&!a.collection?(e.tags.push(Object.assign({},a,{default:!1,test:void 0})),a):(i(r,"TAG_RESOLVE_FAILED",`Unresolved tag: ${n}`,n!=="tag:yaml.org,2002:str"),e[Ft])}function KT({directives:e,schema:t},n,r,i){const s=t.tags.find(a=>{var c;return a.default&&((c=a.test)==null?void 0:c.test(n))})||t[Ft];if(t.compat){const a=t.compat.find(c=>{var u;return c.default&&((u=c.test)==null?void 0:u.test(n))})??t[Ft];if(s.tag!==a.tag){const c=e.tagString(s.tag),u=e.tagString(a.tag),l=`Value may be parsed as either ${c} or ${u}`;i(r,"TAG_RESOLVE_FAILED",l,!0)}}return s}function WT(e,t,n){if(t){n===null&&(n=t.length);for(let r=n-1;r>=0;--r){let i=t[r];switch(i.type){case"space":case"comment":case"newline":e-=i.source.length;continue}for(i=t[++r];(i==null?void 0:i.type)==="space";)e+=i.source.length,i=t[++r];break}}return e}const HT={composeNode:ad,composeEmptyNode:Ma};function ad(e,t,n,r){const{spaceBefore:i,comment:s,anchor:a,tag:c}=n;let u,l=!0;switch(t.type){case"alias":u=YT(e,t,r),(a||c)&&r(t,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":u=od(e,t,c,r),a&&(u.anchor=a.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":u=UT(HT,e,t,c,r),a&&(u.anchor=a.source.substring(1));break;default:{const m=t.type==="error"?t.message:`Unsupported token (type: ${t.type})`;r(t,"UNEXPECTED_TOKEN",m),u=Ma(e,t.offset,void 0,null,n,r),l=!1}}return a&&u.anchor===""&&r(a,"BAD_ALIAS","Anchor cannot be an empty string"),i&&(u.spaceBefore=!0),s&&(t.type==="scalar"&&t.source===""?u.comment=s:u.commentBefore=s),e.options.keepSourceTokens&&l&&(u.srcToken=t),u}function Ma(e,t,n,r,{spaceBefore:i,comment:s,anchor:a,tag:c,end:u},l){const m={type:"scalar",offset:WT(t,n,r),indent:-1,source:""},g=od(e,m,c,l);return a&&(g.anchor=a.source.substring(1),g.anchor===""&&l(a,"BAD_ALIAS","Anchor cannot be an empty string")),i&&(g.spaceBefore=!0),s&&(g.comment=s,g.range[2]=u),g}function YT({options:e},{offset:t,source:n,end:r},i){const s=new ya(n.substring(1));s.source===""&&i(t,"BAD_ALIAS","Alias cannot be an empty string"),s.source.endsWith(":")&&i(t+n.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const a=t+n.length,c=Xr(r,a,e.strict,i);return s.range=[t,a,c.offset],c.comment&&(s.comment=c.comment),s}function XT(e,t,{offset:n,start:r,value:i,end:s},a){const c=Object.assign({_directives:t},e),u=new ks(void 0,c),l={atRoot:!0,directives:u.directives,options:u.options,schema:u.schema},m=ur(r,{indicator:"doc-start",next:i??(s==null?void 0:s[0]),offset:n,onError:a,startOnNewline:!0});m.found&&(u.directives.docStart=!0,i&&(i.type==="block-map"||i.type==="block-seq")&&!m.hasNewline&&a(m.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),u.contents=i?ad(l,i,m,a):Ma(l,m.end,r,null,m,a);const g=u.contents.range[2],d=Xr(s,g,!1,a);return d.comment&&(u.comment=d.comment),u.range=[n,g,d.offset],u}function Qr(e){if(typeof e=="number")return[e,e+1];if(Array.isArray(e))return e.length===2?e:[e[0],e[1]];const{offset:t,source:n}=e;return[t,t+(typeof n=="string"?n.length:1)]}function cd(e){var i;let t="",n=!1,r=!1;for(let s=0;s<e.length;++s){const a=e[s];switch(a[0]){case"#":t+=(t===""?"":r?`

`:`
`)+(a.substring(1)||" "),n=!0,r=!1;break;case"%":((i=e[s+1])==null?void 0:i[0])!=="#"&&(s+=1),n=!1;break;default:n||(r=!0),n=!1}}return{comment:t,afterEmptyLine:r}}class QT{constructor(t={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(n,r,i,s)=>{const a=Qr(n);s?this.warnings.push(new RT(a,r,i)):this.errors.push(new Hr(a,r,i))},this.directives=new Je({version:t.version||"1.2"}),this.options=t}decorate(t,n){const{comment:r,afterEmptyLine:i}=cd(this.prelude);if(r){const s=t.contents;if(n)t.comment=t.comment?`${t.comment}
${r}`:r;else if(i||t.directives.docStart||!s)t.commentBefore=r;else if(be(s)&&!s.flow&&s.items.length>0){let a=s.items[0];we(a)&&(a=a.key);const c=a.commentBefore;a.commentBefore=c?`${r}
${c}`:r}else{const a=s.commentBefore;s.commentBefore=a?`${r}
${a}`:r}}n?(Array.prototype.push.apply(t.errors,this.errors),Array.prototype.push.apply(t.warnings,this.warnings)):(t.errors=this.errors,t.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:cd(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(t,n=!1,r=-1){for(const i of t)yield*this.next(i);yield*this.end(n,r)}*next(t){switch(t.type){case"directive":this.directives.add(t.source,(n,r,i)=>{const s=Qr(t);s[0]+=n,this.onError(s,"BAD_DIRECTIVE",r,i)}),this.prelude.push(t.source),this.atDirectives=!0;break;case"document":{const n=XT(this.options,this.directives,t,this.onError);this.atDirectives&&!n.directives.docStart&&this.onError(t,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(n,!1),this.doc&&(yield this.doc),this.doc=n,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(t.source);break;case"error":{const n=t.source?`${t.message}: ${JSON.stringify(t.source)}`:t.message,r=new Hr(Qr(t),"UNEXPECTED_TOKEN",n);this.atDirectives||!this.doc?this.errors.push(r):this.doc.errors.push(r);break}case"doc-end":{if(!this.doc){const r="Unexpected doc-end without preceding document";this.errors.push(new Hr(Qr(t),"UNEXPECTED_TOKEN",r));break}this.doc.directives.docEnd=!0;const n=Xr(t.end,t.offset+t.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),n.comment){const r=this.doc.comment;this.doc.comment=r?`${r}
${n.comment}`:n.comment}this.doc.range[2]=n.offset;break}default:this.errors.push(new Hr(Qr(t),"UNEXPECTED_TOKEN",`Unsupported token ${t.type}`))}}*end(t=!1,n=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(t){const r=Object.assign({_directives:this.directives},this.options),i=new ks(void 0,r);this.atDirectives&&this.onError(n,"MISSING_CHAR","Missing directives-end indicator line"),i.range=[0,n,n],this.decorate(i,!1),yield i}}}const ud="\uFEFF",ld="",fd="",Fa="";function eN(e){switch(e){case ud:return"byte-order-mark";case ld:return"doc-mode";case fd:return"flow-error-end";case Fa:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(e[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}function pt(e){switch(e){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}const dd="0123456789ABCDEFabcdef".split(""),tN="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()".split(""),Da=",[]{}".split(""),nN=` ,[]{}
\r	`.split(""),Ba=e=>!e||nN.includes(e);class rN{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(t,n=!1){t&&(this.buffer=this.buffer?this.buffer+t:t,this.lineEndPos=null),this.atEnd=!n;let r=this.next??"stream";for(;r&&(n||this.hasChars(1));)r=yield*this.parseNext(r)}atLineEnd(){let t=this.pos,n=this.buffer[t];for(;n===" "||n==="	";)n=this.buffer[++t];return!n||n==="#"||n===`
`?!0:n==="\r"?this.buffer[t+1]===`
`:!1}charAt(t){return this.buffer[this.pos+t]}continueScalar(t){let n=this.buffer[t];if(this.indentNext>0){let r=0;for(;n===" ";)n=this.buffer[++r+t];if(n==="\r"){const i=this.buffer[r+t+1];if(i===`
`||!i&&!this.atEnd)return t+r+1}return n===`
`||r>=this.indentNext||!n&&!this.atEnd?t+r:-1}if(n==="-"||n==="."){const r=this.buffer.substr(t,3);if((r==="---"||r==="...")&&pt(this.buffer[t+3]))return-1}return t}getLine(){let t=this.lineEndPos;return(typeof t!="number"||t!==-1&&t<this.pos)&&(t=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=t),t===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[t-1]==="\r"&&(t-=1),this.buffer.substring(this.pos,t))}hasChars(t){return this.pos+t<=this.buffer.length}setNext(t){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=t,null}peek(t){return this.buffer.substr(this.pos,t)}*parseNext(t){switch(t){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let t=this.getLine();if(t===null)return this.setNext("stream");if(t[0]===ud&&(yield*this.pushCount(1),t=t.substring(1)),t[0]==="%"){let n=t.length;const r=t.indexOf("#");if(r!==-1){const s=t[r-1];(s===" "||s==="	")&&(n=r-1)}for(;;){const s=t[n-1];if(s===" "||s==="	")n-=1;else break}const i=(yield*this.pushCount(n))+(yield*this.pushSpaces(!0));return yield*this.pushCount(t.length-i),this.pushNewline(),"stream"}if(this.atLineEnd()){const n=yield*this.pushSpaces(!0);return yield*this.pushCount(t.length-n),yield*this.pushNewline(),"stream"}return yield ld,yield*this.parseLineStart()}*parseLineStart(){const t=this.charAt(0);if(!t&&!this.atEnd)return this.setNext("line-start");if(t==="-"||t==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const n=this.peek(3);if(n==="---"&&pt(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,"doc";if(n==="..."&&pt(this.charAt(3)))return yield*this.pushCount(3),"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!pt(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[t,n]=this.peek(2);if(!n&&!this.atEnd)return this.setNext("block-start");if((t==="-"||t==="?"||t===":")&&pt(n)){const r=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=r,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const t=this.getLine();if(t===null)return this.setNext("doc");let n=yield*this.pushIndicators();switch(t[n]){case"#":yield*this.pushCount(t.length-n);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(Ba),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return n+=yield*this.parseBlockScalarHeader(),n+=yield*this.pushSpaces(!0),yield*this.pushCount(t.length-n),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let t,n,r=-1;do t=yield*this.pushNewline(),t>0?(n=yield*this.pushSpaces(!1),this.indentValue=r=n):n=0,n+=yield*this.pushSpaces(!0);while(t+n>0);const i=this.getLine();if(i===null)return this.setNext("flow");if((r!==-1&&r<this.indentNext&&i[0]!=="#"||r===0&&(i.startsWith("---")||i.startsWith("..."))&&pt(i[3]))&&!(r===this.indentNext-1&&this.flowLevel===1&&(i[0]==="]"||i[0]==="}")))return this.flowLevel=0,yield fd,yield*this.parseLineStart();let s=0;for(;i[s]===",";)s+=yield*this.pushCount(1),s+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(s+=yield*this.pushIndicators(),i[s]){case void 0:return"flow";case"#":return yield*this.pushCount(i.length-s),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(Ba),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const a=this.charAt(1);if(this.flowKey||pt(a)||a===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const t=this.charAt(0);let n=this.buffer.indexOf(t,this.pos+1);if(t==="'")for(;n!==-1&&this.buffer[n+1]==="'";)n=this.buffer.indexOf("'",n+2);else for(;n!==-1;){let s=0;for(;this.buffer[n-1-s]==="\\";)s+=1;if(s%2===0)break;n=this.buffer.indexOf('"',n+1)}const r=this.buffer.substring(0,n);let i=r.indexOf(`
`,this.pos);if(i!==-1){for(;i!==-1;){const s=this.continueScalar(i+1);if(s===-1)break;i=r.indexOf(`
`,s)}i!==-1&&(n=i-(r[i-1]==="\r"?2:1))}if(n===-1){if(!this.atEnd)return this.setNext("quoted-scalar");n=this.buffer.length}return yield*this.pushToIndex(n+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let t=this.pos;for(;;){const n=this.buffer[++t];if(n==="+")this.blockScalarKeep=!0;else if(n>"0"&&n<="9")this.blockScalarIndent=Number(n)-1;else if(n!=="-")break}return yield*this.pushUntil(n=>pt(n)||n==="#")}*parseBlockScalar(){let t=this.pos-1,n=0,r;e:for(let i=this.pos;r=this.buffer[i];++i)switch(r){case" ":n+=1;break;case`
`:t=i,n=0;break;case"\r":{const s=this.buffer[i+1];if(!s&&!this.atEnd)return this.setNext("block-scalar");if(s===`
`)break}default:break e}if(!r&&!this.atEnd)return this.setNext("block-scalar");if(n>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=n:this.indentNext+=this.blockScalarIndent;do{const i=this.continueScalar(t+1);if(i===-1)break;t=this.buffer.indexOf(`
`,i)}while(t!==-1);if(t===-1){if(!this.atEnd)return this.setNext("block-scalar");t=this.buffer.length}}if(!this.blockScalarKeep)do{let i=t-1,s=this.buffer[i];s==="\r"&&(s=this.buffer[--i]);const a=i;for(;s===" "||s==="	";)s=this.buffer[--i];if(s===`
`&&i>=this.pos&&i+1+n>a)t=i;else break}while(!0);return yield Fa,yield*this.pushToIndex(t+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const t=this.flowLevel>0;let n=this.pos-1,r=this.pos-1,i;for(;i=this.buffer[++r];)if(i===":"){const s=this.buffer[r+1];if(pt(s)||t&&s===",")break;n=r}else if(pt(i)){let s=this.buffer[r+1];if(i==="\r"&&(s===`
`?(r+=1,i=`
`,s=this.buffer[r+1]):n=r),s==="#"||t&&Da.includes(s))break;if(i===`
`){const a=this.continueScalar(r+1);if(a===-1)break;r=Math.max(r,a-2)}}else{if(t&&Da.includes(i))break;n=r}return!i&&!this.atEnd?this.setNext("plain-scalar"):(yield Fa,yield*this.pushToIndex(n+1,!0),t?"flow":"doc")}*pushCount(t){return t>0?(yield this.buffer.substr(this.pos,t),this.pos+=t,t):0}*pushToIndex(t,n){const r=this.buffer.slice(this.pos,t);return r?(yield r,this.pos+=r.length,r.length):(n&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(Ba))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const t=this.flowLevel>0,n=this.charAt(1);if(pt(n)||t&&Da.includes(n))return t?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let t=this.pos+2,n=this.buffer[t];for(;!pt(n)&&n!==">";)n=this.buffer[++t];return yield*this.pushToIndex(n===">"?t+1:t,!1)}else{let t=this.pos+1,n=this.buffer[t];for(;n;)if(tN.includes(n))n=this.buffer[++t];else if(n==="%"&&dd.includes(this.buffer[t+1])&&dd.includes(this.buffer[t+2]))n=this.buffer[t+=3];else break;return yield*this.pushToIndex(t,!1)}}*pushNewline(){const t=this.buffer[this.pos];return t===`
`?yield*this.pushCount(1):t==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(t){let n=this.pos-1,r;do r=this.buffer[++n];while(r===" "||t&&r==="	");const i=n-this.pos;return i>0&&(yield this.buffer.substr(this.pos,i),this.pos=n),i}*pushUntil(t){let n=this.pos,r=this.buffer[n];for(;!t(r);)r=this.buffer[++n];return yield*this.pushToIndex(n,!1)}}class iN{constructor(){this.lineStarts=[],this.addNewLine=t=>this.lineStarts.push(t),this.linePos=t=>{let n=0,r=this.lineStarts.length;for(;n<r;){const s=n+r>>1;this.lineStarts[s]<t?n=s+1:r=s}if(this.lineStarts[n]===t)return{line:n+1,col:1};if(n===0)return{line:0,col:t};const i=this.lineStarts[n-1];return{line:n,col:t-i+1}}}}function It(e,t){for(let n=0;n<e.length;++n)if(e[n].type===t)return!0;return!1}function pd(e){for(let t=0;t<e.length;++t)switch(e[t].type){case"space":case"comment":case"newline":break;default:return t}return-1}function hd(e){switch(e==null?void 0:e.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function Os(e){switch(e.type){case"document":return e.start;case"block-map":{const t=e.items[e.items.length-1];return t.sep??t.start}case"block-seq":return e.items[e.items.length-1].start;default:return[]}}function lr(e){var n;if(e.length===0)return[];let t=e.length;e:for(;--t>=0;)switch(e[t].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;((n=e[++t])==null?void 0:n.type)==="space";);return e.splice(t,e.length)}function md(e){if(e.start.type==="flow-seq-start")for(const t of e.items)t.sep&&!t.value&&!It(t.start,"explicit-key-ind")&&!It(t.sep,"map-value-ind")&&(t.key&&(t.value=t.key),delete t.key,hd(t.value)?t.value.end?Array.prototype.push.apply(t.value.end,t.sep):t.value.end=t.sep:Array.prototype.push.apply(t.start,t.sep),delete t.sep)}class sN{constructor(t){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new rN,this.onNewLine=t}*parse(t,n=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const r of this.lexer.lex(t,n))yield*this.next(r);n||(yield*this.end())}*next(t){if(this.source=t,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=t.length;return}const n=eN(t);if(n)if(n==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=n,yield*this.step(),n){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+t.length);break;case"space":this.atNewLine&&t[0]===" "&&(this.indent+=t.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=t.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=t.length}else{const r=`Not a YAML token: ${t}`;yield*this.pop({type:"error",offset:this.offset,message:r,source:t}),this.offset+=t.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const t=this.peek(1);if(this.type==="doc-end"&&(!t||t.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!t)return yield*this.stream();switch(t.type){case"document":return yield*this.document(t);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(t);case"block-scalar":return yield*this.blockScalar(t);case"block-map":return yield*this.blockMap(t);case"block-seq":return yield*this.blockSequence(t);case"flow-collection":return yield*this.flowCollection(t);case"doc-end":return yield*this.documentEnd(t)}yield*this.pop()}peek(t){return this.stack[this.stack.length-t]}*pop(t){const n=t??this.stack.pop();if(n)if(this.stack.length===0)yield n;else{const r=this.peek(1);switch(n.type==="block-scalar"?n.indent="indent"in r?r.indent:0:n.type==="flow-collection"&&r.type==="document"&&(n.indent=0),n.type==="flow-collection"&&md(n),r.type){case"document":r.value=n;break;case"block-scalar":r.props.push(n);break;case"block-map":{const i=r.items[r.items.length-1];if(i.value){r.items.push({start:[],key:n,sep:[]}),this.onKeyLine=!0;return}else if(i.sep)i.value=n;else{Object.assign(i,{key:n,sep:[]}),this.onKeyLine=!It(i.start,"explicit-key-ind");return}break}case"block-seq":{const i=r.items[r.items.length-1];i.value?r.items.push({start:[],value:n}):i.value=n;break}case"flow-collection":{const i=r.items[r.items.length-1];!i||i.value?r.items.push({start:[],key:n,sep:[]}):i.sep?i.value=n:Object.assign(i,{key:n,sep:[]});return}default:yield*this.pop(),yield*this.pop(n)}if((r.type==="document"||r.type==="block-map"||r.type==="block-seq")&&(n.type==="block-map"||n.type==="block-seq")){const i=n.items[n.items.length-1];i&&!i.sep&&!i.value&&i.start.length>0&&pd(i.start)===-1&&(n.indent===0||i.start.every(s=>s.type!=="comment"||s.indent<n.indent))&&(r.type==="document"?r.end=i.start:r.items.push({start:i.start}),n.items.splice(-1,1))}}else{const r="Tried to pop an empty stack";yield{type:"error",offset:this.offset,source:"",message:r}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const t={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&t.start.push(this.sourceToken),this.stack.push(t);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(t){if(t.value)return yield*this.lineEnd(t);switch(this.type){case"doc-start":{pd(t.start)!==-1?(yield*this.pop(),yield*this.step()):t.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":t.start.push(this.sourceToken);return}const n=this.startBlockValue(t);n?this.stack.push(n):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(t){if(this.type==="map-value-ind"){const n=Os(this.peek(2)),r=lr(n);let i;t.end?(i=t.end,i.push(this.sourceToken),delete t.end):i=[this.sourceToken];const s={type:"block-map",offset:t.offset,indent:t.indent,items:[{start:r,key:t,sep:i}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=s}else yield*this.lineEnd(t)}*blockScalar(t){switch(this.type){case"space":case"comment":case"newline":t.props.push(this.sourceToken);return;case"scalar":if(t.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(t){var r;const n=t.items[t.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,n.value){const i="end"in n.value?n.value.end:void 0,s=Array.isArray(i)?i[i.length-1]:void 0;(s==null?void 0:s.type)==="comment"?i==null||i.push(this.sourceToken):t.items.push({start:[this.sourceToken]})}else n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)t.items.push({start:[this.sourceToken]});else if(n.sep)n.sep.push(this.sourceToken);else{if(this.atIndentedComment(n.start,t.indent)){const i=t.items[t.items.length-2],s=(r=i==null?void 0:i.value)==null?void 0:r.end;if(Array.isArray(s)){Array.prototype.push.apply(s,n.start),s.push(this.sourceToken),t.items.pop();return}}n.start.push(this.sourceToken)}return}if(this.indent>=t.indent){const i=!this.onKeyLine&&this.indent===t.indent&&n.sep;let s=[];if(i&&n.sep&&!n.value){const a=[];for(let c=0;c<n.sep.length;++c){const u=n.sep[c];switch(u.type){case"newline":a.push(c);break;case"space":break;case"comment":u.indent>t.indent&&(a.length=0);break;default:a.length=0}}a.length>=2&&(s=n.sep.splice(a[1]))}switch(this.type){case"anchor":case"tag":i||n.value?(s.push(this.sourceToken),t.items.push({start:s}),this.onKeyLine=!0):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"explicit-key-ind":!n.sep&&!It(n.start,"explicit-key-ind")?n.start.push(this.sourceToken):i||n.value?(s.push(this.sourceToken),t.items.push({start:s})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]}),this.onKeyLine=!0;return;case"map-value-ind":if(It(n.start,"explicit-key-ind"))if(n.sep)if(n.value)t.items.push({start:[],key:null,sep:[this.sourceToken]});else if(It(n.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,key:null,sep:[this.sourceToken]}]});else if(hd(n.key)&&!It(n.sep,"newline")){const a=lr(n.start),c=n.key,u=n.sep;u.push(this.sourceToken),delete n.key,delete n.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:c,sep:u}]})}else s.length>0?n.sep=n.sep.concat(s,this.sourceToken):n.sep.push(this.sourceToken);else if(It(n.start,"newline"))Object.assign(n,{key:null,sep:[this.sourceToken]});else{const a=lr(n.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:null,sep:[this.sourceToken]}]})}else n.sep?n.value||i?t.items.push({start:s,key:null,sep:[this.sourceToken]}):It(n.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const a=this.flowScalar(this.type);i||n.value?(t.items.push({start:s,key:a,sep:[]}),this.onKeyLine=!0):n.sep?this.stack.push(a):(Object.assign(n,{key:a,sep:[]}),this.onKeyLine=!0);return}default:{const a=this.startBlockValue(t);if(a){i&&a.type!=="block-seq"&&It(n.start,"explicit-key-ind")&&t.items.push({start:s}),this.stack.push(a);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(t){var r;const n=t.items[t.items.length-1];switch(this.type){case"newline":if(n.value){const i="end"in n.value?n.value.end:void 0,s=Array.isArray(i)?i[i.length-1]:void 0;(s==null?void 0:s.type)==="comment"?i==null||i.push(this.sourceToken):t.items.push({start:[this.sourceToken]})}else n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)t.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(n.start,t.indent)){const i=t.items[t.items.length-2],s=(r=i==null?void 0:i.value)==null?void 0:r.end;if(Array.isArray(s)){Array.prototype.push.apply(s,n.start),s.push(this.sourceToken),t.items.pop();return}}n.start.push(this.sourceToken)}return;case"anchor":case"tag":if(n.value||this.indent<=t.indent)break;n.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==t.indent)break;n.value||It(n.start,"seq-item-ind")?t.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return}if(this.indent>t.indent){const i=this.startBlockValue(t);if(i){this.stack.push(i);return}}yield*this.pop(),yield*this.step()}*flowCollection(t){const n=t.items[t.items.length-1];if(this.type==="flow-error-end"){let r;do yield*this.pop(),r=this.peek(1);while(r&&r.type==="flow-collection")}else if(t.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!n||n.sep?t.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return;case"map-value-ind":!n||n.value?t.items.push({start:[],key:null,sep:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!n||n.value?t.items.push({start:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const i=this.flowScalar(this.type);!n||n.value?t.items.push({start:[],key:i,sep:[]}):n.sep?this.stack.push(i):Object.assign(n,{key:i,sep:[]});return}case"flow-map-end":case"flow-seq-end":t.end.push(this.sourceToken);return}const r=this.startBlockValue(t);r?this.stack.push(r):(yield*this.pop(),yield*this.step())}else{const r=this.peek(2);if(r.type==="block-map"&&(this.type==="map-value-ind"&&r.indent===t.indent||this.type==="newline"&&!r.items[r.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&r.type!=="flow-collection"){const i=Os(r),s=lr(i);md(t);const a=t.end.splice(1,t.end.length);a.push(this.sourceToken);const c={type:"block-map",offset:t.offset,indent:t.indent,items:[{start:s,key:t,sep:a}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=c}else yield*this.lineEnd(t)}}flowScalar(t){if(this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}return{type:t,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(t){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const n=Os(t),r=lr(n);return r.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r}]}}case"map-value-ind":{this.onKeyLine=!0;const n=Os(t),r=lr(n);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(t,n){return this.type!=="comment"||this.indent<=n?!1:t.every(r=>r.type==="newline"||r.type==="space")}*documentEnd(t){this.type!=="doc-mode"&&(t.end?t.end.push(this.sourceToken):t.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(t){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:t.end?t.end.push(this.sourceToken):t.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function oN(e){const t=e.prettyErrors!==!1;return{lineCounter:e.lineCounter||t&&new iN||null,prettyErrors:t}}function aN(e,t={}){const{lineCounter:n,prettyErrors:r}=oN(t),i=new sN(n==null?void 0:n.addNewLine),s=new QT(t);let a=null;for(const c of s.compose(i.parse(e),!0,e.length))if(!a)a=c;else if(a.options.logLevel!=="silent"){a.errors.push(new Hr(c.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return r&&n&&(a.errors.forEach(nd(e,n)),a.warnings.forEach(nd(e,n))),a}function cN(e,t,n){let r;typeof t=="function"?r=t:n===void 0&&t&&typeof t=="object"&&(n=t);const i=aN(e,n);if(!i)return null;if(i.warnings.forEach(s=>Rf(i.options.logLevel,s)),i.errors.length>0){if(i.options.logLevel!=="silent")throw i.errors[0];i.errors=[]}return i.toJS(Object.assign({reviver:r},n))}class uN extends U{constructor(n){super(n,YE);h(this,"getLockdownDownloadUrl",async(n,r)=>{var i,s,a;try{const c=await fetch(`${this.config.lockdown.origin}/${this.config.lockdown.channel}${n.startsWith("mac")?"-mac":""}.yml`);if(c.ok){const u=await c.text();if(typeof u=="string"){const l=cN(u);if(this.schemaValidators.lockdownDownloadPath.validate(l)){let m=l.path;return n==="mac-arm"?m=((i=l.files.find(({url:g})=>g.endsWith("arm64.dmg")))==null?void 0:i.url)??m:n==="mac"?m=((s=l.files.find(({url:g})=>!g.endsWith("arm64.dmg")&&g.endsWith(".dmg")))==null?void 0:s.url)??m:m=((a=l.files.find(({url:g})=>g.endsWith(`.${r??"exe"}`)))==null?void 0:a.url)??m,`${this.config.lockdown.cdnBaseUrl}/${encodeURIComponent(m)}`}}}}catch(c){if(c instanceof Error)throw new f(c)}throw new f});h(this,"requestProctoringSessionRecordingDownload",async(n,r,i)=>{try{const s=await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/recording/download-request/${n}/${r}/${i}`,{method:"POST",credentials:"include"});if(s.ok){const a=await s.json();if(this.schemaValidators.requestProctoringSessionDownloadResponse.validate(a))return a;throw new Error(`Invalid shape of response: ${JSON.stringify(a)}`)}throw new Error(`Invalid response, ${s.status}`)}catch(s){if(s instanceof Error)throw new f(s)}throw new f})}}const Nn=o.Union([o.Literal("off"),o.Literal("normal"),o.Literal("strict")]),lN=o.Object({enforceLockdown:o.Boolean(),enforceMobile:o.Boolean(),isExtension:o.Boolean(),isLockdown:o.Boolean(),isMobile:o.Boolean(),videoRecordingMode:Nn,audioRecordingMode:Nn,recordScreen:o.Boolean(),recordWebTraffic:o.Boolean(),excludedWebTrafficRecordingUrls:A(o.Array(o.String())),recordClipboard:o.Boolean(),recordInput:o.Boolean(),oneScreenEnforcementMode:Nn,disableNewTab:o.Boolean(),closeOpenTabs:o.Boolean(),tabWhiteList:A(o.Array(o.String())),tabBlockList:A(o.Array(o.String())),keyboardShortcutBlockList:A(o.Array(o.String())),disableClipboardMode:o.Union([o.Literal("off"),o.Literal("tab"),o.Literal("system")]),disableSpellcheck:o.Boolean(),disablePrinting:o.Boolean(),disableRightClick:o.Boolean(),disableDownloadFiles:o.Boolean(),hideOtherWindows:o.Boolean(),showRecordingPanel:o.Boolean(),idVerification:o.Boolean(),idVerificationEnableAi:o.Boolean(),faceTrackingMode:Nn,objectDetectionMode:Nn,applicationBlockMode:Nn,applicationBlockList:A(o.Array(o.String())),blockVirtualMachines:o.Boolean(),isLiveProctored:o.Boolean(),isLivePopIn:o.Boolean(),enablePostReview:o.Boolean(),scanRoom:o.Boolean(),quietEnvironment:o.Boolean(),enableCalculator:o.Union([o.Literal("off"),o.Literal("scientific"),o.Literal("standard")]),enableWhiteboard:o.Boolean(),uploadScratchNotes:o.Boolean(),idVerificationMode:Nn,restrictDevices:o.Boolean()}),fN=new v(o.Object({...lN.properties,enabled:o.Boolean(),password:A(o.String()),thirdPartyAssessmentOptions:A(o.Object({thirdPartyUrl:A(o.String()),password:A(o.String()),thirdPartyPlatformId:A(o.Number())}))})),dN=new v(o.Array(o.Object({id:o.Number(),name:o.String(),processName:o.Array(o.String()),iconSvg:o.String(),type:o.Union([o.Literal("Browser"),o.Literal("Communication"),o.Literal("Screen Sharing"),o.Literal("Other")]),createdAt:o.String(),updatedAt:o.String()}))),pN={verityOptions:fN,applicationResponse:dN};class hN extends U{constructor(n){super(n,pN);h(this,"get",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/options/${n==null?void 0:n.lms}/${n.hostname}/${n.courseId??""}/${n.quizId}`,{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.verityOptions.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"save",async({quizInfo:n,courseInfo:r,options:i,ignore:s,standaloneOptions:a})=>{try{if((await super.fetch(`${this.config.verityOrigin}/api/verity/quiz/options/${n==null?void 0:n.lms}/${n.hostname}/${n.courseId??""}/${n.quizId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quizInfo:n,courseInfo:r,verityOptions:i,ignore:s,standaloneOptions:a}),credentials:"include"})).ok)return}catch(c){if(c instanceof Error)throw new f(c)}throw new f});h(this,"getAllApplications",async()=>{try{const n=await super.fetch(`${this.config.verityOrigin}/api/verity/applications/all`,{credentials:"include"});if(n.ok){const r=await n.json();if(this.schemaValidators.applicationResponse.validate(r))return r.map(s=>({id:s.id,name:s.name,processName:s.processName,iconSvg:s.iconSvg,type:s.type}))}}catch(n){if(n instanceof Error)throw new f(n)}throw new f})}}const Ln=o.Union([o.Literal("off"),o.Literal("normal"),o.Literal("strict")]),mN=o.Union([o.Literal("institute"),o.Literal("course"),o.Literal("user"),o.Literal("assessment")]);function Bt(e){return o.Optional(o.Union([o.Null(),e]))}const za=o.Object({enforceLockdown:o.Boolean(),enforceMobile:o.Boolean(),isExtension:o.Boolean(),isLockdown:o.Boolean(),isMobile:o.Boolean(),videoRecordingMode:Ln,audioRecordingMode:Ln,recordScreen:o.Boolean(),recordWebTraffic:o.Boolean(),excludedWebTrafficRecordingUrls:Bt(o.Array(o.String())),recordClipboard:o.Boolean(),recordInput:o.Boolean(),oneScreenEnforcementMode:Ln,disableNewTab:o.Boolean(),closeOpenTabs:o.Boolean(),tabWhiteList:Bt(o.Array(o.String())),tabBlockList:Bt(o.Array(o.String())),keyboardShortcutBlockList:Bt(o.Array(o.String())),disableClipboardMode:o.Union([o.Literal("off"),o.Literal("tab"),o.Literal("system")]),disableSpellcheck:o.Boolean(),disablePrinting:o.Boolean(),disableRightClick:o.Boolean(),disableDownloadFiles:o.Boolean(),hideOtherWindows:o.Boolean(),showRecordingPanel:o.Boolean(),idVerification:o.Boolean(),idVerificationEnableAi:o.Boolean(),faceTrackingMode:Ln,objectDetectionMode:Ln,applicationBlockMode:Ln,blockWindowedApplications:o.Boolean(),applicationBlockList:Bt(o.Array(o.String())),allowedApplicationsList:Bt(o.Array(o.String())),blockVirtualMachines:o.Boolean(),scanRoom:o.Boolean(),quietEnvironment:o.Boolean(),enableCalculator:o.Union([o.Literal("off"),o.Literal("scientific"),o.Literal("standard")]),enableWhiteboard:o.Boolean(),uploadScratchNotes:o.Boolean(),idVerificationMode:Ln,restrictDevices:o.Boolean()}),ei=o.Object({id:o.Number(),name:o.Union([o.Null(),o.String()]),type:mN,proctoringOption:o.Object({...za.properties}),instituteProfile:Bt(o.Object({id:o.Number(),enforced:o.Boolean(),instituteId:o.Number(),proctoringOptionProfileId:o.Number()})),courseProfile:Bt(o.Object({id:o.Number(),courseId:o.Number(),proctoringOptionProfileId:o.Number()})),userProfile:Bt(o.Object({id:o.Number(),userId:o.Number(),proctoringOptionProfileId:o.Number()}))}),gN=new v(o.Array(ei)),yN=new v(o.Object({enforced:o.Boolean()})),wN={profile:new v(ei),profileOrNull:new v(o.Union([o.Null(),ei])),profiles:gN,enforced:yN,proctoringOption:new v(za)},bN=new v(o.Object({id:o.Integer(),uuid:o.String(),name:o.String(),origin:o.String()})),vN=new v(o.Object({language:o.String()})),SN=new v(o.Object({allowLiveProctoring:o.Boolean(),liveProctoringResetableCredits:A(o.Number()),liveProctoringCreditsResetDate:A(o.String()),liveProctoringOneTimeCredits:o.Number(),allowLivePopIn:o.Boolean(),livePopInResetableCredits:A(o.Number()),livePopInCreditsResetDate:A(o.String()),livePopInOneTimeCredits:o.Number(),allowLivePopInPostReview:o.Boolean(),allowStandaloneMode:o.Boolean(),allowAiStrictMode:o.Boolean(),allowDemoMode:o.Boolean(),allowExtensionPlatform:o.Boolean(),allowLockdownPlatform:o.Boolean(),allowMobilePlatform:o.Boolean(),showAllAssessments:o.Boolean()})),kN=new v(o.Object({integrated:o.Boolean()})),ON=new v(o.Object({"CourseSetting-allowStopRecording":o.Boolean(),"InstituteSetting-allowStopRecording":o.Boolean(),"CourseEmailSetting-courseEmailSetting":o.Boolean(),"InstituteEmailSetting-instituteEmailSetting":o.Boolean(),"Info-instituteEmailCount":o.String()})),IN=new v(o.Array(o.String())),$N=new v(o.Object({allowStrictMode:o.Boolean(),allowAiStrictMode:o.Boolean()})),EN=new v(o.Array(o.Object({id:o.Integer(),accountName:o.String(),lmsAccountId:o.String(),parentLmsAccountId:A(o.String()),rootLmsAccountId:A(o.String()),lmsAccountState:A(o.String()),verityEnabled:o.Boolean()}))),TN=new v(o.Object({scopeMode:o.Union([o.Literal("allCourses"),o.Literal("selectedAccounts"),o.Literal("selectedCourses")]),allAccounts:o.Array(o.Object({id:o.Integer(),accountName:o.String(),lmsAccountId:o.String(),parentLmsAccountId:A(o.String()),verityEnabled:o.Boolean()})),selectedCourses:o.Array(o.Object({id:o.Integer(),courseId:o.String(),courseName:o.String(),courseUrl:o.String()}))})),NN=new v(o.Object({suffix:o.Union([o.String(),o.Null()])})),LN=new v(o.KeyOf(ei.properties.proctoringOption)),AN=new v(o.Object({id:o.Number()})),PN=new v(o.Object({id:o.String(),name:A(o.String()),origin:A(o.String()),platform:A(o.String()),hostnames:o.Array(o.String())})),gd=new v(o.Object({id:o.Number(),keyId:A(o.String()),platform:A(o.String()),origin:A(o.String()),apiUrl:A(o.String())})),RN=new v(o.Object({selectedPlatforms:o.Array(o.Object({platformId:o.Number(),platformName:o.String()})),unselectedPlatforms:o.Array(o.Object({platformId:o.Number(),platformName:o.String()}))})),_N=new v(o.Object({verityEnabled:o.Boolean()})),CN=new v(o.Object({apiKeys:o.Array(gd.schema)})),jN=new v(o.Object({hostnames:o.Array(o.String())})),UN=new v(RN.schema),xN=new v(o.Array(o.Object({userId:o.Integer(),accommodationNotes:A(o.String()),proctoringOptionProfileId:A(o.Integer())}))),MN=o.Intersect([o.Union([o.Object({scope:o.Literal("global")}),o.Object({scope:o.Literal("lmsProvidedCourseId"),scopeValue:o.String()}),o.Object({scope:o.Literal("courseNamePrefix"),scopeValue:o.String()})]),o.Object({type:o.Literal("editConfiguration"),details:A(o.Unknown()),enabled:o.Boolean()})]),FN=new v(o.Array(MN)),DN=new v(o.Object({hours:o.Number()})),BN={instituteInfo:bN,verityInstituteSettings:SN,integrated:kN,CourseSettings:ON,instituteLanguage:vN,instituteDisabledProctoringOptions:IN,instituteAllowStrictMode:$N,instituteScopeMode:TN,lmsAccounts:EN,instituteSuffix:NN,proctoringOptionKey:LN,instituteId:AN,accessControlInstitute:PN,apiKey:gd,apiKeys:CN,verityEnabled:_N,hostnames:jN,thirdPartyIntegrations:UN,instituteProctoringAccommodation:xN,rulesResponse:FN,usageHours:DN};let zN=class extends U{constructor(n){super(n,BN);h(this,"get",async n=>{try{if(!Number.isInteger(n))throw new Error(`Invalid instituteId: ${n}`);const r=await super.fetch(new URL(`/api/verity/institute/${n}`,this.config.verityOrigin),{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.instituteInfo.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"isIntegrated",async n=>{try{const r=await super.fetch(new URL(`/api/verity/institute/hostname/${n}`,this.config.verityOrigin),{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.integrated.validate(i))return i.integrated}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getLanguage",async()=>{try{const n=await super.fetch(new URL("/api/verity/institute/language",this.config.verityOrigin),{credentials:"include"});if(n.ok){const r=await n.json();if(this.schemaValidators.instituteLanguage.validate(r))return r.language}else if(n.status===404)return Promise.resolve("en")}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"isLiveEnabled",async()=>{try{const n=await super.fetch(new URL("/api/verity/v1/verity/settings",this.config.verityOrigin),{credentials:"include"});if(n.ok){const r=await n.json();if(this.schemaValidators.verityInstituteSettings.validate(r))return r.allowLiveProctoring}}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"getSettings",async()=>{try{const n=await super.fetch(new URL("/api/verity/v1/verity/settings",this.config.verityOrigin),{credentials:"include"});if(n.ok){const r=await n.json();if(this.schemaValidators.verityInstituteSettings.validate(r))return r}}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"getCourseSetting",async n=>{try{const r=await super.fetch(new URL(`/api/verity/portal/settings?lmsCourseId=${n}`,this.config.verityOrigin),{credentials:"include"});if(r.ok){const i=await r.json();if(i["CourseSetting-allowStopRecording"]=(i==null?void 0:i["CourseSetting-allowStopRecording"])==="true",i["InstituteSetting-allowStopRecording"]=(i==null?void 0:i["InstituteSetting-allowStopRecording"])==="true",i["CourseEmailSetting-courseEmailSetting"]=(i==null?void 0:i["CourseEmailSetting-courseEmailSetting"])==="true",i["InstituteEmailSetting-instituteEmailSetting"]=(i==null?void 0:i["InstituteEmailSetting-instituteEmailSetting"])==="true",this.schemaValidators.CourseSettings.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"uploadInstituteAgreement",async({instituteId:n,fileName:r,extension:i,file:s,deleteFile:a})=>{try{return await super.fetch(`/api/verity/agreement/${n}/${r}.${i}${a?"?delete=true":""}`,{method:"PUT",credentials:"include",body:s})}catch(c){if(c instanceof Error)throw new f(c)}throw new f});h(this,"deleteInstituteAgreement",async({instituteId:n})=>{try{return await super.fetch(`/api/verity/agreement/${n}/delete`,{method:"PUT",credentials:"include"})}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getInstituteDisabledProctoringOptions",async()=>{try{const n=await super.fetch(new URL("/api/verity/institute-settings/disabled-options",this.config.verityOrigin),{credentials:"include"});if(n.ok){const r=await n.json();if(this.schemaValidators.instituteDisabledProctoringOptions.validate(r)){const i=[];return r.forEach(s=>this.schemaValidators.proctoringOptionKey.validate(s)&&i.push(s)),i}}}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"saveInstituteDisabledProctoringOptions",async n=>{try{const r=await super.fetch(new URL("/api/verity/institute-settings/disabled-options",this.config.verityOrigin),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({disabledProctoringOptions:n}),credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.instituteDisabledProctoringOptions.validate(i)){const s=[];return i.forEach(a=>this.schemaValidators.proctoringOptionKey.validate(a)&&s.push(a)),s}}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getInstituteThirdPartyPlatforms",async()=>{try{const n=await super.fetch(new URL("/api/verity/institute-settings/third-party-integrations",this.config.verityOrigin),{credentials:"include"});if(n.ok){const r=await n.json(),i=new Map,s=new Map;return this.schemaValidators.thirdPartyIntegrations.validate(r)&&(r.selectedPlatforms.forEach(a=>{i.set(a.platformId,a)}),r.unselectedPlatforms.forEach(a=>{s.set(a.platformId,a)})),{selectedPlatformRoster:i,unselectedPlatformRoster:s}}}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"saveInstituteThirdPartyPlatforms",async n=>{try{if(!n)return{ok:!1,reason:"Failed to save third party integrations."};const r=Array.from(n.selectedPlatformRoster.values()).map(c=>({platformId:c.platformId,platformName:c.platformName})),s={unselectedPlatforms:Array.from(n.unselectedPlatformRoster.values()).map(c=>({platformId:c.platformId,platformName:c.platformName})),selectedPlatforms:r};if((await super.fetch(new URL("/api/verity/institute-settings/third-party-integrations",this.config.verityOrigin),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({thirdPartyPlatformRosters:s}),credentials:"include"})).ok)return{ok:!0}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getInstituteAllowStrictMode",async()=>{try{const n=await super.fetch(new URL("/api/verity/institute-settings/allow-strict-mode",this.config.verityOrigin),{credentials:"include"});if(n.ok){const r=await n.json();if(this.schemaValidators.instituteAllowStrictMode.validate(r))return r}}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"saveInstituteAllowStrictMode",async n=>{try{const r=await super.fetch(new URL("/api/verity/institute-settings/allow-strict-mode",this.config.verityOrigin),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({allowStrictMode:n}),credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.instituteAllowStrictMode.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getInstituteScopeSettings",async()=>{try{const n=await super.fetch(new URL("/api/verity/institute-settings/scope-mode",this.config.verityOrigin),{credentials:"include"});if(n.ok){const r=await n.json();if(this.schemaValidators.instituteScopeMode.validate(r))return r}}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"saveInstituteScopeSettings",async n=>{try{if((await super.fetch(new URL("/api/verity/institute-settings/scope-mode",this.config.verityOrigin),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scopeSettingsData:n}),credentials:"include"})).ok)return}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getInstituteRules",async n=>Ee(super.fetch(new URL(`/api/verity/rule/${n}`,this.config.verityOrigin),{credentials:"include"}),this.schemaValidators.rulesResponse));h(this,"updateInstituteRules",async({instituteUuid:n,...r})=>tt(super.fetch(new URL(`/api/verity/rule/${n}`,this.config.verityOrigin),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r)})));h(this,"syncLmsAccounts",async()=>{try{if((await super.fetch(new URL("/api/verity/institute-settings/sync-accounts",this.config.verityOrigin),{credentials:"include"})).ok)return}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"getInstituteIdFromUuid",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/institute/uuid:${n}`,{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.instituteId.validate(i))return i.id}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getAccessControlInfo",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/access-control/institute/${n}`,{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.accessControlInstitute.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"updateAccessControlInfo",async({instituteUuid:n,origin:r})=>{try{const i=await super.fetch(`${this.config.verityOrigin}/api/access-control/institute/${n}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({origin:r}),credentials:"include"});if(i.ok){const s=await i.json();if(this.schemaValidators.accessControlInstitute.validate(s))return s}}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"getApiKeys",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/access-control/institute/${n}/api-key`,{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.apiKeys.validate(i))return i.apiKeys}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"createApiKey",async({instituteUuid:n,keyId:r,keyValue:i,platform:s,origin:a,apiUrl:c})=>{try{const u=await super.fetch(`${this.config.verityOrigin}/api/access-control/institute/${n}/api-key`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keyId:r,keyValue:i,platform:s,origin:a,apiUrl:c}),credentials:"include"});if(u.ok)return;throw new Error(`${u.status} - ${u.statusText}`)}catch(u){if(u instanceof Error)throw new f(u)}throw new f});h(this,"updateApiKey",async({instituteUuid:n,id:r,platform:i,origin:s,apiUrl:a})=>{try{const c=await super.fetch(`${this.config.verityOrigin}/api/access-control/institute/${n}/api-key/${r}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:i,origin:s,apiUrl:a}),credentials:"include"});if(c.ok){const u=await c.json();if(this.schemaValidators.apiKey.validate(u))return u}}catch(c){if(c instanceof Error)throw new f(c)}throw new f});h(this,"deleteApiKey",async({instituteUuid:n,id:r})=>{try{const i=await super.fetch(`${this.config.verityOrigin}/api/access-control/institute/${n}/api-key/${r}`,{method:"DELETE",credentials:"include"});if(i.ok)return;throw new Error(`${i.status} - ${i.statusText}`)}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"logInstituteUpdate",async({type:n,payload:r,details:i,timestamp:s})=>{try{await super.fetch(`${this.config.verityOrigin}/api/verity/debug/institute`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({details:{type:n,payload:r,...i},timestamp:s})});return}catch(a){if(a instanceof Error)throw new f(a)}throw new f});h(this,"getSuffix",async()=>{try{const n=await super.fetch(new URL("/api/verity/institute-settings/suffix",this.config.verityOrigin),{credentials:"include"});if(n.ok){const r=await n.json();if(this.schemaValidators.instituteSuffix.validate(r))return r.suffix}}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"saveSuffix",async n=>{try{const r=await super.fetch(new URL("/api/verity/institute-settings/suffix",this.config.verityOrigin),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({suffix:n}),credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.instituteSuffix.validate(i))return i.suffix}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"isVerityEnabled",async n=>(await Ee(super.fetch(new URL(`/api/verity/institute-settings/is-verity-enabled/${n}`,this.config.verityOrigin),{credentials:"include"}),this.schemaValidators.verityEnabled)).verityEnabled);h(this,"getLiveProctoringUsage",async n=>(await Ee(super.fetch(new URL(`/api/verity/usage/live-proctoring?instituteId=${n}`,this.config.verityOrigin),{credentials:"include"}),this.schemaValidators.usageHours)).hours);h(this,"getLivePopInUsage",async n=>(await Ee(super.fetch(new URL(`/api/verity/usage/live-pop-in?instituteId=${n}`,this.config.verityOrigin),{credentials:"include"}),this.schemaValidators.usageHours)).hours);h(this,"getHostnames",async({instituteUuid:n})=>{try{const r=await super.fetch(new URL(`/api/access-control/institute/${n}/hostname`,this.config.verityOrigin),{credentials:"include"});if(!r.ok)throw new f(Error(`Invalid response: ${r.statusText}`));const i=await r.json();if(!this.schemaValidators.hostnames.validate(i))throw new f(Error(`Invalid object: ${JSON.stringify(i)}`));return i}catch(r){throw new f(Error(`Caught Error: ${String(r)}`))}});h(this,"addHostname",async({instituteUuid:n,hostname:r})=>{try{const i=await super.fetch(new URL(`/api/access-control/institute/${n}/hostname/${r}`,this.config.verityOrigin),{method:"POST",credentials:"include"});if(!i.ok)throw new f(Error(`Invalid response: ${i.statusText}`));return r}catch(i){throw new f(Error(`Caught Error: ${String(i)}`))}});h(this,"removeHostname",async({instituteUuid:n,hostname:r})=>{try{const i=await super.fetch(new URL(`/api/access-control/institute/${n}/hostname/${r}`,this.config.verityOrigin),{method:"DELETE",credentials:"include"});if(!i.ok)throw new f(Error(`Invalid response: ${i.statusText}`));return r}catch(i){throw new f(Error(`Caught Error: ${String(i)}`))}});h(this,"getInstitutionProctoringAccommodation",async()=>{try{const n=await super.fetch(new URL("/api/verity/institute-settings/proctoring-accommodations",this.config.verityOrigin),{credentials:"include"});if(n.ok){const r=await n.json();if(this.schemaValidators.instituteProctoringAccommodation.validate(r))return r}}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"updateInstitutionProctoringAccommodation",async n=>{try{if((await super.fetch(new URL("/api/verity/institute-settings/proctoring-accommodations",this.config.verityOrigin),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({proctoringAccommodations:n}),credentials:"include"})).ok)return}catch(r){if(r instanceof Error)throw new f(r)}throw new f})}};const VN=o.Object({id:o.Number(),uuid:o.String(),name:o.String()}),qN=new v(o.Array(VN)),GN=new v(o.Object({id:o.Number()})),ZN=new v(o.Union([o.Null(),o.Array(o.Object({userId:o.Integer()}))])),JN=new v(o.Object({id:o.String(),name:o.String(),platform:o.String(),instituteId:o.String(),timezone:o.String()})),KN=new v(o.Array(o.Object({type:o.String(),userId:o.Integer(),accommodationNotes:o.Optional(o.String()),proctoringOptionProfileId:o.Optional(o.Integer())}))),WN=new v(o.Object({exempt:o.Boolean(),proctoringOption:o.Optional(za)})),HN=new v(o.Union([o.Literal("en"),o.Literal("fr"),o.Null()])),YN=new v(o.Object({id:o.String(),userIds:o.Array(o.String(),{minItems:1})})),XN={students:qN,studentId:GN,exemptions:ZN,proctoringExemptions:KN,exemptionStatus:WN,accessControlUserInfo:JN,language:HN,standaloneAccount:YN};class QN extends U{constructor(n){super(n,XN);h(this,"getInstituteStudents",async()=>{try{const r=await(await super.fetch(new URL("/api/verity/user/student-roster",this.config.verityOrigin),{credentials:"include"})).json();if(this.schemaValidators.students.validate(r))return r}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"getCourseStudents",async n=>{if(n.courseId)try{const r=await super.fetch(new URL(`/api/verity/user/student-roster/${n.courseId}`,this.config.verityOrigin),{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.students.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}else console.error("No courseId provided");throw new f});h(this,"getProctoringExemptionStatus",async n=>{try{const r=await super.fetch(new URL(`/api/verity/proctoring-exemption/lms-course/${n.courseId}/lms-assessment/${n.quizId}/user`,this.config.verityOrigin),{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.exemptionStatus.validate(i))return i}throw new Error("ExemptionStatus was not type {exempt: boolean}")}catch(r){if(r instanceof Error)throw new f(r)}throw new f(new Error("Unable to fetch exemption status"))});h(this,"getProctoringExemptionStudents",async n=>{if(n.courseId)try{const r=await super.fetch(new URL(`/api/verity/proctoring-exemption/lms-course/${n.courseId}/lms-assessment/${n.quizId}`,this.config.verityOrigin),{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.proctoringExemptions.validate(i))return i}else if(r.status===404)return[]}catch(r){if(r instanceof Error)throw new f(r)}else console.error("No courseId provided");throw new f});h(this,"saveProctoringExemptionStudents",async({assessmentInfo:n,students:r})=>{try{if((await super.fetch(new URL(`/api/verity/proctoring-exemption/lms-course/${n.courseId}/lms-assessment/${n.quizId}`,this.config.verityOrigin),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({exemptedStudents:r})})).ok)return}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"getExemptionInfoSuccessStatus",async n=>{if(n.courseId)try{return(await super.fetch(new URL(`/api/verity/lms-course/${n.courseId}/lms-assessment/${n.quizId}`,this.config.verityOrigin),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}})).ok}catch{return!1}else return!1});h(this,"createStandaloneUser",({instituteUuid:n,courseUuid:r,assessmentUuid:i,email:s,firstName:a,lastName:c,expiryDate:u,emailTemplateData:l})=>Ee(super.fetch(new URL("/api/access-control/single-use-account",this.config.verityOrigin),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({instituteId:n,courseId:r,resourceId:i,email:s,firstName:a,lastName:c,expiryDate:u,emailTemplateData:l})}),this.schemaValidators.standaloneAccount));h(this,"getUserId",async()=>{try{const r=await(await super.fetch(new URL("/api/verity/user/id",this.config.verityOrigin),{credentials:"include"})).json();if(this.schemaValidators.studentId.validate(r))return r.id}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"getUserInfo",async n=>{try{return await(await super.fetch(new URL(`/api/verity/institute-user${n!=null?`/${n}`:""}`,this.config.verityOrigin),{credentials:"include"})).json()}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getAccessControlUserInfo",async n=>{try{const i=await(await super.fetch(new URL(`/api/access-control/user/${n}`,this.config.verityOrigin))).json();if(this.schemaValidators.accessControlUserInfo.validate(i))return i}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getUserLanguage",async n=>{try{const r=new URL(`/api/verity/user/${n}/language`,this.config.verityOrigin),s=await(await super.fetch(r,{credentials:"include"})).json();if(this.schemaValidators.language.validate(s))return s}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"saveUserLanguage",async(n,r)=>{try{const i=new URL(`/api/verity/user/${n}/language`,this.config.verityOrigin);return(await super.fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({language:r})})).status}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"getLaunchUrl",async()=>{try{const n=new URL("/api/verity/user/launch",this.config.verityOrigin),r=await super.fetch(n,{credentials:"include"});if(r.ok)return await r.json()}catch(n){if(n instanceof Error)throw new f(n)}throw new f})}}const eL={checkUserAndAuthenticateResponse:new v(o.Object({eligible:o.Boolean(),exempted:o.Boolean(),error:o.Optional(o.String())}))};class tL extends U{constructor(n){super(n,eL);h(this,"check",async n=>{try{const r=await super.fetch(new URL("/api/verity/quiz/take/check",this.config.verityOrigin),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:n})});if(r.ok){const i=await r.json();if(this.schemaValidators.checkUserAndAuthenticateResponse.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"start",async n=>{try{const r=await super.fetch(new URL("/api/verity/quiz/take/check",this.config.verityOrigin),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({assessmentInfo:n})});if(r.ok){const i=await r.json();if(this.schemaValidators.checkUserAndAuthenticateResponse.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f})}}const nL={};class rL extends U{constructor(n){super(n,nL);_t(this,Ds);h(this,"check",async()=>{var n,r,i,s,a;return{metrics:{type:(n=navigator.connection)==null?void 0:n.type,effectiveType:(r=navigator.connection)==null?void 0:r.effectiveType,downlinkMax:(i=navigator.connection)==null?void 0:i.downlinkMax,downlink:(s=navigator.connection)==null?void 0:s.downlink,rtt:(a=navigator.connection)==null?void 0:a.rtt},uploadSpeed:await he(this,Ds,xp).call(this)}})}}Ds=new WeakSet,xp=async function(n=8e7,r=5e3){const i=new Blob(["0".repeat(n)]);if(globalThis.XMLHttpRequest)return new Promise((s,a)=>{const c=new XMLHttpRequest,u=`${this.config.verityOrigin}/connection/check`;let l,m;c.open("POST",u,!0),c.timeout=r,c.upload.addEventListener("loadstart",function(g){g.loaded===0&&(l=performance.now())}),c.upload.addEventListener("loadend",function(g){m=performance.now(),s(g.loaded/(m-l)*1e3)}),c.send(i)});{const s=new AbortController,a=performance.now();setTimeout(()=>{n=NaN,s.abort()},r);try{await fetch(`${this.config.verityOrigin}/api/verity/connection/check`,{method:"POST",body:i,signal:s.signal})}catch(u){if(!s.signal.aborted)throw u}const c=performance.now();return n/(c-a)*1e3}};const yd=o.Object({id:o.Number(),instituteId:o.Number(),courseId:o.String(),code:o.Optional(o.Union([o.String(),o.Null()])),name:o.Optional(o.Union([o.String(),o.Null()])),isBlackboardUltra:o.Optional(o.Union([o.Boolean(),o.Null()])),verityEnabled:o.Boolean(),accessControlUuid:o.String()}),iL=new v(yd),sL=new v(o.Array(yd)),oL=o.Object({id:o.String(),instituteId:o.String(),code:A(o.String()),name:A(o.String())}),aL=new v(oL),cL=new v(o.Object({id:o.Number()})),uL=new v(o.Object({totalElements:o.Number()})),lL=new v(o.Object({url:o.Optional(o.String())})),fL={courseInfo:iL,courseInfoList:sL,accessControlCourseInfo:aL,courseId:cL,courseCount:uL,agreementUrl:lL};class dL extends U{constructor(n){super(n,fL);h(this,"getCourseInfoFromId",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/course/${n}`,{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.courseInfo.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getCourseInfoFromLmsCourseId",async({lmsCourseId:n,instituteId:r})=>{try{const i=new URL(`${this.config.verityOrigin}/api/verity/course/lms-course/${n}`);r&&i.searchParams.set("instituteId",r.toString());const s=await super.fetch(i,{credentials:"include"});if(s.ok){const a=await s.json();if(this.schemaValidators.courseInfo.validate(a))return a}}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"getPolicyPdfFromInstituteId",async({instituteId:n})=>{try{const r=new URL(`${this.config.verityOrigin}/api/verity/agreement/${n}/url`),i=await super.fetch(r,{credentials:"include"});if(i.ok){const s=await i.json();if(this.schemaValidators.agreementUrl.validate(s))return s.url}else return}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getCourseIdFromUuid",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/course/uuid:${n}`,{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.courseId.validate(i))return i.id}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getInstituteCoursesInfo",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/course/institute/${n}`,{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.courseInfoList.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getAccessControlCourse",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/access-control/course/${n}`);if(r.ok){const i=await r.json();if(this.schemaValidators.accessControlCourseInfo.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getCourseCountForPrefix",async(n,r)=>{try{const i=new URLSearchParams;i.set("instituteId",n),i.set("name",r),i.set("matchNameMode","STARTS_WITH"),i.set("ignoreCase","0");const s=await super.fetch(`${this.config.verityOrigin}/api/access-control/course?${i.toString()}`);if(s.ok){const a=await s.json();if(this.schemaValidators.courseCount.validate(a))return a.totalElements}}catch(i){if(i instanceof Error)throw new f(i)}throw new f})}}function ti(e){return o.Optional(o.Union([o.Null(),e]))}const wd=o.Object({enabled:o.Boolean(),isLiveProctored:o.Boolean(),isLivePopIn:o.Boolean(),enablePostReview:o.Boolean(),password:o.Union([o.Null(),o.String()]),thirdPartyAssessmentOption:ti(o.Object({thirdPartyUrl:ti(o.String()),password:ti(o.String()),thirdPartyPlatformId:ti(o.Number())})),proctoringOptionProfile:ei}),pL=new v(wd),hL=new v(o.Union([o.Null(),wd])),mL=new v(o.Object({standaloneStudentInfo:ti(o.Array(o.Object({id:o.Number(),userId:o.Number(),email:o.String(),firstName:o.String(),lastName:o.String()})))})),gL=new v(o.Object({proctoringMethod:o.Array(o.Union([o.Literal("automated"),o.Literal("live"),o.Literal("pop-in"),o.Literal("pop-in-post-review")]))})),yL={proctoringAssessmentConfigurationV2:pL,proctoringAssessmentConfigurationV2OrNull:hL,proctoringAssessmentConfigurationResponse:mL,enabledOptionsResponse:gL};class wL extends U{constructor(n){super(n,yL);h(this,"get",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/assessment/configuration/${n==null?void 0:n.lms}/${n.hostname}/${n.courseId??""}/${n.quizId}`,{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.proctoringAssessmentConfigurationV2OrNull.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"save",async({assessmentInfo:n,courseInfo:r,profileId:i,proctoringAssessmentConfiguration:s,proctoringOption:a,standaloneOptions:c})=>{try{const u=await super.fetch(`${this.config.verityOrigin}/api/verity/assessment/configuration/${n==null?void 0:n.lms}/${n.hostname}/${n.courseId??""}/${n.quizId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({assessmentInfo:n,courseInfo:r,profileId:i,proctoringAssessmentConfiguration:s,proctoringOption:a,standaloneOptions:c}),credentials:"include"});if(u.ok){const l=await u.json();if(this.schemaValidators.proctoringAssessmentConfigurationResponse.validate(l))return l}if(u.status===413){const l=new Error("Payload too large");throw new f(l)}}catch(u){if(u instanceof Error)throw new f(u)}throw new f});h(this,"updateWhitelist",async({courseId:n,quizId:r,type:i})=>{try{let s=`${this.config.verityOrigin}/api/verity/assessment/update-whitelist/${n}/${r}`;i&&(s+=`?type=${i}`),await super.fetch(s,{method:"PUT",credentials:"include"})}catch(s){console.error(s)}});h(this,"getEnabledOptions",({assessmentInfo:n,courseName:r})=>{let i=`${this.config.verityOrigin}/api/verity/assessment/configuration/${n==null?void 0:n.lms}/${n.hostname}/${n.courseId??""}/enabled-options`;return r&&(i+=`?courseName=${encodeURIComponent(r)}`),Ee(super.fetch(i,{credentials:"include"}),this.schemaValidators.enabledOptionsResponse)})}}class bL extends U{constructor(n){super(n,wN);h(this,"getAll",async({lmsProvidedCourseId:n})=>{try{const r=new URL("/api/verity/v2/profile",this.config.verityOrigin);n&&r.searchParams.set("lmsProvidedCourseId",n);const i=await super.fetch(r,{credentials:"include"});if(i.ok){const s=await i.json();if(this.schemaValidators.profiles.validate(s))return s}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"create",async({proctoringOption:n,isInstituteProfile:r,lmsProvidedCourseId:i,name:s})=>{try{const a=await super.fetch(new URL("/api/verity/v2/profile",this.config.verityOrigin),{headers:{"Content-Type":"application/json"},method:"POST",credentials:"include",body:JSON.stringify({proctoringOption:n,isInstituteProfile:r,lmsProvidedCourseId:i,name:s})});if(a.ok){const c=await a.json();if(this.schemaValidators.profile.validate(c))return c}}catch(a){if(a instanceof Error)throw new f(a)}throw new f});h(this,"update",async({id:n,proctoringOption:r,name:i})=>{try{const s=await super.fetch(new URL(`/api/verity/v2/profile/${n}`,this.config.verityOrigin),{headers:{"Content-Type":"application/json"},credentials:"include",method:"PATCH",body:JSON.stringify({proctoringOption:r,name:i})});if(s.ok){const a=await s.json();if(this.schemaValidators.profile.validate(a))return a}}catch(s){if(s instanceof Error)throw new f(s)}throw new f});h(this,"delete",async n=>{try{if((await super.fetch(new URL(`/api/verity/v2/profile/${n}`,this.config.verityOrigin),{headers:{"Content-Type":"application/json"},credentials:"include",method:"DELETE"})).ok)return}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"enforce",async({enforceProfileIds:n,unenforceProfileIds:r})=>{try{if((await super.fetch(new URL("/api/verity/v2/profiles/enforce",this.config.verityOrigin),{headers:{"Content-Type":"application/json"},credentials:"include",method:"PATCH",body:JSON.stringify({enforceProfileIds:n,unenforceProfileIds:r})})).ok)return}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"profilesEnforced",async()=>{try{const n=await super.fetch(new URL("/api/verity/v2/profiles/enforce",this.config.verityOrigin),{credentials:"include"});if(n.ok){const r=await n.json();if(this.schemaValidators.enforced.validate(r))return r.enforced}}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"getDefault",async()=>{try{const n=await super.fetch(new URL("/api/verity/v2/profile/default",this.config.verityOrigin),{credentials:"include"});if(n.ok){const r=await n.json();if(this.schemaValidators.profileOrNull.validate(r))return r}}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"setDefault",async n=>{try{if((await super.fetch(new URL("/api/verity/v2/profile/default",this.config.verityOrigin),{headers:{"Content-Type":"application/json"},credentials:"include",method:"PATCH",body:JSON.stringify({proctoringOptionProfileId:n})})).ok)return}catch(r){if(r instanceof Error)throw new f(r)}throw new f})}}const Va=o.Object({id:o.Number(),courseId:o.Number(),quizId:o.String(),quizInfo:A(o.Union([o.String(),o.Intersect([o.Object({name:A(o.String())}),o.Record(o.String(),o.Any())])])),isDeleted:o.Boolean(),createdAt:A(o.Union([o.Number(),o.String()])),updatedAt:A(o.Union([o.Number(),o.String()]))}),vL=new v(Va),SL=new v(o.Array(Va)),kL=new v(o.Array(o.Intersect([Va,o.Object({proctoringOptions:A(o.Object({enabled:A(o.Boolean()),isLiveProctored:A(o.Boolean()),isLivePopIn:A(o.Boolean()),enablePostReview:A(o.Boolean()),isExtension:A(o.Boolean()),isLockdown:A(o.Boolean()),isMobile:A(o.Boolean()),requiresIncognito:A(o.Boolean())}))})]))),OL=o.Object({userId:o.Number(),firstName:o.String(),lastName:o.String(),email:o.String()}),IL=new v(o.Array(OL)),$L=new v(o.Object({ok:o.Boolean(),exists:o.Boolean(),newName:o.Union([o.String(),o.Null()])})),bd=o.Object({count:o.Number(),monthlyCounts:o.Array(o.Number())}),EL=new v(o.Object({liveAssessments:bd,nonLiveAssessments:bd})),TL=new v(o.Object({didValidate:o.Boolean(),doPasswordsMatch:o.Boolean(),isPasswordRequired:o.Boolean()})),NL=new v(o.Object({didSynchronize:o.Boolean(),doPasswordsMatch:o.Boolean(),isPasswordRequired:o.Boolean()})),LL={assessmentInfo:vL,assessmentInfoArray:SL,assessmentInfoList:kL,standaloneStudentList:IL,suffixUpdateResult:$L,assessmentMonthlyCountList:EL,validate:TL,synchronize:NL};class AL extends U{constructor(n){super(n,LL);h(this,"getAssessments",async({course:n})=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/course/${n.id}/assessments`,{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.assessmentInfoArray.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}return[]});h(this,"useAssessmentsWithTypeCount",async({instituteId:n,courseId:r,time:i})=>{try{const s=await super.fetch(`${this.config.verityOrigin}/api/verity/institute/${n}/courseId/${r}/time/${i}`,{credentials:"include"});if(s.ok){const a=await s.json();if(this.schemaValidators.assessmentMonthlyCountList.validate(a))return a}}catch(s){if(s instanceof Error)throw new f(s)}});h(this,"getCourseAssessments",async n=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/lms-course/${n}/assessments`,{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.assessmentInfoList.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}return[]});h(this,"getAssessmentByCourseQuizId",async({lmsQuizId:n,courseId:r})=>{try{const i=await super.fetch(new URL(`/api/verity/course/${r}/lms-assessment/${n}`,`${this.config.verityOrigin}`),{credentials:"include"});if(i.ok){const s=await i.json();if(this.schemaValidators.assessmentInfo.validate(s))return s}}catch(i){if(i instanceof Error)throw new f(i)}});h(this,"getAssessmentByAssessmentInfo",async n=>{try{const r=await super.fetch(new URL(`/api/verity/lms-course/${n.courseId}/lms-assessment/${n.quizId}`,`${this.config.verityOrigin}`),{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.assessmentInfo.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}});h(this,"getAssessmentByAssessmentId",async n=>{try{const r=await super.fetch(new URL(`/api/verity/assessment/${n}`,`${this.config.verityOrigin}`),{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.assessmentInfo.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}});h(this,"isAssessmentVerityEnabled",async n=>{try{const r=new URLSearchParams;n.instituteId&&r.append("instituteId",n.instituteId.toString()),n.hostname&&r.append("hostname",n.hostname);const i=await super.fetch(new URL(`/api/verity/lms-course/${n.courseId}/lms-assessment/${n.quizId}/proctored?${r.toString()}`,`${this.config.verityOrigin}`),{credentials:"include"});if(i.ok){const s=await i.json();if(typeof s=="boolean")return s}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"assessmentCopyCheck",async n=>{try{const r=n.isCanvasNewQuiz?"canvas-new-quiz":void 0,i=new URLSearchParams;if(n.instituteId&&i.append("instituteId",n.instituteId.toString()),n!=null&&n.hostname&&i.append("hostname",n.hostname),r&&i.append("type",r),(await super.fetch(new URL(`/api/verity/lms-course/${n.courseId}/lms-assessment/${n.quizId}/copy-check?${i.toString()}`,`${this.config.verityOrigin}`),{method:"PUT",credentials:"include"})).ok)return}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getStandaloneStudents",async n=>{try{const r=await super.fetch(new URL(`/api/verity/standalone-api/assessment/${n}/students`,`${this.config.verityOrigin}`),{credentials:"include"});if(r.ok){const i=await r.json();if(this.schemaValidators.standaloneStudentList.validate(i))return i;throw new Error("Invalid shape of response")}throw new Error(`Invalid response: ${r.status} - ${r.statusText}`)}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"linkStandaloneStudentUser",({assessmentId:n,standaloneStudentId:r,accountUuid:i,userUuid:s})=>tt(super.fetch(new URL(`/api/verity/standalone-api/assessment/${n}/student/${r}/map`,`${this.config.verityOrigin}`),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({accountUuid:i,userUuid:s})})));h(this,"deleteStandaloneAssessmentByUUID",async(n,r)=>{try{const i=await super.fetch(new URL(`/api/verity/standalone-api/assessment/${n}/${r}`,`${this.config.verityOrigin}`),{method:"DELETE",credentials:"include"});if(i.ok)return{success:!0};throw new Error(`Invalid response: ${i.status} - ${i.statusText}`)}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"updateLmsAssessmentNameSuffix",async({assessmentId:n,oldSuffix:r,newSuffix:i})=>{try{const s=await super.fetch(new URL(`/api/verity/assessment/${n}/suffix`,`${this.config.verityOrigin}`),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({oldSuffix:r,newSuffix:i})});if(s.ok){const a=await s.json();if(this.schemaValidators.suffixUpdateResult.validate(a))return a;throw new Error("Invalid shape of response")}throw new Error(`Invalid response: ${s.status} - ${s.statusText}`)}catch(s){if(s instanceof Error)throw new f(s)}throw new f});h(this,"validate",async({courseId:n,quizId:r})=>{try{const i=await super.fetch(new URL(`/api/verity/lms-course/${n}/lms-assessment/${r}/validate`,`${this.config.verityOrigin}`),{method:"GET",headers:{"Content-Type":"application/json"}});if(i.ok){const s=await i.json();if(this.schemaValidators.validate.validate(s))return s;throw new Error("Invalid shape of response")}throw new Error(`Invalid response: ${i.status} - ${i.statusText}`)}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"synchronize",async({courseId:n,quizId:r})=>{try{const i=await super.fetch(new URL(`/api/verity/lms-course/${n}/lms-assessment/${r}/synchronize`,`${this.config.verityOrigin}`),{method:"GET",headers:{"Content-Type":"application/json"}});if(i.ok){const s=await i.json();if(this.schemaValidators.synchronize.validate(s))return s;throw new Error("Invalid shape of response")}throw new Error(`Invalid response: ${i.status} - ${i.statusText}`)}catch(i){if(i instanceof Error)throw new f(i)}throw new f})}}class PL extends U{constructor(n){super(n,{});h(this,"sendSupportEmail",async({name:n,email:r,subject:i,message:s})=>{try{if((await super.fetch(new URL("/api/verity/support/email",this.config.verityOrigin),{method:"POST",body:JSON.stringify({name:n,email:r,subject:i,message:s}),headers:{"Content-Type":"application/json"}})).ok)return!0}catch(a){if(a instanceof Error)throw new f(a)}throw new f})}}const RL={installation:new v(o.Object({id:o.String(),platform:o.Union([o.Literal("extension"),o.Literal("lockdown"),o.Literal("mobile")]),version:o.String(),fingerprint:o.String(),details:o.Object({})}))};class _L extends U{constructor(t){super(t,RL)}async createInstallation(t){try{const n=await super.fetch(`${this.config.verityOrigin}/api/verity/installation`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(n.ok){const r=await n.json();if(this.schemaValidators.installation.validate(r))return r}}catch(n){if(n instanceof Error)throw new f(n)}throw new f}async updateInstallation(t,n){try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/installation/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(r.ok){const i=await r.json();if(this.schemaValidators.installation.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f}}const CL=new v(o.Object({authorizationUrl:o.String()})),jL=new v(o.Object({accessToken:o.String(),expiresIn:o.Number()})),UL={authorization:CL,accessToken:jL};class xL extends U{constructor(n){super(n,UL);h(this,"getAuthorizationUrl",async({courseId:n,callbackUrl:r})=>{try{const i=await super.fetch(`${this.config.verityOrigin}/api/verity/oauth/grant`,{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({courseId:n,callbackUrl:r})});if(i.ok){const s=await i.json();if(this.schemaValidators.authorization.validate(s))return s.authorizationUrl}}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"getOAuthAccessToken",async()=>{try{const n=await super.fetch(`${this.config.verityOrigin}/api/verity/oauth/token`,{credentials:"include"});if(n.ok){const r=await n.json();if(this.schemaValidators.accessToken.validate(r))return r}}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"refreshStoredToken",async()=>{try{return(await super.fetch(`${this.config.verityOrigin}/api/verity/oauth/refresh`,{credentials:"include"})).ok}catch(n){if(n instanceof Error)throw new f(n)}throw new f})}}const ML=new v(o.Object({id:o.String(),email:o.String(),enabled:o.Boolean(),accountNonLocked:o.Boolean(),currentUserId:o.String(),userIds:o.Array(o.String())})),FL=new v(o.Object({refreshToken:o.String(),accountId:o.String()})),DL=new v(o.Object({accountId:o.String(),emailVerificationToken:o.String()})),BL=new v(o.Object({accountId:o.String(),passwordRestToken:o.String(),password:o.String()})),zL={createAccount:ML,login:FL,verifyEmail:DL,resetPassword:BL};class VL extends U{constructor(n){super(n,zL);h(this,"login",async({email:n,password:r})=>{try{const i=new URLSearchParams;i.append("email",n),i.append("password",r);const s=await super.fetch(`${this.config.verityOrigin}/api/access-control/login`,{credentials:"include",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i.toString()});if(s.ok){const a=await s.json();if(this.schemaValidators.login.validate(a))return a}}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"createAccount",async({email:n,password:r})=>{try{const i=await super.fetch(`${this.config.verityOrigin}/api/access-control/basic-auth`,{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});if(i.ok){const s=await i.json();if(this.schemaValidators.createAccount.validate(s))return s}}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"sendVerificationEmail",async({email:n})=>{try{if((await super.fetch(`${this.config.verityOrigin}/api/access-control/basic-auth/email-verification`,{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n})})).ok)return}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"verifyEmail",async({accountId:n,emailVerificationToken:r})=>{try{const i=await super.fetch(`${this.config.verityOrigin}/api/access-control/basic-auth/verify-email`,{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accountId:n,emailVerificationToken:r})});if(i.ok){const s=await i.json();if(this.schemaValidators.verifyEmail.validate(s))return s}}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"sendResetPasswordEmail",async({email:n})=>{try{if((await super.fetch(`${this.config.verityOrigin}/api/access-control/basic-auth/reset-password`,{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n})})).ok)return}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"resetPassword",async({accountId:n,passwordRestToken:r,password:i})=>{try{if((await super.fetch(`${this.config.verityOrigin}/api/access-control/basic-auth/password`,{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accountId:n,passwordRestToken:r,password:i})})).ok)return}catch(s){if(s instanceof Error)throw new f(s)}throw new f})}}const qa=new v(o.Object({entityId:o.Union([o.String(),o.Null()]),wantAuthnRequestsSigned:o.Union([o.Boolean(),o.Null()]),singleSignOnServiceLocation:o.Union([o.String(),o.Null()]),singleSignOnServiceBindingUrn:o.Union([o.String(),o.Null()]),singleLogoutServiceLocation:o.Union([o.String(),o.Null()]),singleLogoutServiceResponseLocation:o.Union([o.String(),o.Null()]),singleLogoutServiceBindingUrn:o.Union([o.String(),o.Null()]),signingAlgorithms:o.Array(o.String()),verificationX509Credentials:o.Array(o.Object({certificate:o.String(),type:o.String()})),encryptionX509Credentials:o.Array(o.Object({certificate:o.String(),type:o.String()}))})),Ga=new v(o.Object({email:o.Union([o.String(),o.Null()]),name:o.Union([o.String(),o.Null()]),role:o.Union([o.String(),o.Null()]),linkage:o.Union([o.String(),o.Null()])})),qL=new v(o.Object({id:o.Number(),attribute:o.String(),privilegeGroupId:o.Number()})),vd=new v(o.Object({instituteId:o.String(),registrationId:o.String(),metadataLocation:o.Union([o.String(),o.Null()]),nameIdFormat:o.Union([o.String(),o.Null()]),assertingPartyDetails:o.Union([qa.schema,o.Null()]),attributeMapping:o.Union([Ga.schema,o.Null()]),roleMappings:o.Union([o.Array(qL.schema),o.Null()]),enabled:o.Boolean()})),GL=new v(o.Object({content:o.Array(vd.schema)})),Sd=new v(o.Object({attribute:o.String(),privilegeGroupId:o.Number()})),ZL=new v(o.Object({metadataLocation:o.Union([o.String(),o.Null()]),nameIdFormat:o.Union([o.String(),o.Null()]),assertingPartyDetails:o.Union([qa.schema,o.Null()]),attributeMapping:o.Union([Ga.schema,o.Null()]),enabled:o.Union([o.Boolean(),o.Null()])})),JL=new v(o.Object({instituteId:o.String(),registrationId:o.Union([o.String(),o.Null()]),metadataLocation:o.Union([o.String(),o.Null()]),nameIdFormat:o.Union([o.String(),o.Null()]),assertingPartyDetails:o.Union([qa.schema,o.Null()]),attributeMapping:o.Union([Ga.schema,o.Null()]),roleMappings:o.Union([o.Array(Sd.schema),o.Null()]),enabled:o.Union([o.Boolean(),o.Null()])})),KL=new v(o.Array(o.Object({preset:o.Union([o.Literal("STUDENT"),o.Literal("INSTRUCTOR"),o.Literal("ADMIN")]),privilegeGroupId:o.Number()}))),WL={relyingPartyRegistration:vd,getRelyingPartyRegistrations:GL,addRoleMapping:Sd,updateRelyingPartyRegistration:ZL,createRelyingPartyRegistration:JL,getRoleMappingPresets:KL};class HL extends U{constructor(n){super(n,WL);h(this,"createRelyingPartyRegistration",async({createRequestBody:n})=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/access-control/relyingPartyRegistration`,{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...n})});if(r.ok){const i=await r.json();if(this.schemaValidators.relyingPartyRegistration.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getRelyingPartyRegistration",async({registrationId:n})=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/access-control/relyingPartyRegistration/${n}`,{credentials:"include",method:"GET"});if(r.ok){const i=await r.json();if(this.schemaValidators.relyingPartyRegistration.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getRelyingPartyRegistrations",async({instituteId:n,enabled:r})=>{try{const i=new URLSearchParams;i.set("instituteId",n),r!==void 0&&i.set("enabled",r.toString());const s=await super.fetch(`${this.config.verityOrigin}/api/access-control/relyingPartyRegistration?${i.toString()}`,{credentials:"include",method:"GET"});if(s.ok){const a=await s.json();if(this.schemaValidators.getRelyingPartyRegistrations.validate(a))return a}}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"updateRelyingPartyRegistration",async({registrationId:n,updateRequestBody:r})=>{try{const i=await super.fetch(`${this.config.verityOrigin}/api/access-control/relyingPartyRegistration/${n}`,{credentials:"include",method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({...r})});if(i.ok){const s=await i.json();if(this.schemaValidators.relyingPartyRegistration.validate(s))return s}}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"addRoleMapping",async({registrationId:n,attribute:r,privilegeGroupId:i})=>{try{const s=await super.fetch(`${this.config.verityOrigin}/api/access-control/relyingPartyRegistration/${n}/roleMapping`,{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({attribute:r,privilegeGroupId:i})});if(s.ok){const a=await s.json();if(this.schemaValidators.relyingPartyRegistration.validate(a))return a}}catch(s){if(s instanceof Error)throw new f(s)}throw new f});h(this,"deleteRoleMapping",async({registrationId:n,roleMappingId:r})=>{try{const i=await super.fetch(`${this.config.verityOrigin}/api/access-control/relyingPartyRegistration/${n}/roleMapping/${r}`,{credentials:"include",method:"DELETE",headers:{"Content-Type":"application/json"}});if(i.ok){const s=await i.json();if(this.schemaValidators.relyingPartyRegistration.validate(s))return s}}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"getRoleMappingPresets",async({registrationId:n})=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/access-control/relyingPartyRegistration/${n}/presets`,{credentials:"include",method:"GET",headers:{"Content-Type":"application/json"}});if(r.ok){const i=await r.json();if(this.schemaValidators.getRoleMappingPresets.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f})}}const YL=new v(o.Object({screencapture:o.Number(),webcam:o.Number()})),XL=new v(o.Object({url:o.String()})),Za={getNextRecordingNumbers:YL,uploadRecording:XL};class QL extends U{constructor(n){super(n,Za);h(this,"getNextRecordingNumbers",async({sessionId:n})=>{const r=new URLSearchParams([["number","webcam"],["number","screencapture"],["next","true"]]),i=await Ee(super.fetch(`${this.config.verityOrigin}/api/verity/quiz/recording/${n}?${r.toString()}`),Za.getNextRecordingNumbers);return{internal:i.screencapture,external:i.webcam}});h(this,"uploadRecording",async({sessionId:n,recordingDetails:r})=>{const i=new Blob([await fetch(r.videoObjectUrl).then(l=>l.arrayBuffer())],{type:r.videoMimeType}),s=new URLSearchParams({segment:`${r.blobNumber}`,url:"upload"}),a=await tt(super.fetch(`${this.config.verityOrigin}/api/verity/quiz/recording/${n}/${r.recordingType==="display"?"screencapture":r.recordingType}/${r.videoNumber}?${s.toString()}`));if(a.status===409)throw new Error("409");if(!a.ok)throw new f(new Error(`Unable to get upload URL: ${a.status} - ${a.statusText}`));const c=await a.json();if(!Za.uploadRecording.validate(c))throw new f(new Error(`Invalid upload URL: ${JSON.stringify(c)}`));const u=await fetch(c.url,{method:"PUT",body:i});if(!u.ok)throw new f(new Error(`Upload to S3 failed: ${u.status} - ${u.statusText}`))});h(this,"uploadPhoto",async({sessionId:n,type:r,imageObjectUrl:i,mimeType:s})=>{const a=new Blob([await fetch(i).then(c=>c.arrayBuffer())],{type:s});await tt(super.fetch(`${this.config.verityOrigin}/api/verity/photo/${n}-${r}.png`,{method:"PUT",body:a}))})}}class e1 extends U{constructor(n){super(n,{});h(this,"createUploadGrant",Zn(async n=>{const r=await uf.fetch(`${this.config.verityOrigin}/api/verity`,{method:"POST",headers:{"Content-Type":"application/json"},pathParams:n.pathParams,body:n.body},this.fetch.bind(this));return uf.response.body.parse(await r.json())}));h(this,"executeUploadCallback",Zn(async n=>(await P$.fetch(`${this.config.verityOrigin}/api/verity`,{method:"POST",headers:{"Content-Type":"application/json"},pathParams:n.pathParams,body:n.body},this.fetch.bind(this))).ok));h(this,"getLinks",Zn(async n=>{const r=await lf.fetch(`${this.config.verityOrigin}/api/verity`,{method:"GET",headers:{"Content-Type":"application/json"},pathParams:n.pathParams},this.fetch.bind(this));return lf.response.body.parse(await r.json())}))}}class t1 extends U{constructor(n){super(n,{});h(this,"initiatePayment",async({assessmentId:n})=>{try{const r=await super.fetch(new URL("/api/verity/payment",this.config.verityOrigin),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({assessmentId:n})});if(r.ok)return await r.json()}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"checkPaymentStatus",async({sessionId:n,assessmentId:r})=>{try{const i=await super.fetch(new URL(`/api/verity/payment/complete?stripeSessionId=${n}&assessmentId=${r}`,this.config.verityOrigin),{method:"GET",credentials:"include"});if(i.ok)return await i.json()}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"getEnabled",async()=>{try{const n=await super.fetch(new URL("/api/verity/payment/enabled",this.config.verityOrigin),{method:"GET",credentials:"include"});if(n.ok)return await n.json()}catch(n){if(n instanceof Error)throw new f(n)}throw new f})}}const n1=new v(o.Object({id:o.String(),url:o.String()})),r1=new v(o.Array(o.Object({id:o.String(),url:o.String(),uploadedAt:o.Optional(o.Number())}))),i1={createUploadGrant:n1,getLinks:r1};class s1 extends U{constructor(n){super(n,i1);h(this,"createUploadGrant",async({proctoringSessionUuid:n,mimeType:r})=>{try{const i=await super.fetch(`${this.config.verityOrigin}/api/verity/scratch-note/upload/grant/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mimeType:r})});if(i.ok){const s=await i.json();if(this.schemaValidators.createUploadGrant.validate(s))return s}}catch(i){if(i instanceof Error)throw new f(i)}throw new f});h(this,"uploadCallback",async({scratchNoteId:n})=>{try{if((await super.fetch(`${this.config.verityOrigin}/api/verity/scratch-note/upload/callback/${n}`,{method:"GET"})).ok)return}catch(r){if(r instanceof Error)throw new f(r)}throw new f});h(this,"getLinks",async({proctoringSessionUuid:n})=>{try{const r=await super.fetch(`${this.config.verityOrigin}/api/verity/scratch-note/links/${n}`,{method:"GET"});if(r.ok){const i=await r.json();if(this.schemaValidators.getLinks.validate(i))return i}}catch(r){if(r instanceof Error)throw new f(r)}throw new f})}}const o1={};class a1 extends U{constructor(n){super(n,o1);h(this,"getInstituteReport",async({instituteId:n,subAccountId:r,startDate:i,endDate:s,monthYearRange:a})=>{try{const c=new URLSearchParams({instituteId:n.toString(),...r?{subAccountId:r.toString()}:{},startDate:i.getTime().toString(),endDate:s.getTime().toString(),monthYearRange:JSON.stringify(a),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone}),u=new URL("/api/verity/report/admin/institute-report",this.config.verityOrigin);u.search=c.toString();const l=await super.fetch(u);if(l.ok)return await l.json()}catch(c){if(c instanceof Error)throw new f(c)}throw new f});h(this,"getSubAccounts",async()=>{try{const n=new URL("/api/verity/report/admin/subaccounts",this.config.verityOrigin),r=await super.fetch(n);if(r.ok)return await r.json()}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"getReceiveInstitutionReportEmail",async()=>{try{const n=new URL("/api/verity/report/admin/receive-institution-report-email",this.config.verityOrigin),r=await super.fetch(n);if(r.ok)return await r.json()}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"updateReceiveInstitutionReportEmail",async n=>{try{const r=new URL("/api/verity/report/admin/receive-institution-report-email",this.config.verityOrigin);if((await super.fetch(r,{method:"POST",body:JSON.stringify({receiveEmail:n}),headers:{"Content-Type":"application/json"}})).ok)return}catch(r){if(r instanceof Error)throw new f(r)}throw new f})}}const c1=new v(o.Object({entries:o.Array(o.Object({lti1p3AccountId:o.String(),userId:o.String(),secondaryLmsUserId:o.Union([o.String(),o.Null()]),email:o.Union([o.String(),o.Null()]),firstName:o.Union([o.String(),o.Null()]),lastName:o.Union([o.String(),o.Null()]),role:o.String(),locked:o.Boolean()})),currentPage:o.Number(),totalElements:o.Number(),totalPages:o.Number()})),u1=new v(o.Object({TOTAL:o.Number(),ADMIN:o.Number(),INSTRUCTOR:o.Number(),STUDENT:o.Number()})),l1=new v(o.Object({lti1p3AccountId:o.String(),userId:o.String(),role:o.String(),locked:o.Boolean()})),f1={getRoster:c1,getRosterStatistics:u1,updateRoster:l1};class d1 extends U{constructor(n){super(n,f1);h(this,"getRoster",async({page:n,size:r,locked:i,searchQuery:s,roles:a,sortBy:c,sortDirection:u})=>{try{const l=new URLSearchParams;l.set("page",String(n)),l.set("size",String(r)),i&&i.length>0&&l.set("locked",i.map(String).join(",")),s&&s!==""&&l.set("searchQuery",s),a&&a.length>0&&l.set("roles",a.join(",")),c&&c.length>0&&c.forEach(g=>{l.append("sortBy",g)}),u&&u.length>0&&u.forEach(g=>{l.append("sortDirection",g)});const m=await super.fetch(`${this.config.verityOrigin}/api/verity/roster?${l.toString()}`,{credentials:"include"});if(m.ok){const g=await m.json();if(this.schemaValidators.getRoster.validate(g))return g}}catch(l){if(l instanceof Error)throw new f(l)}throw new f});h(this,"getRosterStatistics",async()=>{try{const n=await super.fetch(`${this.config.verityOrigin}/api/verity/roster/stats`,{credentials:"include"});if(n.ok){const r=await n.json();if(this.schemaValidators.getRosterStatistics.validate(r))return r}}catch(n){if(n instanceof Error)throw new f(n)}throw new f});h(this,"updateRoster",async({lti1p3AccountId:n,userId:r,role:i,locked:s})=>{try{const a=await super.fetch(`${this.config.verityOrigin}/api/verity/roster`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({lti1p3AccountId:n,userId:r,role:i,locked:s})});if(a.ok){const c=await a.json();if(this.schemaValidators.updateRoster.validate(c))return c}}catch(a){if(a instanceof Error)throw new f(a)}throw new f})}}const p1={},ht={ACCESS_TOKEN:"verityToken",ACCESS_EXPIRES_AT:"verityAccessExpiresAt",REFRESH_TOKEN:"verityInfo",REFRESH_EXPIRES_AT:"verityRefreshExpiresAt",ACCOUNT_ID:"verityAccountId",LOCAL_REFRESHED_TIME:"verityLocalRefreshTimestamp"};function h1(e){return{...e,getRefreshToken:async()=>Promise.resolve(localStorage.getItem(ht.REFRESH_TOKEN)??void 0),setRefreshToken:async t=>t===void 0?Promise.resolve(localStorage.removeItem(ht.REFRESH_TOKEN)):Promise.resolve(localStorage.setItem(ht.REFRESH_TOKEN,t)),getAccountId:async()=>Promise.resolve(localStorage.getItem(ht.ACCOUNT_ID)??void 0),setAccountId:async t=>t?Promise.resolve(localStorage.setItem(ht.ACCOUNT_ID,t)):Promise.resolve(localStorage.removeItem(ht.ACCOUNT_ID)),getAccessToken:async()=>Promise.resolve(localStorage.getItem(ht.ACCESS_TOKEN)??void 0),setAccessToken:async t=>t?Promise.resolve(localStorage.setItem(ht.ACCESS_TOKEN,t)):Promise.resolve(localStorage.removeItem(ht.ACCESS_TOKEN)),getLocalRefreshedTime:async()=>{const t=localStorage.getItem(ht.LOCAL_REFRESHED_TIME);return Promise.resolve(t?Number.parseInt(t):void 0)},setLocalRefreshedTime:async t=>t?Promise.resolve(localStorage.setItem(ht.LOCAL_REFRESHED_TIME,t.toString())):Promise.resolve(localStorage.removeItem(ht.LOCAL_REFRESHED_TIME)),isEnvironmentSupported:()=>{try{if(typeof window>"u"||!window.localStorage)return!1;const t="__test_storage__";localStorage.setItem(t,"test");const n=localStorage.getItem(t);return localStorage.removeItem(t),n==="test"}catch{return!1}}}}const m1=5e3,nn={ACCESS_TOKEN:"lti.verity.accessToken",ACCOUNT_ID:"lti.verity.accountId",REFRESH_TOKEN:"lti.verity.refreshToken",LOCAL_REFRESHED_TIME:"lti.verity.localRefreshTime"};function rn(){return`lti_msg_${Date.now()}_${Math.random().toString(36).slice(2,11)}`}async function sn(e,t,n,r){return new Promise(i=>{const s=setTimeout(()=>{window.removeEventListener("message",a),i(void 0)},r);function a(c){const u=c.origin===t;if(u){const l=c.data;if(l!==null){const m=typeof l=="object"&&"subject"in l&&typeof l.subject=="string"&&"message_id"in l&&typeof l.message_id=="string";if(!u||!m)return;window.removeEventListener("message",a),clearTimeout(s);const g=l;g.error?i(void 0):i(g.value)}}}window.addEventListener("message",a),e.postMessage(n,t)})}function g1(e,t,n,r=m1){return{...n,getRefreshToken:async()=>sn(e,t,{subject:"lti.get_data",message_id:rn(),key:nn.REFRESH_TOKEN},r),setRefreshToken:async i=>{await sn(e,t,{subject:"lti.put_data",message_id:rn(),key:nn.REFRESH_TOKEN,value:i},r)},getAccountId:async()=>sn(e,t,{subject:"lti.get_data",message_id:rn(),key:nn.ACCOUNT_ID},r),setAccountId:async i=>{await sn(e,t,{subject:"lti.put_data",message_id:rn(),key:nn.ACCOUNT_ID,value:i},r)},getAccessToken:async()=>sn(e,t,{subject:"lti.get_data",message_id:rn(),key:nn.ACCESS_TOKEN},r),setAccessToken:async i=>{await sn(e,t,{subject:"lti.put_data",message_id:rn(),key:nn.ACCESS_TOKEN,value:i},r)},getLocalRefreshedTime:async()=>sn(e,t,{subject:"lti.get_data",message_id:rn(),key:nn.LOCAL_REFRESHED_TIME},r),setLocalRefreshedTime:async i=>{await sn(e,t,{subject:"lti.put_data",message_id:rn(),key:nn.LOCAL_REFRESHED_TIME,value:i},r)},isEnvironmentSupported:()=>{try{return!(typeof window>"u"||!e||e.closed||!e.postMessage)}catch{return!1}}}}class y1 extends U{constructor(n){super(n,p1);h(this,"updateVerityInstituteSettings",async(n,r)=>await tt(super.fetch(new URL(`/api/verity/lti-institute/${n}/settings`,this.config.verityOrigin),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r),credentials:"include"})))}}class w1 extends U{constructor(n){super(n,{});h(this,"registerPeer",Zn(async n=>{const r=await hf.fetch(`${this.config.verityOrigin}/api/verity`,{method:"POST",headers:{"Content-Type":"application/json"},body:n.body},this.fetch.bind(this));return hf.response.body.parse(await r.json())}));h(this,"createSingleUseGrant",Zn(async n=>{const r=await mf.fetch(`${this.config.verityOrigin}/api/verity`,{method:"POST",headers:{"Content-Type":"application/json"},pathParams:n.pathParams},this.fetch.bind(this));return mf.response.body.parse(await r.json())}))}}class b1 extends U{constructor(n){super(n,{});h(this,"authentication");h(this,"lmsInfo");h(this,"proctoringSession");h(this,"liveClient");h(this,"platformInfo");h(this,"permission");h(this,"download");h(this,"institute");h(this,"course");h(this,"assessment");h(this,"verityOptions");h(this,"user");h(this,"startAssessmentClient");h(this,"connectionCheck");h(this,"proctoringConfiguration");h(this,"proctoringProfile");h(this,"supportEmail");h(this,"installation");h(this,"oauth");h(this,"scratchNote");h(this,"report");h(this,"roster");h(this,"saml");h(this,"basicAuth");h(this,"media");h(this,"dataDump");h(this,"payment");h(this,"admin");h(this,"restrictedDevice");this.authentication=new xS(n),this.lmsInfo=new KE(n),this.proctoringSession=new sE(n),this.liveClient=new NE(n),this.platformInfo=new RE(n),this.permission=new ME(n),this.download=new uN(n),this.institute=new zN(n),this.course=new dL(n),this.assessment=new AL(n),this.verityOptions=new hN(n),this.user=new QN(n),this.startAssessmentClient=new tL(n),this.connectionCheck=new rL(n),this.proctoringConfiguration=new wL(n),this.proctoringProfile=new bL(n),this.supportEmail=new PL(n),this.installation=new _L(n),this.oauth=new xL(n),this.scratchNote=new s1(n),this.report=new a1(n),this.roster=new d1(n),this.saml=new HL(n),this.basicAuth=new VL(n),this.media=new QL(n),this.dataDump=new e1(n),this.payment=new t1(n),this.admin=new y1(n),this.restrictedDevice=new w1(n)}}const qt=class qt extends b1{constructor(t){super(t)}static getConfigKey(t){return`${t.verityOrigin}:${t.lockdown.origin}:${t.lockdown.channel}`}static getInstance(t){const n=qt.getConfigKey(t),r=qt.instances.get(n);if(r)return r;const i=h1(t);if(i.isEnvironmentSupported()){const a=new qt(i);return qt.instances.set(n,a),a}const s=g1(window.top??window.parent,new URL(window.location.ancestorOrigins[0]).origin,t);if(s.isEnvironmentSupported()){const a=new qt(s);return qt.instances.set(n,a),a}throw new Error("No valid adapter found")}};h(qt,"instances",new Map);let Ja=qt;function pe(e,t){if(!e)throw new Error(t)}const v1=34028234663852886e22,S1=-34028234663852886e22,k1=4294967295,O1=2147483647,I1=-2147483648;function Is(e){if(typeof e!="number")throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>O1||e<I1)throw new Error("invalid int 32: "+e)}function Ka(e){if(typeof e!="number")throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>k1||e<0)throw new Error("invalid uint 32: "+e)}function kd(e){if(typeof e!="number")throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>v1||e<S1))throw new Error("invalid float 32: "+e)}const Od=Symbol("@bufbuild/protobuf/enum-type");function $1(e){const t=e[Od];return pe(t,"missing enum type on enum object"),t}function Id(e,t,n,r){e[Od]=$d(t,n.map(i=>({no:i.no,name:i.name,localName:e[i.no]})))}function $d(e,t,n){const r=Object.create(null),i=Object.create(null),s=[];for(const a of t){const c=Ed(a);s.push(c),r[a.name]=c,i[a.no]=c}return{typeName:e,values:s,findName(a){return r[a]},findNumber(a){return i[a]}}}function E1(e,t,n){const r={};for(const i of t){const s=Ed(i);r[s.localName]=s.no,r[s.no]=s.localName}return Id(r,e,t),r}function Ed(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}class An{equals(t){return this.getType().runtime.util.equals(this.getType(),this,t)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(t,n){const r=this.getType(),i=r.runtime.bin,s=i.makeReadOptions(n);return i.readMessage(this,s.readerFactory(t),t.byteLength,s),this}fromJson(t,n){const r=this.getType(),i=r.runtime.json,s=i.makeReadOptions(n);return i.readMessage(r,t,s,this),this}fromJsonString(t,n){let r;try{r=JSON.parse(t)}catch(i){throw new Error(`cannot decode ${this.getType().typeName} from JSON: ${i instanceof Error?i.message:String(i)}`)}return this.fromJson(r,n)}toBinary(t){const n=this.getType(),r=n.runtime.bin,i=r.makeWriteOptions(t),s=i.writerFactory();return r.writeMessage(this,s,i),s.finish()}toJson(t){const n=this.getType(),r=n.runtime.json,i=r.makeWriteOptions(t);return r.writeMessage(this,i)}toJsonString(t){var n;const r=this.toJson(t);return JSON.stringify(r,null,(n=t==null?void 0:t.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function T1(e,t,n,r){var i;const s=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:t.substring(t.lastIndexOf(".")+1),a={[s]:function(c){e.util.initFields(this),e.util.initPartial(c,this)}}[s];return Object.setPrototypeOf(a.prototype,new An),Object.assign(a,{runtime:e,typeName:t,fields:e.util.newFieldList(n),fromBinary(c,u){return new a().fromBinary(c,u)},fromJson(c,u){return new a().fromJson(c,u)},fromJsonString(c,u){return new a().fromJsonString(c,u)},equals(c,u){return e.util.equals(a,c,u)}}),a}function N1(){let e=0,t=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,!(i&128))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(n&15)<<28,t=(n&112)>>4,!(n&128))return this.assertBounds(),[e,t];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<r,!(i&128))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function Wa(e,t,n){for(let s=0;s<28;s=s+7){const a=e>>>s,c=!(!(a>>>7)&&t==0),u=(c?a|128:a)&255;if(n.push(u),!c)return}const r=e>>>28&15|(t&7)<<4,i=!!(t>>3);if(n.push((i?r|128:r)&255),!!i){for(let s=3;s<31;s=s+7){const a=t>>>s,c=!!(a>>>7),u=(c?a|128:a)&255;if(n.push(u),!c)return}n.push(t>>>31&1)}}const $s=4294967296;function Td(e){const t=e[0]==="-";t&&(e=e.slice(1));const n=1e6;let r=0,i=0;function s(a,c){const u=Number(e.slice(a,c));i*=n,r=r*n+u,r>=$s&&(i=i+(r/$s|0),r=r%$s)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),t?Ld(r,i):Ha(r,i)}function L1(e,t){let n=Ha(e,t);const r=n.hi&2147483648;r&&(n=Ld(n.lo,n.hi));const i=Nd(n.lo,n.hi);return r?"-"+i:i}function Nd(e,t){if({lo:e,hi:t}=A1(e,t),t<=2097151)return String($s*t+e);const n=e&16777215,r=(e>>>24|t<<8)&16777215,i=t>>16&65535;let s=n+r*6777216+i*6710656,a=r+i*8147497,c=i*2;const u=1e7;return s>=u&&(a+=Math.floor(s/u),s%=u),a>=u&&(c+=Math.floor(a/u),a%=u),c.toString()+Ad(a)+Ad(s)}function A1(e,t){return{lo:e>>>0,hi:t>>>0}}function Ha(e,t){return{lo:e|0,hi:t|0}}function Ld(e,t){return t=~t,e?e=~e+1:t+=1,Ha(e,t)}const Ad=e=>{const t=String(e);return"0000000".slice(t.length)+t};function Pd(e,t){if(e>=0){for(;e>127;)t.push(e&127|128),e=e>>>7;t.push(e)}else{for(let n=0;n<9;n++)t.push(e&127|128),e=e>>7;t.push(1)}}function P1(){let e=this.buf[this.pos++],t=e&127;if(!(e&128))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<7,!(e&128))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<14,!(e&128))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<21,!(e&128))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(e&15)<<28;for(let n=5;e&128&&n<10;n++)e=this.buf[this.pos++];if(e&128)throw new Error("invalid varint");return this.assertBounds(),t>>>0}function R1(){const e=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof e.getBigInt64=="function"&&typeof e.getBigUint64=="function"&&typeof e.setBigInt64=="function"&&typeof e.setBigUint64=="function"&&(typeof process!="object"||typeof process.env!="object"||{}.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),s=BigInt("9223372036854775807"),a=BigInt("0"),c=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(u){const l=typeof u=="bigint"?u:BigInt(u);if(l>s||l<i)throw new Error(`int64 invalid: ${u}`);return l},uParse(u){const l=typeof u=="bigint"?u:BigInt(u);if(l>c||l<a)throw new Error(`uint64 invalid: ${u}`);return l},enc(u){return e.setBigInt64(0,this.parse(u),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(u){return e.setBigInt64(0,this.uParse(u),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec(u,l){return e.setInt32(0,u,!0),e.setInt32(4,l,!0),e.getBigInt64(0,!0)},uDec(u,l){return e.setInt32(0,u,!0),e.setInt32(4,l,!0),e.getBigUint64(0,!0)}}}const n=i=>pe(/^-?[0-9]+$/.test(i),`int64 invalid: ${i}`),r=i=>pe(/^[0-9]+$/.test(i),`uint64 invalid: ${i}`);return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),n(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),n(i),Td(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),Td(i)},dec(i,s){return L1(i,s)},uDec(i,s){return Nd(i,s)}}}const Le=R1();var T;(function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"})(T||(T={}));var on;(function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING"})(on||(on={}));function an(e,t,n){if(t===n)return!0;if(e==T.BYTES){if(!(t instanceof Uint8Array)||!(n instanceof Uint8Array)||t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==n[r])return!1;return!0}switch(e){case T.UINT64:case T.FIXED64:case T.INT64:case T.SFIXED64:case T.SINT64:return t==n}return!1}function fr(e,t){switch(e){case T.BOOL:return!1;case T.UINT64:case T.FIXED64:case T.INT64:case T.SFIXED64:case T.SINT64:return t==0?Le.zero:"0";case T.DOUBLE:case T.FLOAT:return 0;case T.BYTES:return new Uint8Array(0);case T.STRING:return"";default:return 0}}function Rd(e,t){switch(e){case T.BOOL:return t===!1;case T.STRING:return t==="";case T.BYTES:return t instanceof Uint8Array&&!t.byteLength;default:return t==0}}var ve;(function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"})(ve||(ve={}));class _1{constructor(t){this.stack=[],this.textEncoder=t??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let t=0;for(let i=0;i<this.chunks.length;i++)t+=this.chunks[i].length;let n=new Uint8Array(t),r=0;for(let i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let t=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(t.byteLength),this.raw(t)}tag(t,n){return this.uint32((t<<3|n)>>>0)}raw(t){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(t),this}uint32(t){for(Ka(t);t>127;)this.buf.push(t&127|128),t=t>>>7;return this.buf.push(t),this}int32(t){return Is(t),Pd(t,this.buf),this}bool(t){return this.buf.push(t?1:0),this}bytes(t){return this.uint32(t.byteLength),this.raw(t)}string(t){let n=this.textEncoder.encode(t);return this.uint32(n.byteLength),this.raw(n)}float(t){kd(t);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,t,!0),this.raw(n)}double(t){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,t,!0),this.raw(n)}fixed32(t){Ka(t);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t,!0),this.raw(n)}sfixed32(t){Is(t);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,t,!0),this.raw(n)}sint32(t){return Is(t),t=(t<<1^t>>31)>>>0,Pd(t,this.buf),this}sfixed64(t){let n=new Uint8Array(8),r=new DataView(n.buffer),i=Le.enc(t);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}fixed64(t){let n=new Uint8Array(8),r=new DataView(n.buffer),i=Le.uEnc(t);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}int64(t){let n=Le.enc(t);return Wa(n.lo,n.hi,this.buf),this}sint64(t){let n=Le.enc(t),r=n.hi>>31,i=n.lo<<1^r,s=(n.hi<<1|n.lo>>>31)^r;return Wa(i,s,this.buf),this}uint64(t){let n=Le.uEnc(t);return Wa(n.lo,n.hi,this.buf),this}}class C1{constructor(t,n){this.varint64=N1,this.uint32=P1,this.buf=t,this.len=t.length,this.pos=0,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.textDecoder=n??new TextDecoder}tag(){let t=this.uint32(),n=t>>>3,r=t&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(t,n){let r=this.pos;switch(t){case ve.Varint:for(;this.buf[this.pos++]&128;);break;case ve.Bit64:this.pos+=4;case ve.Bit32:this.pos+=4;break;case ve.LengthDelimited:let i=this.uint32();this.pos+=i;break;case ve.StartGroup:for(;;){const[s,a]=this.tag();if(a===ve.EndGroup){if(n!==void 0&&s!==n)throw new Error("invalid end group tag");break}this.skip(a,s)}break;default:throw new Error("cant skip wire type "+t)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)}int64(){return Le.dec(...this.varint64())}uint64(){return Le.uDec(...this.varint64())}sint64(){let[t,n]=this.varint64(),r=-(t&1);return t=(t>>>1|(n&1)<<31)^r,n=n>>>1^r,Le.dec(t,n)}bool(){let[t,n]=this.varint64();return t!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Le.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Le.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let t=this.uint32(),n=this.pos;return this.pos+=t,this.assertBounds(),this.buf.subarray(n,n+t)}string(){return this.textDecoder.decode(this.bytes())}}function j1(e,t,n,r){let i;return{typeName:t,extendee:n,get field(){if(!i){const s=typeof r=="function"?r():r;s.name=t.split(".").pop(),s.jsonName=`[${t}]`,i=e.util.newFieldList([s]).list()[0]}return i},runtime:e}}function _d(e){const t=e.field.localName,n=Object.create(null);return n[t]=U1(e),[n,()=>n[t]]}function U1(e){const t=e.field;if(t.repeated)return[];if(t.default!==void 0)return t.default;switch(t.kind){case"enum":return t.T.values[0].no;case"scalar":return fr(t.T,t.L);case"message":const n=t.T,r=new n;return n.fieldWrapper?n.fieldWrapper.unwrapField(r):r;case"map":throw"map fields are not allowed to be extensions"}}function x1(e,t){if(!t.repeated&&(t.kind=="enum"||t.kind=="scalar")){for(let n=e.length-1;n>=0;--n)if(e[n].no==t.no)return[e[n]];return[]}return e.filter(n=>n.no===t.no)}let zt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Es=[];for(let e=0;e<zt.length;e++)Es[zt[e].charCodeAt(0)]=e;Es["-".charCodeAt(0)]=zt.indexOf("+"),Es["_".charCodeAt(0)]=zt.indexOf("/");const Ts={dec(e){let t=e.length*3/4;e[e.length-2]=="="?t-=2:e[e.length-1]=="="&&(t-=1);let n=new Uint8Array(t),r=0,i=0,s,a=0;for(let c=0;c<e.length;c++){if(s=Es[e.charCodeAt(c)],s===void 0)switch(e[c]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:a=s,i=1;break;case 1:n[r++]=a<<2|(s&48)>>4,a=s,i=2;break;case 2:n[r++]=(a&15)<<4|(s&60)>>2,a=s,i=3;break;case 3:n[r++]=(a&3)<<6|s,i=0;break}}if(i==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(e){let t="",n=0,r,i=0;for(let s=0;s<e.length;s++)switch(r=e[s],n){case 0:t+=zt[r>>2],i=(r&3)<<4,n=1;break;case 1:t+=zt[i|r>>4],i=(r&15)<<2,n=2;break;case 2:t+=zt[i|r>>6],t+=zt[r&63],n=0;break}return n&&(t+=zt[i],t+="=",n==1&&(t+="=")),t}};function M1(e,t,n){jd(t,e);const r=t.runtime.bin.makeReadOptions(n),i=x1(e.getType().runtime.bin.listUnknownFields(e),t.field),[s,a]=_d(t);for(const c of i)t.runtime.bin.readField(s,r.readerFactory(c.data),t.field,c.wireType,r);return a()}function F1(e,t,n,r){jd(t,e);const i=t.runtime.bin.makeReadOptions(r),s=t.runtime.bin.makeWriteOptions(r);if(Cd(e,t)){const l=e.getType().runtime.bin.listUnknownFields(e).filter(m=>m.no!=t.field.no);e.getType().runtime.bin.discardUnknownFields(e);for(const m of l)e.getType().runtime.bin.onUnknownField(e,m.no,m.wireType,m.data)}const a=s.writerFactory();let c=t.field;!c.opt&&!c.repeated&&(c.kind=="enum"||c.kind=="scalar")&&(c=Object.assign(Object.assign({},t.field),{opt:!0})),t.runtime.bin.writeField(c,n,a,s);const u=i.readerFactory(a.finish());for(;u.pos<u.len;){const[l,m]=u.tag(),g=u.skip(m,l);e.getType().runtime.bin.onUnknownField(e,l,m,g)}}function Cd(e,t){const n=e.getType();return t.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(e).find(r=>r.no==t.field.no)}function jd(e,t){pe(e.extendee.typeName==t.getType().typeName,`extension ${e.typeName} can only be applied to message ${e.extendee.typeName}`)}function Ud(e,t){const n=e.localName;if(e.repeated)return t[n].length>0;if(e.oneof)return t[e.oneof.localName].case===n;switch(e.kind){case"enum":case"scalar":return e.opt||e.req?t[n]!==void 0:e.kind=="enum"?t[n]!==e.T.values[0].no:!Rd(e.T,t[n]);case"message":return t[n]!==void 0;case"map":return Object.keys(t[n]).length>0}}function xd(e,t){const n=e.localName,r=!e.opt&&!e.req;if(e.repeated)t[n]=[];else if(e.oneof)t[e.oneof.localName]={case:void 0};else switch(e.kind){case"map":t[n]={};break;case"enum":t[n]=r?e.T.values[0].no:void 0;break;case"scalar":t[n]=r?fr(e.T,e.L):void 0;break;case"message":t[n]=void 0;break}}function Pn(e,t){if(e===null||typeof e!="object"||!Object.getOwnPropertyNames(An.prototype).every(r=>r in e&&typeof e[r]=="function"))return!1;const n=e.getType();return n===null||typeof n!="function"||!("typeName"in n)||typeof n.typeName!="string"?!1:t===void 0?!0:n.typeName==t.typeName}function Md(e,t){return Pn(t)||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}T.DOUBLE,T.FLOAT,T.INT64,T.UINT64,T.INT32,T.UINT32,T.BOOL,T.STRING,T.BYTES;const Fd={ignoreUnknownFields:!1},Dd={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function D1(e){return e?Object.assign(Object.assign({},Fd),e):Fd}function B1(e){return e?Object.assign(Object.assign({},Dd),e):Dd}const Ns=Symbol(),Ls=Symbol();function z1(){return{makeReadOptions:D1,makeWriteOptions:B1,readMessage(e,t,n,r){if(t==null||Array.isArray(t)||typeof t!="object")throw new Error(`cannot decode message ${e.typeName} from JSON: ${Pt(t)}`);r=r??new e;const i=new Map,s=n.typeRegistry;for(const[a,c]of Object.entries(t)){const u=e.fields.findJsonName(a);if(u){if(u.oneof){if(c===null&&u.kind=="scalar")continue;const l=i.get(u.oneof);if(l!==void 0)throw new Error(`cannot decode message ${e.typeName} from JSON: multiple keys for oneof "${u.oneof.name}" present: "${l}", "${a}"`);i.set(u.oneof,a)}Bd(r,c,u,n,e)}else{let l=!1;if(s!=null&&s.findExtension&&a.startsWith("[")&&a.endsWith("]")){const m=s.findExtension(a.substring(1,a.length-1));if(m&&m.extendee.typeName==e.typeName){l=!0;const[g,d]=_d(m);Bd(g,c,m.field,n,m),F1(r,m,d(),n)}}if(!l&&!n.ignoreUnknownFields)throw new Error(`cannot decode message ${e.typeName} from JSON: key "${a}" is unknown`)}}return r},writeMessage(e,t){const n=e.getType(),r={};let i;try{for(i of n.fields.byNumber()){if(!Ud(i,e)){if(i.req)throw"required field not set";if(!t.emitDefaultValues||!q1(i))continue}const a=i.oneof?e[i.oneof.localName].value:e[i.localName],c=zd(i,a,t);c!==void 0&&(r[t.useProtoFieldName?i.name:i.jsonName]=c)}const s=t.typeRegistry;if(s!=null&&s.findExtensionFor)for(const a of n.runtime.bin.listUnknownFields(e)){const c=s.findExtensionFor(n.typeName,a.no);if(c&&Cd(e,c)){const u=M1(e,c,t),l=zd(c.field,u,t);l!==void 0&&(r[c.field.jsonName]=l)}}}catch(s){const a=i?`cannot encode field ${n.typeName}.${i.name} to JSON`:`cannot encode message ${n.typeName} to JSON`,c=s instanceof Error?s.message:String(s);throw new Error(a+(c.length>0?`: ${c}`:""))}return r},readScalar(e,t,n){return ni(e,t,n??on.BIGINT,!0)},writeScalar(e,t,n){if(t!==void 0&&(n||Rd(e,t)))return As(e,t)},debug:Pt}}function Pt(e){if(e===null)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":`"${e.split('"').join('\\"')}"`;default:return String(e)}}function Bd(e,t,n,r,i){let s=n.localName;if(n.repeated){if(pe(n.kind!="map"),t===null)return;if(!Array.isArray(t))throw new Error(`cannot decode field ${i.typeName}.${n.name} from JSON: ${Pt(t)}`);const a=e[s];for(const c of t){if(c===null)throw new Error(`cannot decode field ${i.typeName}.${n.name} from JSON: ${Pt(c)}`);switch(n.kind){case"message":a.push(n.T.fromJson(c,r));break;case"enum":const u=Ya(n.T,c,r.ignoreUnknownFields,!0);u!==Ls&&a.push(u);break;case"scalar":try{a.push(ni(n.T,c,n.L,!0))}catch(l){let m=`cannot decode field ${i.typeName}.${n.name} from JSON: ${Pt(c)}`;throw l instanceof Error&&l.message.length>0&&(m+=`: ${l.message}`),new Error(m)}break}}}else if(n.kind=="map"){if(t===null)return;if(typeof t!="object"||Array.isArray(t))throw new Error(`cannot decode field ${i.typeName}.${n.name} from JSON: ${Pt(t)}`);const a=e[s];for(const[c,u]of Object.entries(t)){if(u===null)throw new Error(`cannot decode field ${i.typeName}.${n.name} from JSON: map value null`);let l;try{l=V1(n.K,c)}catch(m){let g=`cannot decode map key for field ${i.typeName}.${n.name} from JSON: ${Pt(t)}`;throw m instanceof Error&&m.message.length>0&&(g+=`: ${m.message}`),new Error(g)}switch(n.V.kind){case"message":a[l]=n.V.T.fromJson(u,r);break;case"enum":const m=Ya(n.V.T,u,r.ignoreUnknownFields,!0);m!==Ls&&(a[l]=m);break;case"scalar":try{a[l]=ni(n.V.T,u,on.BIGINT,!0)}catch(g){let d=`cannot decode map value for field ${i.typeName}.${n.name} from JSON: ${Pt(t)}`;throw g instanceof Error&&g.message.length>0&&(d+=`: ${g.message}`),new Error(d)}break}}}else switch(n.oneof&&(e=e[n.oneof.localName]={case:s},s="value"),n.kind){case"message":const a=n.T;if(t===null&&a.typeName!="google.protobuf.Value")return;let c=e[s];Pn(c)?c.fromJson(t,r):(e[s]=c=a.fromJson(t,r),a.fieldWrapper&&!n.oneof&&(e[s]=a.fieldWrapper.unwrapField(c)));break;case"enum":const u=Ya(n.T,t,r.ignoreUnknownFields,!1);switch(u){case Ns:xd(n,e);break;case Ls:break;default:e[s]=u;break}break;case"scalar":try{const l=ni(n.T,t,n.L,!1);switch(l){case Ns:xd(n,e);break;default:e[s]=l;break}}catch(l){let m=`cannot decode field ${i.typeName}.${n.name} from JSON: ${Pt(t)}`;throw l instanceof Error&&l.message.length>0&&(m+=`: ${l.message}`),new Error(m)}break}}function V1(e,t){if(e===T.BOOL)switch(t){case"true":t=!0;break;case"false":t=!1;break}return ni(e,t,on.BIGINT,!0).toString()}function ni(e,t,n,r){if(t===null)return r?fr(e,n):Ns;switch(e){case T.DOUBLE:case T.FLOAT:if(t==="NaN")return Number.NaN;if(t==="Infinity")return Number.POSITIVE_INFINITY;if(t==="-Infinity")return Number.NEGATIVE_INFINITY;if(t===""||typeof t=="string"&&t.trim().length!==t.length||typeof t!="string"&&typeof t!="number")break;const i=Number(t);if(Number.isNaN(i)||!Number.isFinite(i))break;return e==T.FLOAT&&kd(i),i;case T.INT32:case T.FIXED32:case T.SFIXED32:case T.SINT32:case T.UINT32:let s;if(typeof t=="number"?s=t:typeof t=="string"&&t.length>0&&t.trim().length===t.length&&(s=Number(t)),s===void 0)break;return e==T.UINT32||e==T.FIXED32?Ka(s):Is(s),s;case T.INT64:case T.SFIXED64:case T.SINT64:if(typeof t!="number"&&typeof t!="string")break;const a=Le.parse(t);return n?a.toString():a;case T.FIXED64:case T.UINT64:if(typeof t!="number"&&typeof t!="string")break;const c=Le.uParse(t);return n?c.toString():c;case T.BOOL:if(typeof t!="boolean")break;return t;case T.STRING:if(typeof t!="string")break;try{encodeURIComponent(t)}catch{throw new Error("invalid UTF8")}return t;case T.BYTES:if(t==="")return new Uint8Array(0);if(typeof t!="string")break;return Ts.dec(t)}throw new Error}function Ya(e,t,n,r){if(t===null)return e.typeName=="google.protobuf.NullValue"?0:r?e.values[0].no:Ns;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":const i=e.findName(t);if(i!==void 0)return i.no;if(n)return Ls;break}throw new Error(`cannot decode enum ${e.typeName} from JSON: ${Pt(t)}`)}function q1(e){return e.repeated||e.kind=="map"?!0:!(e.oneof||e.kind=="message"||e.opt||e.req)}function zd(e,t,n){if(e.kind=="map"){pe(typeof t=="object"&&t!=null);const r={},i=Object.entries(t);switch(e.V.kind){case"scalar":for(const[a,c]of i)r[a.toString()]=As(e.V.T,c);break;case"message":for(const[a,c]of i)r[a.toString()]=c.toJson(n);break;case"enum":const s=e.V.T;for(const[a,c]of i)r[a.toString()]=Xa(s,c,n.enumAsInteger);break}return n.emitDefaultValues||i.length>0?r:void 0}if(e.repeated){pe(Array.isArray(t));const r=[];switch(e.kind){case"scalar":for(let i=0;i<t.length;i++)r.push(As(e.T,t[i]));break;case"enum":for(let i=0;i<t.length;i++)r.push(Xa(e.T,t[i],n.enumAsInteger));break;case"message":for(let i=0;i<t.length;i++)r.push(t[i].toJson(n));break}return n.emitDefaultValues||r.length>0?r:void 0}switch(e.kind){case"scalar":return As(e.T,t);case"enum":return Xa(e.T,t,n.enumAsInteger);case"message":return Md(e.T,t).toJson(n)}}function Xa(e,t,n){var r;if(pe(typeof t=="number"),e.typeName=="google.protobuf.NullValue")return null;if(n)return t;const i=e.findNumber(t);return(r=i==null?void 0:i.name)!==null&&r!==void 0?r:t}function As(e,t){switch(e){case T.INT32:case T.SFIXED32:case T.SINT32:case T.FIXED32:case T.UINT32:return pe(typeof t=="number"),t;case T.FLOAT:case T.DOUBLE:return pe(typeof t=="number"),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t;case T.STRING:return pe(typeof t=="string"),t;case T.BOOL:return pe(typeof t=="boolean"),t;case T.UINT64:case T.FIXED64:case T.INT64:case T.SFIXED64:case T.SINT64:return pe(typeof t=="bigint"||typeof t=="string"||typeof t=="number"),t.toString();case T.BYTES:return pe(t instanceof Uint8Array),Ts.enc(t)}}const dr=Symbol("@bufbuild/protobuf/unknown-fields"),Vd={readUnknownFields:!0,readerFactory:e=>new C1(e)},qd={writeUnknownFields:!0,writerFactory:()=>new _1};function G1(e){return e?Object.assign(Object.assign({},Vd),e):Vd}function Z1(e){return e?Object.assign(Object.assign({},qd),e):qd}function J1(){return{makeReadOptions:G1,makeWriteOptions:Z1,listUnknownFields(e){var t;return(t=e[dr])!==null&&t!==void 0?t:[]},discardUnknownFields(e){delete e[dr]},writeUnknownFields(e,t){const r=e[dr];if(r)for(const i of r)t.tag(i.no,i.wireType).raw(i.data)},onUnknownField(e,t,n,r){const i=e;Array.isArray(i[dr])||(i[dr]=[]),i[dr].push({no:t,wireType:n,data:r})},readMessage(e,t,n,r,i){const s=e.getType(),a=i?t.len:t.pos+n;let c,u;for(;t.pos<a&&([c,u]=t.tag(),!(i===!0&&u==ve.EndGroup));){const l=s.fields.find(c);if(!l){const m=t.skip(u,c);r.readUnknownFields&&this.onUnknownField(e,c,u,m);continue}Gd(e,t,l,u,r)}if(i&&(u!=ve.EndGroup||c!==n))throw new Error("invalid end group tag")},readField:Gd,writeMessage(e,t,n){const r=e.getType();for(const i of r.fields.byNumber()){if(!Ud(i,e)){if(i.req)throw new Error(`cannot encode field ${r.typeName}.${i.name} to binary: required field not set`);continue}const s=i.oneof?e[i.oneof.localName].value:e[i.localName];Zd(i,s,t,n)}return n.writeUnknownFields&&this.writeUnknownFields(e,t),t},writeField(e,t,n,r){t!==void 0&&Zd(e,t,n,r)}}}function Gd(e,t,n,r,i){let{repeated:s,localName:a}=n;switch(n.oneof&&(e=e[n.oneof.localName],e.case!=a&&delete e.value,e.case=a,a="value"),n.kind){case"scalar":case"enum":const c=n.kind=="enum"?T.INT32:n.T;let u=Rs;if(n.kind=="scalar"&&n.L>0&&(u=W1),s){let d=e[a];if(r==ve.LengthDelimited&&c!=T.STRING&&c!=T.BYTES){let y=t.uint32()+t.pos;for(;t.pos<y;)d.push(u(t,c))}else d.push(u(t,c))}else e[a]=u(t,c);break;case"message":const l=n.T;s?e[a].push(Ps(t,new l,i,n)):Pn(e[a])?Ps(t,e[a],i,n):(e[a]=Ps(t,new l,i,n),l.fieldWrapper&&!n.oneof&&!n.repeated&&(e[a]=l.fieldWrapper.unwrapField(e[a])));break;case"map":let[m,g]=K1(n,t,i);e[a][m]=g;break}}function Ps(e,t,n,r){const i=t.getType().runtime.bin,s=r==null?void 0:r.delimited;return i.readMessage(t,e,s?r.no:e.uint32(),n,s),t}function K1(e,t,n){const r=t.uint32(),i=t.pos+r;let s,a;for(;t.pos<i;){const[c]=t.tag();switch(c){case 1:s=Rs(t,e.K);break;case 2:switch(e.V.kind){case"scalar":a=Rs(t,e.V.T);break;case"enum":a=t.int32();break;case"message":a=Ps(t,new e.V.T,n,void 0);break}break}}if(s===void 0&&(s=fr(e.K,on.BIGINT)),typeof s!="string"&&typeof s!="number"&&(s=s.toString()),a===void 0)switch(e.V.kind){case"scalar":a=fr(e.V.T,on.BIGINT);break;case"enum":a=e.V.T.values[0].no;break;case"message":a=new e.V.T;break}return[s,a]}function W1(e,t){const n=Rs(e,t);return typeof n=="bigint"?n.toString():n}function Rs(e,t){switch(t){case T.STRING:return e.string();case T.BOOL:return e.bool();case T.DOUBLE:return e.double();case T.FLOAT:return e.float();case T.INT32:return e.int32();case T.INT64:return e.int64();case T.UINT64:return e.uint64();case T.FIXED64:return e.fixed64();case T.BYTES:return e.bytes();case T.FIXED32:return e.fixed32();case T.SFIXED32:return e.sfixed32();case T.SFIXED64:return e.sfixed64();case T.SINT64:return e.sint64();case T.UINT32:return e.uint32();case T.SINT32:return e.sint32()}}function Zd(e,t,n,r){pe(t!==void 0);const i=e.repeated;switch(e.kind){case"scalar":case"enum":let s=e.kind=="enum"?T.INT32:e.T;if(i)if(pe(Array.isArray(t)),e.packed)Y1(n,s,e.no,t);else for(const a of t)ri(n,s,e.no,a);else ri(n,s,e.no,t);break;case"message":if(i){pe(Array.isArray(t));for(const a of t)Jd(n,r,e,a)}else Jd(n,r,e,t);break;case"map":pe(typeof t=="object"&&t!=null);for(const[a,c]of Object.entries(t))H1(n,r,e,a,c);break}}function H1(e,t,n,r,i){e.tag(n.no,ve.LengthDelimited),e.fork();let s=r;switch(n.K){case T.INT32:case T.FIXED32:case T.UINT32:case T.SFIXED32:case T.SINT32:s=Number.parseInt(r);break;case T.BOOL:pe(r=="true"||r=="false"),s=r=="true";break}switch(ri(e,n.K,1,s),n.V.kind){case"scalar":ri(e,n.V.T,2,i);break;case"enum":ri(e,T.INT32,2,i);break;case"message":pe(i!==void 0),e.tag(2,ve.LengthDelimited).bytes(i.toBinary(t));break}e.join()}function Jd(e,t,n,r){const i=Md(n.T,r);n.delimited?e.tag(n.no,ve.StartGroup).raw(i.toBinary(t)).tag(n.no,ve.EndGroup):e.tag(n.no,ve.LengthDelimited).bytes(i.toBinary(t))}function ri(e,t,n,r){pe(r!==void 0);let[i,s]=Kd(t);e.tag(n,i)[s](r)}function Y1(e,t,n,r){if(!r.length)return;e.tag(n,ve.LengthDelimited).fork();let[,i]=Kd(t);for(let s=0;s<r.length;s++)e[i](r[s]);e.join()}function Kd(e){let t=ve.Varint;switch(e){case T.BYTES:case T.STRING:t=ve.LengthDelimited;break;case T.DOUBLE:case T.FIXED64:case T.SFIXED64:t=ve.Bit64;break;case T.FIXED32:case T.SFIXED32:case T.FLOAT:t=ve.Bit32;break}const n=T[e].toLowerCase();return[t,n]}function X1(){return{setEnumType:Id,initPartial(e,t){if(e===void 0)return;const n=t.getType();for(const r of n.fields.byMember()){const i=r.localName,s=t,a=e;if(a[i]!=null)switch(r.kind){case"oneof":const c=a[i].case;if(c===void 0)continue;const u=r.findField(c);let l=a[i].value;u&&u.kind=="message"&&!Pn(l,u.T)?l=new u.T(l):u&&u.kind==="scalar"&&u.T===T.BYTES&&(l=ii(l)),s[i]={case:c,value:l};break;case"scalar":case"enum":let m=a[i];r.T===T.BYTES&&(m=r.repeated?m.map(ii):ii(m)),s[i]=m;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===T.BYTES)for(const[p,y]of Object.entries(a[i]))s[i][p]=ii(y);else Object.assign(s[i],a[i]);break;case"message":const d=r.V.T;for(const p of Object.keys(a[i])){let y=a[i][p];d.fieldWrapper||(y=new d(y)),s[i][p]=y}break}break;case"message":const g=r.T;if(r.repeated)s[i]=a[i].map(d=>Pn(d,g)?d:new g(d));else{const d=a[i];g.fieldWrapper?g.typeName==="google.protobuf.BytesValue"?s[i]=ii(d):s[i]=d:s[i]=Pn(d,g)?d:new g(d)}break}}},equals(e,t,n){return t===n?!0:!t||!n?!1:e.fields.byMember().every(r=>{const i=t[r.localName],s=n[r.localName];if(r.repeated){if(i.length!==s.length)return!1;switch(r.kind){case"message":return i.every((a,c)=>r.T.equals(a,s[c]));case"scalar":return i.every((a,c)=>an(r.T,a,s[c]));case"enum":return i.every((a,c)=>an(T.INT32,a,s[c]))}throw new Error(`repeated cannot contain ${r.kind}`)}switch(r.kind){case"message":return r.T.equals(i,s);case"enum":return an(T.INT32,i,s);case"scalar":return an(r.T,i,s);case"oneof":if(i.case!==s.case)return!1;const a=r.findField(i.case);if(a===void 0)return!0;switch(a.kind){case"message":return a.T.equals(i.value,s.value);case"enum":return an(T.INT32,i.value,s.value);case"scalar":return an(a.T,i.value,s.value)}throw new Error(`oneof cannot contain ${a.kind}`);case"map":const c=Object.keys(i).concat(Object.keys(s));switch(r.V.kind){case"message":const u=r.V.T;return c.every(m=>u.equals(i[m],s[m]));case"enum":return c.every(m=>an(T.INT32,i[m],s[m]));case"scalar":const l=r.V.T;return c.every(m=>an(l,i[m],s[m]))}break}})},clone(e){const t=e.getType(),n=new t,r=n;for(const i of t.fields.byMember()){const s=e[i.localName];let a;if(i.repeated)a=s.map(_s);else if(i.kind=="map"){a=r[i.localName];for(const[c,u]of Object.entries(s))a[c]=_s(u)}else i.kind=="oneof"?a=i.findField(s.case)?{case:s.case,value:_s(s.value)}:{case:void 0}:a=_s(s);r[i.localName]=a}for(const i of t.runtime.bin.listUnknownFields(e))t.runtime.bin.onUnknownField(r,i.no,i.wireType,i.data);return n}}}function _s(e){if(e===void 0)return e;if(Pn(e))return e.clone();if(e instanceof Uint8Array){const t=new Uint8Array(e.byteLength);return t.set(e),t}return e}function ii(e){return e instanceof Uint8Array?e:new Uint8Array(e)}function Q1(e,t,n){return{syntax:e,json:z1(),bin:J1(),util:Object.assign(Object.assign({},X1()),{newFieldList:t,initFields:n}),makeMessageType(r,i,s){return T1(this,r,i,s)},makeEnum:E1,makeEnumType:$d,getEnumType:$1,makeExtension(r,i,s){return j1(this,r,i,s)}}}class eA{constructor(t,n){this._fields=t,this._normalizer=n}findJsonName(t){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[t]}find(t){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[t]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((t,n)=>t.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const t=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,t.push(n)):t.push(r)}return this.members}}function Wd(e,t){const n=Hd(e);return t?n:oA(sA(n))}function tA(e){return Wd(e,!1)}const nA=Hd;function Hd(e){let t=!1;const n=[];for(let r=0;r<e.length;r++){let i=e.charAt(r);switch(i){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),t=!1;break;default:t&&(t=!1,i=i.toUpperCase()),n.push(i);break}}return n.join("")}const rA=new Set(["constructor","toString","toJSON","valueOf"]),iA=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Yd=e=>`${e}$`,sA=e=>iA.has(e)?Yd(e):e,oA=e=>rA.has(e)?Yd(e):e;class aA{constructor(t){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=t,this.localName=tA(t)}addField(t){pe(t.oneof===this,`field ${t.name} not one of ${this.name}`),this.fields.push(t)}findField(t){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[t]}}function cA(e,t){var n,r,i,s,a,c;const u=[];let l;for(const m of typeof e=="function"?e():e){const g=m;if(g.localName=Wd(m.name,m.oneof!==void 0),g.jsonName=(n=m.jsonName)!==null&&n!==void 0?n:nA(m.name),g.repeated=(r=m.repeated)!==null&&r!==void 0?r:!1,m.kind=="scalar"&&(g.L=(i=m.L)!==null&&i!==void 0?i:on.BIGINT),g.delimited=(s=m.delimited)!==null&&s!==void 0?s:!1,g.req=(a=m.req)!==null&&a!==void 0?a:!1,g.opt=(c=m.opt)!==null&&c!==void 0?c:!1,m.packed===void 0&&(t?g.packed=m.kind=="enum"||m.kind=="scalar"&&m.T!=T.BYTES&&m.T!=T.STRING:g.packed=!1),m.oneof!==void 0){const d=typeof m.oneof=="string"?m.oneof:m.oneof.name;(!l||l.name!=d)&&(l=new aA(d)),g.oneof=l,l.addField(g)}u.push(g)}return u}const O=Q1("proto3",e=>new eA(e,t=>cA(t,!0)),e=>{for(const t of e.getType().fields.byMember()){if(t.opt)continue;const n=t.localName,r=e;if(t.repeated){r[n]=[];continue}switch(t.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=fr(t.T,t.L);break}}});var K;(function(e){e[e.Unary=0]="Unary",e[e.ServerStreaming=1]="ServerStreaming",e[e.ClientStreaming=2]="ClientStreaming",e[e.BiDiStreaming=3]="BiDiStreaming"})(K||(K={}));var Qa;(function(e){e[e.NoSideEffects=1]="NoSideEffects",e[e.Idempotent=2]="Idempotent"})(Qa||(Qa={}));class Ve extends An{constructor(t){super(),this.seconds=Le.zero,this.nanos=0,O.util.initPartial(t,this)}fromJson(t,n){if(typeof t!="string")throw new Error(`cannot decode google.protobuf.Timestamp from JSON: ${O.json.debug(t)}`);const r=t.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Le.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(t){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Ve.fromDate(new Date)}static fromDate(t){const n=t.getTime();return new Ve({seconds:Le.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(t,n){return new Ve().fromBinary(t,n)}static fromJson(t,n){return new Ve().fromJson(t,n)}static fromJsonString(t,n){return new Ve().fromJsonString(t,n)}static equals(t,n){return O.util.equals(Ve,t,n)}}Ve.runtime=O,Ve.typeName="google.protobuf.Timestamp",Ve.fields=O.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);class Vt extends An{constructor(t){super(),this.seconds=Le.zero,this.nanos=0,O.util.initPartial(t,this)}fromJson(t,n){if(typeof t!="string")throw new Error(`cannot decode google.protobuf.Duration from JSON: ${O.json.debug(t)}`);const r=t.match(/^(-?[0-9]+)(?:\.([0-9]+))?s/);if(r===null)throw new Error(`cannot decode google.protobuf.Duration from JSON: ${O.json.debug(t)}`);const i=Number(r[1]);if(i>315576e6||i<-315576e6)throw new Error(`cannot decode google.protobuf.Duration from JSON: ${O.json.debug(t)}`);if(this.seconds=Le.parse(i),typeof r[2]=="string"){const s=r[2]+"0".repeat(9-r[2].length);this.nanos=parseInt(s),(i<0||Object.is(i,-0))&&(this.nanos=-this.nanos)}return this}toJson(t){if(Number(this.seconds)>315576e6||Number(this.seconds)<-315576e6)throw new Error("cannot encode google.protobuf.Duration to JSON: value out of range");let n=this.seconds.toString();if(this.nanos!==0){let r=Math.abs(this.nanos).toString();r="0".repeat(9-r.length)+r,r.substring(3)==="000000"?r=r.substring(0,3):r.substring(6)==="000"&&(r=r.substring(0,6)),n+="."+r,this.nanos<0&&Number(this.seconds)==0&&(n="-"+n)}return n+"s"}static fromBinary(t,n){return new Vt().fromBinary(t,n)}static fromJson(t,n){return new Vt().fromJson(t,n)}static fromJsonString(t,n){return new Vt().fromJsonString(t,n)}static equals(t,n){return O.util.equals(Vt,t,n)}}Vt.runtime=O,Vt.typeName="google.protobuf.Duration",Vt.fields=O.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var si;(function(e){e[e.NULL_VALUE=0]="NULL_VALUE"})(si||(si={})),O.util.setEnumType(si,"google.protobuf.NullValue",[{no:0,name:"NULL_VALUE"}]);class $t extends An{constructor(t){super(),this.fields={},O.util.initPartial(t,this)}toJson(t){const n={};for(const[r,i]of Object.entries(this.fields))n[r]=i.toJson(t);return n}fromJson(t,n){if(typeof t!="object"||t==null||Array.isArray(t))throw new Error("cannot decode google.protobuf.Struct from JSON "+O.json.debug(t));for(const[r,i]of Object.entries(t))this.fields[r]=mt.fromJson(i);return this}static fromBinary(t,n){return new $t().fromBinary(t,n)}static fromJson(t,n){return new $t().fromJson(t,n)}static fromJsonString(t,n){return new $t().fromJsonString(t,n)}static equals(t,n){return O.util.equals($t,t,n)}}$t.runtime=O,$t.typeName="google.protobuf.Struct",$t.fields=O.util.newFieldList(()=>[{no:1,name:"fields",kind:"map",K:9,V:{kind:"message",T:mt}}]);class mt extends An{constructor(t){super(),this.kind={case:void 0},O.util.initPartial(t,this)}toJson(t){switch(this.kind.case){case"nullValue":return null;case"numberValue":if(!Number.isFinite(this.kind.value))throw new Error("google.protobuf.Value cannot be NaN or Infinity");return this.kind.value;case"boolValue":return this.kind.value;case"stringValue":return this.kind.value;case"structValue":case"listValue":return this.kind.value.toJson(Object.assign(Object.assign({},t),{emitDefaultValues:!0}))}throw new Error("google.protobuf.Value must have a value")}fromJson(t,n){switch(typeof t){case"number":this.kind={case:"numberValue",value:t};break;case"string":this.kind={case:"stringValue",value:t};break;case"boolean":this.kind={case:"boolValue",value:t};break;case"object":t===null?this.kind={case:"nullValue",value:si.NULL_VALUE}:Array.isArray(t)?this.kind={case:"listValue",value:Rt.fromJson(t)}:this.kind={case:"structValue",value:$t.fromJson(t)};break;default:throw new Error("cannot decode google.protobuf.Value from JSON "+O.json.debug(t))}return this}static fromBinary(t,n){return new mt().fromBinary(t,n)}static fromJson(t,n){return new mt().fromJson(t,n)}static fromJsonString(t,n){return new mt().fromJsonString(t,n)}static equals(t,n){return O.util.equals(mt,t,n)}}mt.runtime=O,mt.typeName="google.protobuf.Value",mt.fields=O.util.newFieldList(()=>[{no:1,name:"null_value",kind:"enum",T:O.getEnumType(si),oneof:"kind"},{no:2,name:"number_value",kind:"scalar",T:1,oneof:"kind"},{no:3,name:"string_value",kind:"scalar",T:9,oneof:"kind"},{no:4,name:"bool_value",kind:"scalar",T:8,oneof:"kind"},{no:5,name:"struct_value",kind:"message",T:$t,oneof:"kind"},{no:6,name:"list_value",kind:"message",T:Rt,oneof:"kind"}]);class Rt extends An{constructor(t){super(),this.values=[],O.util.initPartial(t,this)}toJson(t){return this.values.map(n=>n.toJson())}fromJson(t,n){if(!Array.isArray(t))throw new Error("cannot decode google.protobuf.ListValue from JSON "+O.json.debug(t));for(let r of t)this.values.push(mt.fromJson(r));return this}static fromBinary(t,n){return new Rt().fromBinary(t,n)}static fromJson(t,n){return new Rt().fromJson(t,n)}static fromJsonString(t,n){return new Rt().fromJsonString(t,n)}static equals(t,n){return O.util.equals(Rt,t,n)}}Rt.runtime=O,Rt.typeName="google.protobuf.ListValue",Rt.fields=O.util.newFieldList(()=>[{no:1,name:"values",kind:"message",T:mt,repeated:!0}]);var W;(function(e){e[e.Canceled=1]="Canceled",e[e.Unknown=2]="Unknown",e[e.InvalidArgument=3]="InvalidArgument",e[e.DeadlineExceeded=4]="DeadlineExceeded",e[e.NotFound=5]="NotFound",e[e.AlreadyExists=6]="AlreadyExists",e[e.PermissionDenied=7]="PermissionDenied",e[e.ResourceExhausted=8]="ResourceExhausted",e[e.FailedPrecondition=9]="FailedPrecondition",e[e.Aborted=10]="Aborted",e[e.OutOfRange=11]="OutOfRange",e[e.Unimplemented=12]="Unimplemented",e[e.Internal=13]="Internal",e[e.Unavailable=14]="Unavailable",e[e.DataLoss=15]="DataLoss",e[e.Unauthenticated=16]="Unauthenticated"})(W||(W={}));function ec(e){const t=W[e];return typeof t!="string"?e.toString():t[0].toLowerCase()+t.substring(1).replace(/[A-Z]/g,n=>"_"+n.toLowerCase())}let Cs;function uA(e){if(!Cs){Cs={};for(const t of Object.values(W))typeof t!="string"&&(Cs[ec(t)]=t)}return Cs[e]}class Me extends Error{constructor(t,n=W.Unknown,r,i,s){super(lA(t,n)),this.name="ConnectError",Object.setPrototypeOf(this,new.target.prototype),this.rawMessage=t,this.code=n,this.metadata=new Headers(r??{}),this.details=i??[],this.cause=s}static from(t,n=W.Unknown){return t instanceof Me?t:t instanceof Error?t.name=="AbortError"?new Me(t.message,W.Canceled):new Me(t.message,n,void 0,void 0,t):new Me(String(t),n,void 0,void 0,t)}static[Symbol.hasInstance](t){return t instanceof Error?Object.getPrototypeOf(t)===Me.prototype?!0:t.name==="ConnectError"&&"code"in t&&typeof t.code=="number"&&"metadata"in t&&"details"in t&&Array.isArray(t.details)&&"rawMessage"in t&&typeof t.rawMessage=="string"&&"cause"in t:!1}findDetails(t){const n="typeName"in t?{findMessage:i=>i===t.typeName?t:void 0}:t,r=[];for(const i of this.details){if("getType"in i){n.findMessage(i.getType().typeName)&&r.push(i);continue}const s=n.findMessage(i.type);if(s)try{r.push(s.fromBinary(i.value))}catch{}}return r}}function lA(e,t){return e.length?`[${ec(t)}] ${e}`:`[${ec(t)}]`}function fA(...e){const t=new Headers;for(const n of e)n.forEach((r,i)=>{t.append(i,r)});return t}function dA(e,t){const n={};for(const[r,i]of Object.entries(e.methods)){const s=t(Object.assign(Object.assign({},i),{localName:r,service:e}));s!=null&&(n[r]=s)}return n}function pA(e){let t,n=new Uint8Array(0);function r(i){const s=new Uint8Array(n.length+i.length);s.set(n),s.set(i,n.length),n=s}return new ReadableStream({start(){t=e.getReader()},async pull(i){let s;for(;;){if(s===void 0&&n.byteLength>=5){let u=0;for(let l=1;l<5;l++)u=(u<<8)+n[l];s={flags:n[0],length:u}}if(s!==void 0&&n.byteLength>=s.length+5)break;const c=await t.read();if(c.done)break;r(c.value)}if(s===void 0){if(n.byteLength==0){i.close();return}i.error(new Me("premature end of stream",W.DataLoss));return}const a=n.subarray(5,5+s.length);n=n.subarray(5+s.length),i.enqueue({flags:s.flags,data:a})}})}function hA(e,t){const n=new Uint8Array(t.length+5);n.set(t,5);const r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.setUint8(0,e),r.setUint32(1,t.length),n}var mA=globalThis&&globalThis.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(a){return new Promise(function(c,u){a=e[s](a),i(c,u,a.done,a.value)})}}function i(s,a,c,u){Promise.resolve(u).then(function(l){s({value:l,done:c})},a)}},oi=globalThis&&globalThis.__await||function(e){return this instanceof oi?(this.v=e,this):new oi(e)},gA=globalThis&&globalThis.__asyncGenerator||function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i={},c("next"),c("throw"),c("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(p){return function(y){return Promise.resolve(y).then(p,g)}}function c(p,y){r[p]&&(i[p]=function(w){return new Promise(function(b,P){s.push([p,w,b,P])>1||u(p,w)})},y&&(i[p]=y(i[p])))}function u(p,y){try{l(r[p](y))}catch(w){d(s[0][3],w)}}function l(p){p.value instanceof oi?Promise.resolve(p.value.v).then(m,g):d(s[0][2],p)}function m(p){u("next",p)}function g(p){u("throw",p)}function d(p,y){p(y),s.shift(),s.length&&u(s[0][0],s[0][1])}},yA=globalThis&&globalThis.__asyncDelegator||function(e){var t,n;return t={},r("next"),r("throw",function(i){throw i}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(i,s){t[i]=e[i]?function(a){return(n=!n)?{value:oi(e[i](a)),done:!1}:s?s(a):a}:s}};function wA(e){return gA(this,arguments,function*(){yield oi(yield*yA(mA(e)))})}var Xd=globalThis&&globalThis.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(a){return new Promise(function(c,u){a=e[s](a),i(c,u,a.done,a.value)})}}function i(s,a,c,u){Promise.resolve(u).then(function(l){s({value:l,done:c})},a)}},pr=globalThis&&globalThis.__await||function(e){return this instanceof pr?(this.v=e,this):new pr(e)},bA=globalThis&&globalThis.__asyncDelegator||function(e){var t,n;return t={},r("next"),r("throw",function(i){throw i}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(i,s){t[i]=e[i]?function(a){return(n=!n)?{value:pr(e[i](a)),done:!1}:s?s(a):a}:s}},vA=globalThis&&globalThis.__asyncGenerator||function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i={},c("next"),c("throw"),c("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(p){return function(y){return Promise.resolve(y).then(p,g)}}function c(p,y){r[p]&&(i[p]=function(w){return new Promise(function(b,P){s.push([p,w,b,P])>1||u(p,w)})},y&&(i[p]=y(i[p])))}function u(p,y){try{l(r[p](y))}catch(w){d(s[0][3],w)}}function l(p){p.value instanceof pr?Promise.resolve(p.value.v).then(m,g):d(s[0][2],p)}function m(p){u("next",p)}function g(p){u("throw",p)}function d(p,y){p(y),s.shift(),s.length&&u(s[0][0],s[0][1])}};function js(e,t){return dA(e,n=>{switch(n.kind){case K.Unary:return SA(t,e,n);case K.ServerStreaming:return kA(t,e,n);case K.ClientStreaming:return OA(t,e,n);case K.BiDiStreaming:return IA(t,e,n);default:return null}})}function SA(e,t,n){return async function(r,i){var s,a;const c=await e.unary(t,n,i==null?void 0:i.signal,i==null?void 0:i.timeoutMs,i==null?void 0:i.headers,r,i==null?void 0:i.contextValues);return(s=i==null?void 0:i.onHeader)===null||s===void 0||s.call(i,c.header),(a=i==null?void 0:i.onTrailer)===null||a===void 0||a.call(i,c.trailer),c.message}}function kA(e,t,n){return function(r,i){return Qd(e.stream(t,n,i==null?void 0:i.signal,i==null?void 0:i.timeoutMs,i==null?void 0:i.headers,wA([r]),i==null?void 0:i.contextValues),i)}}function OA(e,t,n){return async function(r,i){var s,a,c,u,l,m;const g=await e.stream(t,n,i==null?void 0:i.signal,i==null?void 0:i.timeoutMs,i==null?void 0:i.headers,r,i==null?void 0:i.contextValues);(l=i==null?void 0:i.onHeader)===null||l===void 0||l.call(i,g.header);let d;try{for(var p=!0,y=Xd(g.message),w;w=await y.next(),s=w.done,!s;p=!0)u=w.value,p=!1,d=u}catch(b){a={error:b}}finally{try{!p&&!s&&(c=y.return)&&await c.call(y)}finally{if(a)throw a.error}}if(!d)throw new Me("protocol error: missing response message",W.Internal);return(m=i==null?void 0:i.onTrailer)===null||m===void 0||m.call(i,g.trailer),d}}function IA(e,t,n){return function(r,i){return Qd(e.stream(t,n,i==null?void 0:i.signal,i==null?void 0:i.timeoutMs,i==null?void 0:i.headers,r,i==null?void 0:i.contextValues),i)}}function Qd(e,t){const n=function(){var r,i;return vA(this,arguments,function*(){const s=yield pr(e);(r=t==null?void 0:t.onHeader)===null||r===void 0||r.call(t,s.header),yield pr(yield*bA(Xd(s.message))),(i=t==null?void 0:t.onTrailer)===null||i===void 0||i.call(t,s.trailer)})}()[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:()=>n.next()})}}function $A(...e){const t=new AbortController,n=e.filter(i=>i!==void 0).concat(t.signal);for(const i of n){if(i.aborted){r.apply(i);break}i.addEventListener("abort",r)}function r(){t.signal.aborted||t.abort(ep(this));for(const i of n)i.removeEventListener("abort",r)}return t}function EA(e){const t=new AbortController,n=()=>{t.abort(new Me("the operation timed out",W.DeadlineExceeded))};let r;return e!==void 0&&(e<=0?n():r=setTimeout(n,e)),{signal:t.signal,cleanup:()=>clearTimeout(r)}}function ep(e){if(!e.aborted)return;if(e.reason!==void 0)return e.reason;const t=new Error("This operation was aborted");return t.name="AbortError",t}function tp(){return{get(e){return e.id in this?this[e.id]:e.defaultValue},set(e,t){return this[e.id]=t,this},delete(e){return delete this[e.id],this}}}function np(e,t,n){const r=typeof t=="string"?t:t.typeName,i=typeof n=="string"?n:n.name;return e.toString().replace(/\/?$/,`/${r}/${i}`)}function rp(e,t){return t instanceof e?t:new e(t)}function TA(e,t){function n(r){return r.done===!0?r:{done:r.done,value:rp(e,r.value)}}return{[Symbol.asyncIterator](){const r=t[Symbol.asyncIterator](),i={next:()=>r.next().then(n)};return r.throw!==void 0&&(i.throw=s=>r.throw(s).then(n)),r.return!==void 0&&(i.return=s=>r.return(s).then(n)),i}}}function ip(e,t){var n;return(n=t==null?void 0:t.concat().reverse().reduce((r,i)=>i(r),e))!==null&&n!==void 0?n:e}function sp(e){var t;const n=Object.assign({},e);return(t=n.ignoreUnknownFields)!==null&&t!==void 0||(n.ignoreUnknownFields=!0),n}function op(e,t,n,r){const i=t?ap(e.I,r):cp(e.I,n);return{parse:(t?ap(e.O,r):cp(e.O,n)).parse,serialize:i.serialize}}function ap(e,t){return{parse(n){try{return e.fromBinary(n,t)}catch(r){const i=r instanceof Error?r.message:String(r);throw new Me(`parse binary: ${i}`,W.InvalidArgument)}},serialize(n){try{return n.toBinary(t)}catch(r){const i=r instanceof Error?r.message:String(r);throw new Me(`serialize binary: ${i}`,W.Internal)}}}}function cp(e,t){var n,r;const i=(n=t==null?void 0:t.textEncoder)!==null&&n!==void 0?n:new TextEncoder,s=(r=t==null?void 0:t.textDecoder)!==null&&r!==void 0?r:new TextDecoder,a=sp(t);return{parse(c){try{const u=s.decode(c);return e.fromJsonString(u,a)}catch(u){throw Me.from(u,W.InvalidArgument)}},serialize(c){try{const u=c.toJsonString(a);return i.encode(u)}catch(u){throw Me.from(u,W.Internal)}}}}const NA=/^application\/(connect\+)?(?:(json)(?:; ?charset=utf-?8)?|(proto))$/i,LA="application/proto",AA="application/json",PA="application/connect+proto",RA="application/connect+json";function _A(e){const t=e==null?void 0:e.match(NA);if(!t)return;const n=!!t[1],r=!!t[3];return{stream:n,binary:r}}globalThis&&globalThis.__rest;function up(e,t,n){if(t&&new Headers(t).forEach((a,c)=>n.metadata.append(c,a)),typeof e!="object"||e==null||Array.isArray(e)||!("code"in e)||typeof e.code!="string")throw n;const r=uA(e.code);if(r===void 0)throw n;const i=e.message;if(i!=null&&typeof i!="string")throw n;const s=new Me(i??"",r,t);if("details"in e&&Array.isArray(e.details))for(const a of e.details){if(a===null||typeof a!="object"||Array.isArray(a)||typeof a.type!="string"||typeof a.value!="string"||"debug"in a&&typeof a.debug!="object")throw n;try{s.details.push({type:a.type,value:Ts.dec(a.value),debug:a.debug})}catch{throw n}}return s}const lp=2;function CA(e){const t=new Me("invalid end stream",W.InvalidArgument);let n;try{n=JSON.parse(typeof e=="string"?e:new TextDecoder().decode(e))}catch{throw t}if(typeof n!="object"||n==null||Array.isArray(n))throw t;const r=new Headers;if("metadata"in n){if(typeof n.metadata!="object"||n.metadata==null||Array.isArray(n.metadata))throw t;for(const[s,a]of Object.entries(n.metadata)){if(!Array.isArray(a)||a.some(c=>typeof c!="string"))throw t;for(const c of a)r.append(s,c)}}const i="error"in n?up(n.error,r,t):void 0;return{metadata:r,error:i}}const tc="Content-Type",jA="Content-Length",fp="Content-Encoding",UA="Accept-Encoding",xA="Connect-Timeout-Ms",dp="Connect-Protocol-Version",MA="User-Agent";function FA(e){switch(e){case 400:return W.InvalidArgument;case 401:return W.Unauthenticated;case 403:return W.PermissionDenied;case 404:return W.Unimplemented;case 408:return W.DeadlineExceeded;case 409:return W.Aborted;case 412:return W.FailedPrecondition;case 413:return W.ResourceExhausted;case 415:return W.Internal;case 429:return W.Unavailable;case 431:return W.ResourceExhausted;case 502:return W.Unavailable;case 503:return W.Unavailable;case 504:return W.Unavailable;default:return W.Unknown}}function pp(e){const t=new Headers,n=new Headers;return e.forEach((r,i)=>{i.toLowerCase().startsWith("trailer-")?n.set(i.substring(8),r):t.set(i,r)}),[t,n]}const hp="1";function mp(e,t,n,r,i){const s=new Headers(r??{});return n!==void 0&&s.set(xA,`${n}`),s.set(tc,e==K.Unary?t?LA:AA:t?PA:RA),s.set(dp,hp),i&&s.set(MA,"connect-es/1.4.0"),s}function gp(e,t,n){const r=n.get("Content-Type"),i=_A(r);if(t!==200){const s=new Me(`HTTP ${t}`,FA(t),n);if(e==K.Unary&&i&&!i.binary)return{isUnaryError:!0,unaryError:s};throw s}return{isUnaryError:!1}}const yp="application/";function DA(e,t){return t?Ts.enc(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):encodeURIComponent(new TextDecoder().decode(e))}function BA(e,t,n){let r=`?connect=v${hp}`;const i=e.header.get(tc);(i==null?void 0:i.indexOf(yp))===0&&(r+="&encoding="+encodeURIComponent(i.slice(yp.length)));const s=e.header.get(fp);s!==null&&s!=="identity"&&(r+="&compression="+encodeURIComponent(s),n=!0),n&&(r+="&base64=1"),r+="&message="+DA(t,n);const a=e.url+r,c=new Headers(e.header);return[dp,tc,jA,fp,UA].forEach(u=>c.delete(u)),Object.assign(Object.assign({},e),{init:Object.assign(Object.assign({},e.init),{method:"GET"}),url:a,header:c})}function zA(e){const t=ip(e.next,e.interceptors),[n,r,i]=wp(e),s=Object.assign(Object.assign({},e.req),{message:rp(e.req.method.I,e.req.message),signal:n});return t(s).then(a=>(i(),a),r)}function VA(e){const t=ip(e.next,e.interceptors),[n,r,i]=wp(e),s=Object.assign(Object.assign({},e.req),{message:TA(e.req.method.I,e.req.message),signal:n});let a=!1;return n.addEventListener("abort",function(){var c,u;const l=e.req.message[Symbol.asyncIterator]();a||(c=l.throw)===null||c===void 0||c.call(l,this.reason).catch(()=>{}),(u=l.return)===null||u===void 0||u.call(l).catch(()=>{})}),t(s).then(c=>Object.assign(Object.assign({},c),{message:{[Symbol.asyncIterator](){const u=c.message[Symbol.asyncIterator]();return{next(){return u.next().then(l=>(l.done==!0&&(a=!0,i()),l),r)}}}}}),r)}function wp(e){const{signal:t,cleanup:n}=EA(e.timeoutMs),r=$A(e.signal,t);return[r.signal,function(s){const a=Me.from(t.aborted?ep(t):s);return r.abort(a),n(),Promise.reject(a)},function(){n(),r.abort()}]}function qA(){try{new Headers}catch{throw new Error("connect-web requires the fetch API. Are you running on an old version of Node.js? Node.js is not supported in Connect for Web - please stay tuned for Connect for Node.")}}var ai=globalThis&&globalThis.__await||function(e){return this instanceof ai?(this.v=e,this):new ai(e)},GA=globalThis&&globalThis.__asyncGenerator||function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i={},c("next"),c("throw"),c("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(p){return function(y){return Promise.resolve(y).then(p,g)}}function c(p,y){r[p]&&(i[p]=function(w){return new Promise(function(b,P){s.push([p,w,b,P])>1||u(p,w)})},y&&(i[p]=y(i[p])))}function u(p,y){try{l(r[p](y))}catch(w){d(s[0][3],w)}}function l(p){p.value instanceof ai?Promise.resolve(p.value.v).then(m,g):d(s[0][2],p)}function m(p){u("next",p)}function g(p){u("throw",p)}function d(p,y){p(y),s.shift(),s.length&&u(s[0][0],s[0][1])}};function Us(e){var t;qA();const n=(t=e.useBinaryFormat)!==null&&t!==void 0?t:!1;return{async unary(r,i,s,a,c,u,l){var m;const{serialize:g,parse:d}=op(i,n,e.jsonOptions,e.binaryOptions);return a=a===void 0?e.defaultTimeoutMs:a<=0?void 0:a,await zA({interceptors:e.interceptors,signal:s,timeoutMs:a,req:{stream:!1,service:r,method:i,url:np(e.baseUrl,r,i),init:{method:"POST",credentials:(m=e.credentials)!==null&&m!==void 0?m:"same-origin",redirect:"error",mode:"cors"},header:mp(i.kind,n,a,c,!1),contextValues:l??tp(),message:u},next:async p=>{var y;const w=e.useHttpGet===!0&&i.idempotency===Qa.NoSideEffects;let b=null;w?p=BA(p,g(p.message),n):b=g(p.message);const N=await((y=e.fetch)!==null&&y!==void 0?y:globalThis.fetch)(p.url,Object.assign(Object.assign({},p.init),{headers:p.header,signal:p.signal,body:b})),{isUnaryError:$,unaryError:I}=gp(i.kind,N.status,N.headers);if($)throw up(await N.json(),fA(...pp(N.headers)),I);const[_,L]=pp(N.headers);return{stream:!1,service:r,method:i,header:_,message:n?d(new Uint8Array(await N.arrayBuffer())):i.O.fromJson(await N.json(),sp(e.jsonOptions)),trailer:L}}})},async stream(r,i,s,a,c,u,l){var m;const{serialize:g,parse:d}=op(i,n,e.jsonOptions,e.binaryOptions);function p(w,b,P){return GA(this,arguments,function*(){const $=pA(w).getReader();let I=!1;for(;;){const _=yield ai($.read());if(_.done)break;const{flags:L,data:z}=_.value;if((L&lp)===lp){I=!0;const J=CA(z);if(J.error){const ae=J.error;throw P.forEach((Ye,Et)=>{ae.metadata.append(Et,Ye)}),ae}J.metadata.forEach((ae,Ye)=>b.set(Ye,ae));continue}yield yield ai(d(z))}if(!I)throw"missing EndStreamResponse"})}async function y(w){if(i.kind!=K.ServerStreaming)throw"The fetch API does not support streaming request bodies";const b=await w[Symbol.asyncIterator]().next();if(b.done==!0)throw"missing request message";return hA(0,g(b.value))}return a=a===void 0?e.defaultTimeoutMs:a<=0?void 0:a,await VA({interceptors:e.interceptors,timeoutMs:a,signal:s,req:{stream:!0,service:r,method:i,url:np(e.baseUrl,r,i),init:{method:"POST",credentials:(m=e.credentials)!==null&&m!==void 0?m:"same-origin",redirect:"error",mode:"cors"},header:mp(i.kind,n,a,c,!1),contextValues:l??tp(),message:u},next:async w=>{var b;const N=await((b=e.fetch)!==null&&b!==void 0?b:globalThis.fetch)(w.url,Object.assign(Object.assign({},w.init),{headers:w.header,signal:w.signal,body:await y(w.message)}));if(gp(i.kind,N.status,N.headers),N.body===null)throw"missing response body";const $=new Headers;return Object.assign(Object.assign({},w),{header:N.headers,trailer:$,message:p(N.body,$,N.headers)})}})}}}const ZA=O.makeMessageType("google.type.Interval",()=>[{no:1,name:"start_time",kind:"message",T:Ve},{no:2,name:"end_time",kind:"message",T:Ve}]),nc=O.makeMessageType("proctoring.v1.Session",()=>[{no:1,name:"key",kind:"message",T:gt},{no:2,name:"user_id",kind:"scalar",T:5},{no:3,name:"assessment_id",kind:"scalar",T:5}]),gt=O.makeMessageType("proctoring.v1.Session.Key",()=>[{no:1,name:"id",kind:"scalar",T:9}],{localName:"Session_Key"}),rc=O.makeMessageType("proctoring.v1.SessionInfo",()=>[{no:1,name:"session",kind:"message",T:nc},{no:2,name:"started_at",kind:"message",T:Ve},{no:3,name:"ended_at",kind:"message",T:Ve},{no:4,name:"severity",kind:"enum",T:O.getEnumType(ci)}]),ci=O.makeEnum("proctoring.v1.SessionInfo.Severity",[{no:0,name:"SEVERITY_UNSPECIFIED",localName:"UNSPECIFIED"},{no:1,name:"SEVERITY_NONE",localName:"NONE"},{no:2,name:"SEVERITY_MINOR",localName:"MINOR"},{no:3,name:"SEVERITY_MAJOR",localName:"MAJOR"},{no:4,name:"SEVERITY_SEVERE",localName:"SEVERE"}]),JA=O.makeMessageType("proctoring.v1.SessionServiceNewRequest",()=>[{no:1,name:"user_id",kind:"scalar",T:5},{no:2,name:"assessment_id",kind:"scalar",T:5}]),KA=O.makeMessageType("proctoring.v1.SessionServiceNewResponse",()=>[{no:1,name:"session_key",kind:"message",T:gt}]),WA=O.makeMessageType("proctoring.v1.SessionServiceEndRequest",()=>[{no:1,name:"session_key",kind:"message",T:gt},{no:2,name:"sequence_number",kind:"scalar",T:13}]),HA=O.makeMessageType("proctoring.v1.SessionServiceEndResponse",[]),YA=O.makeMessageType("proctoring.v1.SessionServiceGetRequest",()=>[{no:1,name:"session_key",kind:"message",T:gt}]),XA=O.makeMessageType("proctoring.v1.SessionServiceGetResponse",()=>[{no:1,name:"session",kind:"message",T:nc}]),QA=O.makeMessageType("proctoring.v1.SessionServiceFindRequest",()=>[{no:1,name:"user_id",kind:"scalar",T:5},{no:2,name:"assessment_id",kind:"scalar",T:5}]),eP=O.makeMessageType("proctoring.v1.SessionServiceFindResponse",()=>[{no:1,name:"session",kind:"message",T:nc}]),tP=O.makeMessageType("proctoring.v1.SessionServiceGetInfoRequest",()=>[{no:1,name:"session_key",kind:"message",T:gt}]),nP=O.makeMessageType("proctoring.v1.SessionServiceGetInfoResponse",()=>[{no:1,name:"session_info",kind:"message",T:rc}]),rP=O.makeMessageType("proctoring.v1.SessionServiceFindInfoRequest",()=>[{no:1,name:"user_id",kind:"scalar",T:5},{no:2,name:"assessment_id",kind:"scalar",T:5},{no:3,name:"started_at",kind:"message",T:ZA}]),iP=O.makeMessageType("proctoring.v1.SessionServiceFindInfoResponse",()=>[{no:1,name:"session_info",kind:"message",T:rc}]),sP=O.makeMessageType("proctoring.v1.SessionServiceUpdateInfoRequest",()=>[{no:1,name:"session_info",kind:"message",T:rc}]),oP=O.makeMessageType("proctoring.v1.SessionServiceUpdateInfoResponse",[]),bp=O.makeEnum("proctoring.v1.RecordingType",[{no:0,name:"RECORDING_TYPE_UNSPECIFIED",localName:"UNSPECIFIED"},{no:1,name:"RECORDING_TYPE_WEBCAM",localName:"WEBCAM"},{no:2,name:"RECORDING_TYPE_SCREENCAPTURE",localName:"SCREENCAPTURE"}]),aP=O.makeEnum("proctoring.v1.RecordingStatus",[{no:0,name:"RECORDING_STATUS_UNSPECIFIED",localName:"UNSPECIFIED"},{no:1,name:"RECORDING_STATUS_RECORDING",localName:"RECORDING"},{no:2,name:"RECORDING_STATUS_PROCESSING",localName:"PROCESSING"},{no:3,name:"RECORDING_STATUS_AVAILABLE",localName:"AVAILABLE"},{no:4,name:"RECORDING_STATUS_ERROR",localName:"ERROR"}]),cn=O.makeMessageType("proctoring.v1.RecordingKey",()=>[{no:1,name:"session_key",kind:"message",T:gt},{no:2,name:"type",kind:"enum",T:O.getEnumType(bp)},{no:3,name:"number",kind:"scalar",T:5,opt:!0}]),ic=O.makeMessageType("proctoring.v1.RecordingBlobInfo",()=>[{no:1,name:"key",kind:"message",T:cn},{no:4,name:"number",kind:"scalar",T:5,opt:!0}]),vp=O.makeMessageType("proctoring.v1.MediaInfo",()=>[{no:1,name:"json",kind:"message",T:$t},{no:2,name:"container",kind:"scalar",T:9},{no:3,name:"duration",kind:"message",T:Vt},{no:4,name:"video_codec",kind:"scalar",T:9},{no:5,name:"audio_codec",kind:"scalar",T:9},{no:6,name:"width",kind:"scalar",T:5},{no:7,name:"height",kind:"scalar",T:5},{no:9,name:"overall_bitrate",kind:"scalar",T:5},{no:8,name:"size",kind:"scalar",T:3}]),Sp=O.makeMessageType("proctoring.v1.RecordingInfo",()=>[{no:1,name:"key",kind:"message",T:cn},{no:2,name:"media_info",kind:"message",T:vp},{no:3,name:"status",kind:"enum",T:O.getEnumType(aP)},{no:4,name:"url",kind:"scalar",T:9,opt:!0}]),cP=O.makeMessageType("proctoring.v1.RecordingServiceStartRequest",()=>[{no:1,name:"session_key",kind:"message",T:gt},{no:2,name:"type",kind:"enum",T:O.getEnumType(bp)},{no:3,name:"process_continuously",kind:"scalar",T:8,opt:!0}]),uP=O.makeMessageType("proctoring.v1.RecordingServiceStartResponse",()=>[{no:1,name:"recording_key",kind:"message",T:cn}]),lP=O.makeMessageType("proctoring.v1.RecordingServiceGetBlobUploadUrlRequest",()=>[{no:1,name:"recording_blob_info",kind:"message",T:ic}]),fP=O.makeMessageType("proctoring.v1.RecordingServiceGetBlobUploadUrlResponse",()=>[{no:1,name:"url",kind:"scalar",T:9}]),dP=O.makeMessageType("proctoring.v1.RecordingServiceUncheckedGetBlobUploadUrlRequest",()=>[{no:1,name:"recording_blob_info",kind:"message",T:ic}]),pP=O.makeMessageType("proctoring.v1.RecordingServiceUncheckedGetBlobUploadUrlResponse",()=>[{no:1,name:"url",kind:"scalar",T:9}]),hP=O.makeMessageType("proctoring.v1.RecordingServiceAckRequest",()=>[{no:1,name:"recording_blob_info",kind:"message",T:ic}]),mP=O.makeMessageType("proctoring.v1.RecordingServiceAckResponse",[]),gP=O.makeMessageType("proctoring.v1.RecordingServiceConcatRequest",()=>[{no:1,name:"recording_key",kind:"message",T:cn},{no:2,name:"request_id",kind:"scalar",T:9,opt:!0}]),yP=O.makeMessageType("proctoring.v1.RecordingServiceEndRequest",()=>[{no:1,name:"recording_key",kind:"message",T:cn}]),wP=O.makeMessageType("proctoring.v1.RecordingServiceEndResponse",[]),bP=O.makeMessageType("proctoring.v1.RecordingServiceConcatResponse",[]),vP=O.makeMessageType("proctoring.v1.RecordingServiceAttachMediaInfoRequest",()=>[{no:1,name:"recording_key",kind:"message",T:cn},{no:2,name:"media_info",kind:"message",T:vp}]),SP=O.makeMessageType("proctoring.v1.RecordingServiceAttachMediaInfoResponse",[]),kP=O.makeMessageType("proctoring.v1.RecordingServiceListRequest",()=>[{no:1,name:"session_key",kind:"message",T:gt}]),OP=O.makeMessageType("proctoring.v1.RecordingServiceListResponse",()=>[{no:1,name:"recording_keys",kind:"message",T:cn,repeated:!0}]),IP=O.makeMessageType("proctoring.v1.RecordingServiceGetRequest",()=>[{no:1,name:"recording_key",kind:"message",T:cn}]),$P=O.makeMessageType("proctoring.v1.RecordingServiceGetResponse",()=>[{no:1,name:"recording_info",kind:"message",T:Sp}]),EP=O.makeMessageType("proctoring.v1.RecordingServiceGetAllRequest",()=>[{no:1,name:"session_key",kind:"message",T:gt}]),TP=O.makeMessageType("proctoring.v1.RecordingServiceGetAllResponse",()=>[{no:1,name:"recording_info",kind:"message",T:Sp}]),NP={typeName:"proctoring.v1.RecordingService",methods:{start:{name:"Start",I:cP,O:uP,kind:K.Unary},getBlobUploadUrl:{name:"GetBlobUploadUrl",I:lP,O:fP,kind:K.Unary},uncheckedGetBlobUploadUrl:{name:"UncheckedGetBlobUploadUrl",I:dP,O:pP,kind:K.Unary},ack:{name:"Ack",I:hP,O:mP,kind:K.Unary},concat:{name:"Concat",I:gP,O:bP,kind:K.Unary},end:{name:"End",I:yP,O:wP,kind:K.Unary},attachMediaInfo:{name:"AttachMediaInfo",I:vP,O:SP,kind:K.Unary},list:{name:"List",I:kP,O:OP,kind:K.Unary},get:{name:"Get",I:IP,O:$P,kind:K.Unary},getAll:{name:"GetAll",I:EP,O:TP,kind:K.ServerStreaming}}},LP={typeName:"proctoring.v1.SessionService",methods:{new:{name:"New",I:JA,O:KA,kind:K.Unary},end:{name:"End",I:WA,O:HA,kind:K.Unary},get:{name:"Get",I:YA,O:XA,kind:K.Unary},find:{name:"Find",I:QA,O:eP,kind:K.ServerStreaming},getInfo:{name:"GetInfo",I:tP,O:nP,kind:K.Unary},findInfo:{name:"FindInfo",I:rP,O:iP,kind:K.ServerStreaming},updateInfo:{name:"UpdateInfo",I:sP,O:oP,kind:K.Unary}}},AP=O.makeMessageType("proctoring.v1.EventServiceNewRequest",()=>[{no:1,name:"session_key",kind:"message",T:gt},{no:2,name:"events",kind:"message",T:kp,repeated:!0}]),PP=O.makeMessageType("proctoring.v1.EventServiceNewResponse",[]),RP=O.makeMessageType("proctoring.v1.EventServiceGetRequest",()=>[{no:1,name:"session_key",kind:"message",T:gt}]),_P=O.makeMessageType("proctoring.v1.EventServiceGetResponse",()=>[{no:1,name:"event",kind:"message",T:kp}]),kp=O.makeMessageType("proctoring.v1.Event",()=>[{no:1,name:"number",kind:"scalar",T:13},{no:2,name:"time",kind:"message",T:Ve},{no:3,name:"assessment_start",kind:"message",T:CP,oneof:"event"},{no:4,name:"assessment_end",kind:"message",T:jP,oneof:"event"},{no:5,name:"key_press",kind:"message",T:UP,oneof:"event"},{no:6,name:"displays",kind:"message",T:xP,oneof:"event"},{no:7,name:"connection",kind:"message",T:MP,oneof:"event"},{no:8,name:"microphone_audio",kind:"message",T:FP,oneof:"event"},{no:9,name:"object_detection",kind:"message",T:DP,oneof:"event"},{no:10,name:"face_detection",kind:"message",T:VP,oneof:"event"}]),CP=O.makeMessageType("proctoring.v1.Event.AssessmentStart",[],{localName:"Event_AssessmentStart"}),jP=O.makeMessageType("proctoring.v1.Event.AssessmentEnd",[],{localName:"Event_AssessmentEnd"}),UP=O.makeMessageType("proctoring.v1.Event.KeyPress",()=>[{no:1,name:"key",kind:"scalar",T:9,repeated:!0}],{localName:"Event_KeyPress"}),xP=O.makeMessageType("proctoring.v1.Event.Displays",()=>[{no:1,name:"count",kind:"scalar",T:13}],{localName:"Event_Displays"});O.makeMessageType("proctoring.v1.Event.DisplayRecording",[],{localName:"Event_DisplayRecording"}),O.makeMessageType("proctoring.v1.Event.UserMediaRecording",[],{localName:"Event_UserMediaRecording"});const MP=O.makeMessageType("proctoring.v1.Event.Connection",()=>[{no:1,name:"connected",kind:"scalar",T:8}],{localName:"Event_Connection"}),FP=O.makeMessageType("proctoring.v1.Event.MicrophoneAudio",[],{localName:"Event_MicrophoneAudio"}),DP=O.makeMessageType("proctoring.v1.Event.ObjectDetection",()=>[{no:1,name:"rekognition",kind:"message",T:BP,oneof:"algorithm"}],{localName:"Event_ObjectDetection"}),BP=O.makeMessageType("proctoring.v1.Event.ObjectDetection.Rekognition",()=>[{no:1,name:"labels",kind:"message",T:zP,repeated:!0}],{localName:"Event_ObjectDetection_Rekognition"}),zP=O.makeMessageType("proctoring.v1.Event.ObjectDetection.Rekognition.Label",()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"confidence",kind:"scalar",T:2}],{localName:"Event_ObjectDetection_Rekognition_Label"}),VP=O.makeMessageType("proctoring.v1.Event.FaceDetection",[],{localName:"Event_FaceDetection"}),qP={typeName:"proctoring.v1.EventService",methods:{new:{name:"New",I:AP,O:PP,kind:K.Unary},get:{name:"Get",I:RP,O:_P,kind:K.ServerStreaming}}},GP=O.makeMessageType("proctoring.v1.IncidentServiceGetRequest",()=>[{no:1,name:"session_key",kind:"message",T:gt}]),ZP=O.makeMessageType("proctoring.v1.IncidentServiceGetResponse",()=>[{no:1,name:"incident",kind:"message",T:QP},{no:2,name:"id",kind:"scalar",T:4},{no:3,name:"severity",kind:"enum",T:O.getEnumType(ci)}]),JP=O.makeMessageType("proctoring.v1.IncidentServiceOverrideSeverityRequest",()=>[{no:1,name:"incident_id",kind:"scalar",T:4},{no:2,name:"severity",kind:"enum",T:O.getEnumType(ci)}]),KP=O.makeMessageType("proctoring.v1.IncidentServiceOverrideSeverityResponse",[]),WP=O.makeMessageType("proctoring.v1.IncidentServiceUpdateConfigurationRequest",()=>[{no:1,name:"assessment_id",kind:"scalar",T:5},{no:3,name:"config",kind:"message",T:Op}]),HP=O.makeMessageType("proctoring.v1.IncidentServiceUpdateConfigurationResponse",[]),YP=O.makeMessageType("proctoring.v1.IncidentServiceGetConfigurationRequest",()=>[{no:1,name:"assessment_id",kind:"scalar",T:5}]),XP=O.makeMessageType("proctoring.v1.IncidentServiceGetConfigurationResponse",()=>[{no:2,name:"config",kind:"message",T:Op}]),QP=O.makeMessageType("proctoring.v1.Incident",()=>[{no:1,name:"time",kind:"message",T:Ve},{no:2,name:"assessment_start",kind:"message",T:eR,oneof:"incident"},{no:3,name:"assessment_end",kind:"message",T:tR,oneof:"incident"},{no:4,name:"clipboard_copy",kind:"message",T:nR,oneof:"incident"},{no:5,name:"clipboard_cut",kind:"message",T:rR,oneof:"incident"},{no:6,name:"clipboard_paste",kind:"message",T:iR,oneof:"incident"},{no:13,name:"screenshot",kind:"message",T:sR,oneof:"incident"},{no:14,name:"extra_displays",kind:"message",T:oR,oneof:"incident"},{no:19,name:"display_recording_started",kind:"message",T:aR,oneof:"incident"},{no:15,name:"display_recording_stopped",kind:"message",T:cR,oneof:"incident"},{no:20,name:"user_media_recording_started",kind:"message",T:uR,oneof:"incident"},{no:16,name:"user_media_recording_stopped",kind:"message",T:lR,oneof:"incident"},{no:12,name:"connection_lost",kind:"message",T:fR,oneof:"incident"},{no:17,name:"microphone_audio_loud",kind:"message",T:dR,oneof:"incident"},{no:7,name:"phone_present",kind:"message",T:pR,oneof:"incident"},{no:8,name:"computer_present",kind:"message",T:hR,oneof:"incident"},{no:9,name:"book_present",kind:"message",T:mR,oneof:"incident"},{no:10,name:"target_person_missing",kind:"message",T:gR,oneof:"incident"},{no:11,name:"other_people_present",kind:"message",T:yR,oneof:"incident"}]),eR=O.makeMessageType("proctoring.v1.Incident.AssessmentStart",[],{localName:"Incident_AssessmentStart"}),tR=O.makeMessageType("proctoring.v1.Incident.AssessmentEnd",[],{localName:"Incident_AssessmentEnd"}),nR=O.makeMessageType("proctoring.v1.Incident.ClipboardCopy",[],{localName:"Incident_ClipboardCopy"}),rR=O.makeMessageType("proctoring.v1.Incident.ClipboardCut",[],{localName:"Incident_ClipboardCut"}),iR=O.makeMessageType("proctoring.v1.Incident.ClipboardPaste",[],{localName:"Incident_ClipboardPaste"}),sR=O.makeMessageType("proctoring.v1.Incident.Screenshot",[],{localName:"Incident_Screenshot"}),oR=O.makeMessageType("proctoring.v1.Incident.ExtraDisplays",[],{localName:"Incident_ExtraDisplays"}),aR=O.makeMessageType("proctoring.v1.Incident.DisplayRecordingStarted",[],{localName:"Incident_DisplayRecordingStarted"}),cR=O.makeMessageType("proctoring.v1.Incident.DisplayRecordingStopped",[],{localName:"Incident_DisplayRecordingStopped"}),uR=O.makeMessageType("proctoring.v1.Incident.UserMediaRecordingStarted",[],{localName:"Incident_UserMediaRecordingStarted"}),lR=O.makeMessageType("proctoring.v1.Incident.UserMediaRecordingStopped",[],{localName:"Incident_UserMediaRecordingStopped"}),fR=O.makeMessageType("proctoring.v1.Incident.ConnectionLost",[],{localName:"Incident_ConnectionLost"}),dR=O.makeMessageType("proctoring.v1.Incident.MicrophoneAudioLoud",[],{localName:"Incident_MicrophoneAudioLoud"}),pR=O.makeMessageType("proctoring.v1.Incident.PhonePresent",()=>[{no:1,name:"confidence",kind:"scalar",T:2}],{localName:"Incident_PhonePresent"}),hR=O.makeMessageType("proctoring.v1.Incident.ComputerPresent",()=>[{no:1,name:"confidence",kind:"scalar",T:2}],{localName:"Incident_ComputerPresent"}),mR=O.makeMessageType("proctoring.v1.Incident.BookPresent",()=>[{no:1,name:"confidence",kind:"scalar",T:2}],{localName:"Incident_BookPresent"}),gR=O.makeMessageType("proctoring.v1.Incident.TargetPersonMissing",()=>[{no:1,name:"confidence",kind:"scalar",T:2}],{localName:"Incident_TargetPersonMissing"}),yR=O.makeMessageType("proctoring.v1.Incident.OtherPeoplePresent",()=>[{no:1,name:"confidence",kind:"scalar",T:2}],{localName:"Incident_OtherPeoplePresent"}),Op=O.makeMessageType("proctoring.v1.IncidentConfiguration",()=>[{no:1,name:"v1",kind:"message",T:wR,oneof:"config"}]),wR=O.makeMessageType("proctoring.v1.IncidentConfiguration.V1",()=>[{no:2,name:"assessment_start",kind:"message",T:nt},{no:3,name:"assessment_end",kind:"message",T:nt},{no:4,name:"clipboard_copy",kind:"message",T:nt},{no:5,name:"clipboard_cut",kind:"message",T:nt},{no:6,name:"clipboard_paste",kind:"message",T:nt},{no:13,name:"screenshot",kind:"message",T:nt},{no:14,name:"extra_displays",kind:"message",T:nt},{no:19,name:"display_recording_started",kind:"message",T:nt},{no:15,name:"display_recording_stopped",kind:"message",T:nt},{no:20,name:"user_media_recording_started",kind:"message",T:nt},{no:16,name:"user_media_recording_stopped",kind:"message",T:nt},{no:12,name:"connection_lost",kind:"message",T:nt},{no:17,name:"microphone_audio_loud",kind:"message",T:nt},{no:7,name:"phone_present",kind:"message",T:ui},{no:8,name:"computer_present",kind:"message",T:ui},{no:9,name:"book_present",kind:"message",T:ui},{no:10,name:"target_person_missing",kind:"message",T:ui},{no:11,name:"other_people_present",kind:"message",T:ui}],{localName:"IncidentConfiguration_V1"}),nt=O.makeMessageType("proctoring.v1.IncidentConfiguration.V1.SimpleSeverityCheck",()=>[{no:1,name:"severity",kind:"enum",T:O.getEnumType(ci)}],{localName:"IncidentConfiguration_V1_SimpleSeverityCheck"}),ui=O.makeMessageType("proctoring.v1.IncidentConfiguration.V1.ConfidenceSeverityCheck",()=>[{no:1,name:"minimum_confidence",kind:"scalar",T:2},{no:2,name:"severity",kind:"enum",T:O.getEnumType(ci)}],{localName:"IncidentConfiguration_V1_ConfidenceSeverityCheck"}),bR={typeName:"proctoring.v1.IncidentService",methods:{get:{name:"Get",I:GP,O:ZP,kind:K.ServerStreaming},overrideSeverity:{name:"OverrideSeverity",I:JP,O:KP,kind:K.Unary},updateConfiguration:{name:"UpdateConfiguration",I:WP,O:HP,kind:K.Unary},getConfiguration:{name:"GetConfiguration",I:YP,O:XP,kind:K.Unary}}};function vR(e,t=n=>new WebSocket(n)){let n,r,i;function s(){i=new Promise(c=>{r=c})}function a(){s(),n==null||n.close(),n=t(e),n.onerror=()=>{},n.onclose=a,n.onopen=()=>r()}return a(),{get ready(){return i},logEvent(c){n.send(JSON.stringify(c))},end(){n.onclose=null,n.close()},async close(){s(),n.close(),await new Promise(c=>{var l;const u=(l=n.onclose)==null?void 0:l.bind(n);n.onclose=m=>{c(),u==null||u(m)}})}}}function SR(e){const t=vR(e);return{logEvent(n){t.logEvent(n)},end(){t.end()}}}const kR={createProctoringSessionUrl(e,t){const n=new URL(`/ws/proctoring/session/${t}`,e);return n.protocol="wss",n},createWs:SR,create(e){return{session:js(LP,Us({baseUrl:e})),recording:js(NP,Us({baseUrl:e})),event:js(qP,Us({baseUrl:e})),incident:js(bR,Us({baseUrl:e}))}}},OR={verityOrigin:window.location.origin,lockdown:{origin:"https://verity-lockdown.s3.us-east-2.amazonaws.com",channel:"release",cdnBaseUrl:"https://d2xq0c4hh79wva.cloudfront.net/lockdown"}},Ip=Ja.getInstance(OR);kR.create(window.location.origin+"/api/proctoring");var IR={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(_n,function(){return function(n){var r={};function i(s){if(r[s])return r[s].exports;var a=r[s]={i:s,l:!1,exports:{}};return n[s].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=n,i.c=r,i.d=function(s,a,c){i.o(s,a)||Object.defineProperty(s,a,{enumerable:!0,get:c})},i.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},i.t=function(s,a){if(1&a&&(s=i(s)),8&a||4&a&&typeof s=="object"&&s&&s.__esModule)return s;var c=Object.create(null);if(i.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:s}),2&a&&typeof s!="string")for(var u in s)i.d(c,u,(function(l){return s[l]}).bind(null,u));return c},i.n=function(s){var a=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(a,"a",a),a},i.o=function(s,a){return Object.prototype.hasOwnProperty.call(s,a)},i.p="",i(i.s=0)}([function(n,r,i){var s,a,c=i(1)(),u=i(3),l=i(4),m=i(6),g=function(){var d=new l;return s=d.getResult(),a=new m,this};g.prototype={getSoftwareVersion:function(){return"0.1.11"},getBrowserData:function(){return s},getFingerprint:function(){var d="|",p=s.ua,y=this.getScreenPrint(),w=this.getPlugins(),b=this.getFonts(),P=this.isLocalStorage(),N=this.isSessionStorage(),$=this.getTimeZone(),I=this.getLanguage(),_=this.getSystemLanguage(),L=this.isCookie(),z=this.getCanvasPrint();return u(p+d+y+d+w+d+b+d+P+d+N+d+$+d+I+d+_+d+L+d+z,256)},getCustomFingerprint:function(){for(var d="|",p="",y=0;y<arguments.length;y++)p+=arguments[y]+d;return u(p,256)},getUserAgent:function(){return s.ua},getUserAgentLowerCase:function(){return s.ua.toLowerCase()},getBrowser:function(){return s.browser.name},getBrowserVersion:function(){return s.browser.version},getBrowserMajorVersion:function(){return s.browser.major},isIE:function(){return/IE/i.test(s.browser.name)},isChrome:function(){return/Chrome/i.test(s.browser.name)},isFirefox:function(){return/Firefox/i.test(s.browser.name)},isSafari:function(){return/Safari/i.test(s.browser.name)},isMobileSafari:function(){return/Mobile\sSafari/i.test(s.browser.name)},isOpera:function(){return/Opera/i.test(s.browser.name)},getEngine:function(){return s.engine.name},getEngineVersion:function(){return s.engine.version},getOS:function(){return s.os.name},getOSVersion:function(){return s.os.version},isWindows:function(){return/Windows/i.test(s.os.name)},isMac:function(){return/Mac/i.test(s.os.name)},isLinux:function(){return/Linux/i.test(s.os.name)},isUbuntu:function(){return/Ubuntu/i.test(s.os.name)},isSolaris:function(){return/Solaris/i.test(s.os.name)},getDevice:function(){return s.device.model},getDeviceType:function(){return s.device.type},getDeviceVendor:function(){return s.device.vendor},getCPU:function(){return s.cpu.architecture},isMobile:function(){var d=s.ua||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(d)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(d.substr(0,4))},isMobileMajor:function(){return this.isMobileAndroid()||this.isMobileBlackBerry()||this.isMobileIOS()||this.isMobileOpera()||this.isMobileWindows()},isMobileAndroid:function(){return!!s.ua.match(/Android/i)},isMobileOpera:function(){return!!s.ua.match(/Opera Mini/i)},isMobileWindows:function(){return!!s.ua.match(/IEMobile/i)},isMobileBlackBerry:function(){return!!s.ua.match(/BlackBerry/i)},isMobileIOS:function(){return!!s.ua.match(/iPhone|iPad|iPod/i)},isIphone:function(){return!!s.ua.match(/iPhone/i)},isIpad:function(){return!!s.ua.match(/iPad/i)},isIpod:function(){return!!s.ua.match(/iPod/i)},getScreenPrint:function(){return"Current Resolution: "+this.getCurrentResolution()+", Available Resolution: "+this.getAvailableResolution()+", Color Depth: "+this.getColorDepth()+", Device XDPI: "+this.getDeviceXDPI()+", Device YDPI: "+this.getDeviceYDPI()},getColorDepth:function(){return screen.colorDepth},getCurrentResolution:function(){return screen.width+"x"+screen.height},getAvailableResolution:function(){return screen.availWidth+"x"+screen.availHeight},getDeviceXDPI:function(){return screen.deviceXDPI},getDeviceYDPI:function(){return screen.deviceYDPI},getPlugins:function(){for(var d="",p=0;p<navigator.plugins.length;p++)p==navigator.plugins.length-1?d+=navigator.plugins[p].name:d+=navigator.plugins[p].name+", ";return d},isJava:function(){return navigator.javaEnabled()},getJavaVersion:function(){throw new Error("Please use client.java.js or client.js if you need this functionality!")},isFlash:function(){return!!navigator.plugins["Shockwave Flash"]},getFlashVersion:function(){throw new Error("Please use client.flash.js or client.js if you need this functionality!")},isSilverlight:function(){return!!navigator.plugins["Silverlight Plug-In"]},getSilverlightVersion:function(){return this.isSilverlight()?navigator.plugins["Silverlight Plug-In"].description:""},isMimeTypes:function(){return!(!navigator.mimeTypes||!navigator.mimeTypes.length)},getMimeTypes:function(){var d="";if(navigator.mimeTypes)for(var p=0;p<navigator.mimeTypes.length;p++)p==navigator.mimeTypes.length-1?d+=navigator.mimeTypes[p].description:d+=navigator.mimeTypes[p].description+", ";return d},isFont:function(d){return a.detect(d)},getFonts:function(){for(var d=["Abadi MT Condensed Light","Adobe Fangsong Std","Adobe Hebrew","Adobe Ming Std","Agency FB","Aharoni","Andalus","Angsana New","AngsanaUPC","Aparajita","Arab","Arabic Transparent","Arabic Typesetting","Arial Baltic","Arial Black","Arial CE","Arial CYR","Arial Greek","Arial TUR","Arial","Batang","BatangChe","Bauhaus 93","Bell MT","Bitstream Vera Serif","Bodoni MT","Bookman Old Style","Braggadocio","Broadway","Browallia New","BrowalliaUPC","Calibri Light","Calibri","Californian FB","Cambria Math","Cambria","Candara","Castellar","Casual","Centaur","Century Gothic","Chalkduster","Colonna MT","Comic Sans MS","Consolas","Constantia","Copperplate Gothic Light","Corbel","Cordia New","CordiaUPC","Courier New Baltic","Courier New CE","Courier New CYR","Courier New Greek","Courier New TUR","Courier New","DFKai-SB","DaunPenh","David","DejaVu LGC Sans Mono","Desdemona","DilleniaUPC","DokChampa","Dotum","DotumChe","Ebrima","Engravers MT","Eras Bold ITC","Estrangelo Edessa","EucrosiaUPC","Euphemia","Eurostile","FangSong","Forte","FrankRuehl","Franklin Gothic Heavy","Franklin Gothic Medium","FreesiaUPC","French Script MT","Gabriola","Gautami","Georgia","Gigi","Gisha","Goudy Old Style","Gulim","GulimChe","GungSeo","Gungsuh","GungsuhChe","Haettenschweiler","Harrington","Hei S","HeiT","Heisei Kaku Gothic","Hiragino Sans GB","Impact","Informal Roman","IrisUPC","Iskoola Pota","JasmineUPC","KacstOne","KaiTi","Kalinga","Kartika","Khmer UI","Kino MT","KodchiangUPC","Kokila","Kozuka Gothic Pr6N","Lao UI","Latha","Leelawadee","Levenim MT","LilyUPC","Lohit Gujarati","Loma","Lucida Bright","Lucida Console","Lucida Fax","Lucida Sans Unicode","MS Gothic","MS Mincho","MS PGothic","MS PMincho","MS Reference Sans Serif","MS UI Gothic","MV Boli","Magneto","Malgun Gothic","Mangal","Marlett","Matura MT Script Capitals","Meiryo UI","Meiryo","Menlo","Microsoft Himalaya","Microsoft JhengHei","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft Uighur","Microsoft YaHei","Microsoft Yi Baiti","MingLiU","MingLiU-ExtB","MingLiU_HKSCS","MingLiU_HKSCS-ExtB","Miriam Fixed","Miriam","Mongolian Baiti","MoolBoran","NSimSun","Narkisim","News Gothic MT","Niagara Solid","Nyala","PMingLiU","PMingLiU-ExtB","Palace Script MT","Palatino Linotype","Papyrus","Perpetua","Plantagenet Cherokee","Playbill","Prelude Bold","Prelude Condensed Bold","Prelude Condensed Medium","Prelude Medium","PreludeCompressedWGL Black","PreludeCompressedWGL Bold","PreludeCompressedWGL Light","PreludeCompressedWGL Medium","PreludeCondensedWGL Black","PreludeCondensedWGL Bold","PreludeCondensedWGL Light","PreludeCondensedWGL Medium","PreludeWGL Black","PreludeWGL Bold","PreludeWGL Light","PreludeWGL Medium","Raavi","Rachana","Rockwell","Rod","Sakkal Majalla","Sawasdee","Script MT Bold","Segoe Print","Segoe Script","Segoe UI Light","Segoe UI Semibold","Segoe UI Symbol","Segoe UI","Shonar Bangla","Showcard Gothic","Shruti","SimHei","SimSun","SimSun-ExtB","Simplified Arabic Fixed","Simplified Arabic","Snap ITC","Sylfaen","Symbol","Tahoma","Times New Roman Baltic","Times New Roman CE","Times New Roman CYR","Times New Roman Greek","Times New Roman TUR","Times New Roman","TlwgMono","Traditional Arabic","Trebuchet MS","Tunga","Tw Cen MT Condensed Extra Bold","Ubuntu","Umpush","Univers","Utopia","Utsaah","Vani","Verdana","Vijaya","Vladimir Script","Vrinda","Webdings","Wide Latin","Wingdings"],p="",y=0;y<d.length;y++)a.detect(d[y])&&(p+=y==d.length-1?d[y]:d[y]+", ");return p},isLocalStorage:function(){try{return!!c.localStorage}catch{return!0}},isSessionStorage:function(){try{return!!c.sessionStorage}catch{return!0}},isCookie:function(){return navigator.cookieEnabled},getTimeZone:function(){var d,p;return d=new Date,(p=String(-d.getTimezoneOffset()/60))<0?"-"+("0"+(p*=-1)).slice(-2):"+"+("0"+p).slice(-2)},getLanguage:function(){return navigator.language},getSystemLanguage:function(){return navigator.systemLanguage||window.navigator.language},isCanvas:function(){var d=document.createElement("canvas");try{return!(!d.getContext||!d.getContext("2d"))}catch{return!1}},getCanvasPrint:function(){var d,p=document.createElement("canvas");try{d=p.getContext("2d")}catch{return""}var y="ClientJS,org <canvas> 1.0";return d.textBaseline="top",d.font="14px 'Arial'",d.textBaseline="alphabetic",d.fillStyle="#f60",d.fillRect(125,1,62,20),d.fillStyle="#069",d.fillText(y,2,15),d.fillStyle="rgba(102, 204, 0, 0.7)",d.fillText(y,4,17),p.toDataURL()}},r.ClientJS=g},function(n,r,i){var s=i(2);n.exports=function(){return typeof _n=="object"&&_n&&_n.Math===Math&&_n.Array===Array?_n:s}},function(n,r,i){typeof self<"u"?n.exports=self:typeof window<"u"?n.exports=window:n.exports=Function("return this")()},function(n,r,i){n.exports=function(s,a){var c,u,l,m,g,d,p,y;for(c=3&s.length,u=s.length-c,l=a,g=3432918353,d=461845907,y=0;y<u;)p=255&s.charCodeAt(y)|(255&s.charCodeAt(++y))<<8|(255&s.charCodeAt(++y))<<16|(255&s.charCodeAt(++y))<<24,++y,l=27492+(65535&(m=5*(65535&(l=(l^=p=(65535&(p=(p=(65535&p)*g+(((p>>>16)*g&65535)<<16)&4294967295)<<15|p>>>17))*d+(((p>>>16)*d&65535)<<16)&4294967295)<<13|l>>>19))+((5*(l>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(p=0,c){case 3:p^=(255&s.charCodeAt(y+2))<<16;case 2:p^=(255&s.charCodeAt(y+1))<<8;case 1:l^=p=(65535&(p=(p=(65535&(p^=255&s.charCodeAt(y)))*g+(((p>>>16)*g&65535)<<16)&4294967295)<<15|p>>>17))*d+(((p>>>16)*d&65535)<<16)&4294967295}return l^=s.length,l=2246822507*(65535&(l^=l>>>16))+((2246822507*(l>>>16)&65535)<<16)&4294967295,l=3266489909*(65535&(l^=l>>>13))+((3266489909*(l>>>16)&65535)<<16)&4294967295,(l^=l>>>16)>>>0}},function(n,r,i){var s;(function(a,c){var u="function",l="undefined",m="object",g="string",d="model",p="name",y="type",w="vendor",b="version",P="architecture",N="console",$="mobile",I="tablet",_="smarttv",L="wearable",z="embedded",J="Amazon",ae="Apple",Ye="ASUS",Et="BlackBerry",Ie="Firefox",Bs="Google",Tp="Huawei",wc="LG",bc="Microsoft",Np="Motorola",ZR="Opera",vc="Samsung",Sc="Sony",Lp="Xiaomi",kc="Zebra",Ap="Facebook",zs=function(Q){var se={};for(var ee in Q)se[Q[ee].toUpperCase()]=Q[ee];return se},Pp=function(Q,se){return typeof Q===g&&mi(se).indexOf(mi(Q))!==-1},mi=function(Q){return Q.toLowerCase()},Oc=function(Q,se){if(typeof Q===g)return Q=Q.replace(/^\s\s*/,"").replace(/\s\s*$/,""),typeof se===l?Q:Q.substring(0,255)},gi=function(Q,se){for(var ee,yt,V,q,ln,Fe,qs=0;qs<se.length&&!ln;){var Cp=se[qs],jp=se[qs+1];for(ee=yt=0;ee<Cp.length&&!ln;)if(ln=Cp[ee++].exec(Q))for(V=0;V<jp.length;V++)Fe=ln[++yt],typeof(q=jp[V])===m&&q.length>0?q.length==2?typeof q[1]==u?this[q[0]]=q[1].call(this,Fe):this[q[0]]=q[1]:q.length==3?typeof q[1]!==u||q[1].exec&&q[1].test?this[q[0]]=Fe?Fe.replace(q[1],q[2]):c:this[q[0]]=Fe?q[1].call(this,Fe,q[2]):c:q.length==4&&(this[q[0]]=Fe?q[3].call(this,Fe.replace(q[1],q[2])):c):this[q]=Fe||c;qs+=2}},Ic=function(Q,se){for(var ee in se)if(typeof se[ee]===m&&se[ee].length>0){for(var yt=0;yt<se[ee].length;yt++)if(Pp(se[ee][yt],Q))return ee==="?"?c:ee}else if(Pp(se[ee],Q))return ee==="?"?c:ee;return Q},Rp={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},_p={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[b,[p,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[b,[p,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[p,b],[/opios[\/ ]+([\w\.]+)/i],[b,[p,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[b,[p,ZR]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[p,b],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[b,[p,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[b,[p,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[b,[p,"WeChat"]],[/konqueror\/([\w\.]+)/i],[b,[p,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[b,[p,"IE"]],[/yabrowser\/([\w\.]+)/i],[b,[p,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[p,/(.+)/,"$1 Secure Browser"],b],[/\bfocus\/([\w\.]+)/i],[b,[p,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[b,[p,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[b,[p,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[b,[p,"Dolphin"]],[/coast\/([\w\.]+)/i],[b,[p,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[b,[p,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[b,[p,Ie]],[/\bqihu|(qi?ho?o?|360)browser/i],[[p,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[p,/(.+)/,"$1 Browser"],b],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],b],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[p,b],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[p],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[p,Ap],b],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[p,b],[/\bgsa\/([\w\.]+) .*safari\//i],[b,[p,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[b,[p,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[p,"Chrome WebView"],b],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[b,[p,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[p,b],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[b,[p,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[b,p],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[p,[b,Ic,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[p,b],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[p,"Netscape"],b],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[b,[p,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[p,b]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[P,"amd64"]],[/(ia32(?=;))/i],[[P,mi]],[/((?:i[346]|x)86)[;\)]/i],[[P,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[P,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[P,"armhf"]],[/windows (ce|mobile); ppc;/i],[[P,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[P,/ower/,"",mi]],[/(sun4\w)[;\)]/i],[[P,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[P,mi]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[w,vc],[y,I]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[d,[w,vc],[y,$]],[/\((ip(?:hone|od)[\w ]*);/i],[d,[w,ae],[y,$]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[w,ae],[y,I]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[w,Tp],[y,I]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[d,[w,Tp],[y,$]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[d,/_/g," "],[w,Lp],[y,$]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[w,Lp],[y,I]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[d,[w,"OPPO"],[y,$]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[w,"Vivo"],[y,$]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[d,[w,"Realme"],[y,$]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[w,Np],[y,$]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[w,Np],[y,I]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[w,wc],[y,I]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[w,wc],[y,$]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[w,"Lenovo"],[y,I]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[w,"Nokia"],[y,$]],[/(pixel c)\b/i],[d,[w,Bs],[y,I]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[w,Bs],[y,$]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[w,Sc],[y,$]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[w,Sc],[y,I]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[w,"OnePlus"],[y,$]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[w,J],[y,I]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[w,J],[y,$]],[/(playbook);[-\w\),; ]+(rim)/i],[d,w,[y,I]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[w,Et],[y,$]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[w,Ye],[y,I]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[w,Ye],[y,$]],[/(nexus 9)/i],[d,[w,"HTC"],[y,I]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[w,[d,/_/g," "],[y,$]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[w,"Acer"],[y,I]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[w,"Meizu"],[y,$]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[w,"Sharp"],[y,$]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[w,d,[y,$]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[w,d,[y,I]],[/(surface duo)/i],[d,[w,bc],[y,I]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[w,"Fairphone"],[y,$]],[/(u304aa)/i],[d,[w,"AT&T"],[y,$]],[/\bsie-(\w*)/i],[d,[w,"Siemens"],[y,$]],[/\b(rct\w+) b/i],[d,[w,"RCA"],[y,I]],[/\b(venue[\d ]{2,7}) b/i],[d,[w,"Dell"],[y,I]],[/\b(q(?:mv|ta)\w+) b/i],[d,[w,"Verizon"],[y,I]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[w,"Barnes & Noble"],[y,I]],[/\b(tm\d{3}\w+) b/i],[d,[w,"NuVision"],[y,I]],[/\b(k88) b/i],[d,[w,"ZTE"],[y,I]],[/\b(nx\d{3}j) b/i],[d,[w,"ZTE"],[y,$]],[/\b(gen\d{3}) b.+49h/i],[d,[w,"Swiss"],[y,$]],[/\b(zur\d{3}) b/i],[d,[w,"Swiss"],[y,I]],[/\b((zeki)?tb.*\b) b/i],[d,[w,"Zeki"],[y,I]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[w,"Dragon Touch"],d,[y,I]],[/\b(ns-?\w{0,9}) b/i],[d,[w,"Insignia"],[y,I]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[w,"NextBook"],[y,I]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[w,"Voice"],d,[y,$]],[/\b(lvtel\-)?(v1[12]) b/i],[[w,"LvTel"],d,[y,$]],[/\b(ph-1) /i],[d,[w,"Essential"],[y,$]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[w,"Envizen"],[y,I]],[/\b(trio[-\w\. ]+) b/i],[d,[w,"MachSpeed"],[y,I]],[/\btu_(1491) b/i],[d,[w,"Rotor"],[y,I]],[/(shield[\w ]+) b/i],[d,[w,"Nvidia"],[y,I]],[/(sprint) (\w+)/i],[w,d,[y,$]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[w,bc],[y,$]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[w,kc],[y,I]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[w,kc],[y,$]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[w,d,[y,N]],[/droid.+; (shield) bui/i],[d,[w,"Nvidia"],[y,N]],[/(playstation [345portablevi]+)/i],[d,[w,Sc],[y,N]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[w,bc],[y,N]],[/smart-tv.+(samsung)/i],[w,[y,_]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[w,vc],[y,_]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[w,wc],[y,_]],[/(apple) ?tv/i],[w,[d,"Apple TV"],[y,_]],[/crkey/i],[[d,"Chromecast"],[w,Bs],[y,_]],[/droid.+aft(\w)( bui|\))/i],[d,[w,J],[y,_]],[/\(dtv[\);].+(aquos)/i],[d,[w,"Sharp"],[y,_]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[w,Oc],[d,Oc],[y,_]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[y,_]],[/((pebble))app/i],[w,d,[y,L]],[/droid.+; (glass) \d/i],[d,[w,Bs],[y,L]],[/droid.+; (wt63?0{2,3})\)/i],[d,[w,kc],[y,L]],[/(quest( 2)?)/i],[d,[w,Ap],[y,L]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[w,[y,z]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[d,[y,$]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[y,I]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[y,I]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[y,$]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[w,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[b,[p,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[b,[p,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[p,b],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[b,p]],os:[[/microsoft (windows) (vista|xp)/i],[p,b],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[p,[b,Ic,Rp]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[p,"Windows"],[b,Ic,Rp]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[b,/_/g,"."],[p,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[p,"Mac OS"],[b,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[b,p],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[p,b],[/\(bb(10);/i],[b,[p,Et]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[b,[p,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[b,[p,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[b,[p,"webOS"]],[/crkey\/([\d\.]+)/i],[b,[p,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[p,"Chromium OS"],b],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[p,b],[/(sunos) ?([\w\.\d]*)/i],[[p,"Solaris"],b],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[p,b]]},rt=function(Q,se){if(typeof Q===m&&(se=Q,Q=c),!(this instanceof rt))return new rt(Q,se).getResult();var ee=Q||(typeof a!==l&&a.navigator&&a.navigator.userAgent?a.navigator.userAgent:""),yt=se?function(V,q){var ln={};for(var Fe in V)q[Fe]&&q[Fe].length%2==0?ln[Fe]=q[Fe].concat(V[Fe]):ln[Fe]=V[Fe];return ln}(_p,se):_p;return this.getBrowser=function(){var V,q={};return q.name=c,q.version=c,gi.call(q,ee,yt.browser),q.major=typeof(V=q.version)===g?V.replace(/[^\d\.]/g,"").split(".")[0]:c,q},this.getCPU=function(){var V={};return V.architecture=c,gi.call(V,ee,yt.cpu),V},this.getDevice=function(){var V={};return V.vendor=c,V.model=c,V.type=c,gi.call(V,ee,yt.device),V},this.getEngine=function(){var V={};return V.name=c,V.version=c,gi.call(V,ee,yt.engine),V},this.getOS=function(){var V={};return V.name=c,V.version=c,gi.call(V,ee,yt.os),V},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return ee},this.setUA=function(V){return ee=typeof V===g&&V.length>255?Oc(V,255):V,this},this.setUA(ee),this};rt.VERSION="0.7.30",rt.BROWSER=zs([p,b,"major"]),rt.CPU=zs([P]),rt.DEVICE=zs([d,w,y,N,$,_,I,L,z]),rt.ENGINE=rt.OS=zs([p,b]),typeof r!==l?(typeof n!==l&&n.exports&&(r=n.exports=rt),r.UAParser=rt):i(5)?(s=(function(){return rt}).call(r,i,r,n))===c||(n.exports=s):typeof a!==l&&(a.UAParser=rt);var gr=typeof a!==l&&(a.jQuery||a.Zepto);if(gr&&!gr.ua){var Vs=new rt;gr.ua=Vs.getResult(),gr.ua.get=function(){return Vs.getUA()},gr.ua.set=function(Q){Vs.setUA(Q);var se=Vs.getResult();for(var ee in se)gr.ua[ee]=se[ee]}}})(typeof window=="object"?window:this)},function(n,r){(function(i){n.exports=i}).call(this,{})},function(n,r){n.exports=function(){var i=["monospace","sans-serif","serif"],s=document.getElementsByTagName("body")[0],a=document.createElement("span");a.style.fontSize="72px",a.innerHTML="mmmmmmmmmmlli";var c={},u={};for(var l in i)a.style.fontFamily=i[l],s.appendChild(a),c[i[l]]=a.offsetWidth,u[i[l]]=a.offsetHeight,s.removeChild(a);this.detect=function(m){var g=!1;for(var d in i){a.style.fontFamily=m+","+i[d],s.appendChild(a);var p=a.offsetWidth!=c[i[d]]||a.offsetHeight!=u[i[d]];s.removeChild(a),g=g||p}return g}}}])})})(IR);const $R=$h({platform:"web",baseUrl:"/api/verity/audit-log",fetch:Ip.fetch.bind(Ip),getDynamicContext:()=>({source:"verity",page:{url:window.location.href,ancestorOrigins:[...window.location.ancestorOrigins??[document.referrer.replace(/\/$/,"")||""]]}})});async function ER({getAssessmentInfo:e,isInstructor:t,extensionConnectIframe:n,checkVerityEnabledFallback:r,injectLoading:i,removeLoading:s,injectUnsupportedBrowser:a,injectInstallExtension:c,injectUpdateExtension:u,injectLaunchLockdown:l,injectLockdownOrMobile:m,injectLaunchMobile:g}){const d=await Ac(n);if(!(!m&&(d||t))){i==null||i();try{const{instituteId:p,lmsProvidedCourseId:y,lmsProvidedAssessmentId:w,assessmentType:b}=await e();let P,N;if(p!=null&&y&&w?(P=await Rc({extensionConnectIframe:n,instituteId:p,lmsProvidedCourseId:y,lmsProvidedAssessmentId:w,assessmentType:b}),P&&(N=await Dp(n,p,y,w))):P=await(r==null?void 0:r())??!1,P){if(d){m==null||m();return}else if(t)return;const{isExtension:$=!0,isLockdown:I,isMobile:_}=N??{};if(_&&Ws())await(g==null?void 0:g(N));else if(Bp()){const L=await me(n).catch(()=>({exists:!1,version:void 0}));if(L.exists)L.version&&!await _c(n,L.version)&&await(u==null?void 0:u(N));else{const z=Gp();($||I&&jc())&&Uc("extension",z)||I&&!l?await(c==null?void 0:c(N)):I&&Uc("lockdown",z)&&await(l==null?void 0:l(N))}}else await(a==null?void 0:a())}}catch(p){throw $R.error(p),p}finally{await(s==null?void 0:s())}}}async function TR({assessmentInfo:e,extensionConnectIframe:t,checkVerityEnabledFallback:n}){if(await Ac(t))return!1;const{instituteId:r,lmsProvidedCourseId:i,lmsProvidedAssessmentId:s,assessmentType:a}=e;let c;if(r!=null&&i&&s?c=await Rc({extensionConnectIframe:t,instituteId:r,lmsProvidedCourseId:i,lmsProvidedAssessmentId:s,assessmentType:a}):c=await(n==null?void 0:n())??!1,!c)return!1;const u=await me(t).catch(()=>({exists:!1,version:void 0}));return!u.exists||u.version&&!await _c(t,u.version)}const NR="(YuJa Verity for Test Proctoring)",xs={ID:{CONTENT:"content"},CLASS:{TO_DO_SIDEBAR_ITEM:"ToDoSidebarItem"},SELECTOR:{TO_DO_SIDEBAR_LINK:".ToDoSidebarItem > a"}},LR={URL_REGEX:/\/courses\/([0-9]+)\/?$/,ID:{DASHBOARD:"right-side"}},sc={URL_REGEX:/\/courses\/([0-9]+)\/modules\/?$/,CLASS:{QUIZ_LIST:"also_assignment",TO_DO_SIDEBAR_ITEM:xs.CLASS.TO_DO_SIDEBAR_ITEM},SELECTOR:{TO_DO_SIDEBAR_LINK:xs.SELECTOR.TO_DO_SIDEBAR_LINK}},oc={URL_REGEX:/\/courses\/([0-9]+)\/assignments\/syllabus\/?$/,CLASS:{QUIZ_LIST:"name",TO_DO_SIDEBAR_ITEM:xs.CLASS.TO_DO_SIDEBAR_ITEM},SELECTOR:{TO_DO_SIDEBAR_LINK:xs.SELECTOR.TO_DO_SIDEBAR_LINK}},AR={URL_REGEX:/\/courses\/([0-9]+)\/assignments\/?$/},PR={URL_REGEX:/\/courses\/([0-9]+)\/grades\/?$/},Ms={LIST_URL_REGEX:/\/courses\/([0-9]+)\/quizzes\/?$/,ID:{WRAPPER_DIV:"not_right_side"}},RR={PREVIEW_URL_REGEX:/\/courses\/([0-9]+)\/quizzes\/([0-9]+)/,ID:{RIGHT_SIDE:"right-side",DISPLAY:"quiz_show"}},_R={PREVIEW_URL_REGEX:/\/courses\/([0-9]+)\/assignments\/([0-9]+)/,ID:{DISPLAY:"tool_content"}},CR={PREVIEW_URL_REGEX:/\/courses\/([0-9]+)\/quizzes\/([0-9]+)\/edit/,ID:{DISPLAY:"quiz_edit_wrapper"}},jR={PREVIEW_URL_REGEX:/\/courses\/([0-9]+)\/quizzes\/([0-9]+)\/take/,ID:{DISPLAY:"tool_content"}};function UR(e){var t;return e?((t=e.textContent)==null?void 0:t.includes(NR))??!1:!1}const xR=()=>!(window.ENV.current_user_is_student||window.ENV.current_user_roles.includes("fake_student"));function $p(e,t,n,r,i){var c;const s={target:n,assessmentIdInfo:e.courseId&&e.quizId?{...e,lmsProvidedCourseId:e.courseId,lmsProvidedAssessmentId:e.quizId}:void 0,thirdPartyOptions:t.thirdPartyAssessmentOptions},a=document.querySelectorAll(`a[href*="courses/${e.courseId}/quizzes/${e.quizId}/take"`);if(a.length===0&&r&&i&&window.verityInstituteId!==void 0){Lc(i,window.location.href).then(()=>Js(i,window.verityInstituteId)).then(u=>{var d;const l=window.location.href.split("/courses")[0],m=window.location.pathname.split("/")[2],g=`${l}/courses/${m}/external_tools/${u}`;(d=window.top)==null||d.location.replace(g)}).catch(console.error);return}for(const u of a){u.removeAttribute("disabled"),u.setAttribute("style","display:none");const l=document.createElement("a");l.classList.add(...u.classList),l.textContent=u.textContent,l.id="start-yuja-test-proctoring",l.href="#yuja",l.addEventListener("click",async m=>{if(m.preventDefault(),m.stopPropagation(),m.stopImmediatePropagation(),r){if(i&&window.verityInstituteId){await Lc(i,window.location.href);const g=await Js(i,window.verityInstituteId),d=window.location.href.split("/courses")[0]+"/courses/"+window.location.pathname.split("/")[2]+"/external_tools/"+g;window.location.href=d}}else zp(s)}),(c=u.parentNode)==null||c.insertBefore(l,u)}}function MR(){var e;if(LR.URL_REGEX.test(window.location.pathname)){const t=(e=document.getElementById("breadcrumbs"))==null?void 0:e.children[0].children[2].children[0];return(t==null?void 0:t.textContent)==="Syllabus"?oc.CLASS.QUIZ_LIST:(t==null?void 0:t.textContent)==="Assignments"?"assignment":sc.CLASS.QUIZ_LIST}return sc.URL_REGEX.test(window.location.pathname)?sc.CLASS.QUIZ_LIST:oc.URL_REGEX.test(window.location.pathname)?oc.CLASS.QUIZ_LIST:AR.URL_REGEX.test(window.location.pathname)?"assignment":PR.URL_REGEX.test(window.location.pathname)?"student_assignment editable":Ms.LIST_URL_REGEX.test(window.location.pathname)?"quiz":null}function ac(e){const t=/https:\/\/.*\/courses\/([0-9]+)\/(assignments|quizzes)\/([0-9]+)/.exec(e);return{lms:"canvas",lmsProvidedCourseId:t==null?void 0:t[1],lmsProvidedAssessmentId:t==null?void 0:t[3],hostName:new URL(e).hostname,isAssignments:(t==null?void 0:t[2])==="assignments"}}async function Ep({lmsProvidedCourseId:e,lmsProvidedAssessmentId:t,isAssignments:n}){if(n)try{const r=await fetch(`/api/v1/courses/${e}/assignments/${t}`),i=r.ok?await r.json():void 0;typeof i=="object"&&"quiz_id"in i&&i.quiz_id&&(n=!1,t=i.quiz_id)}catch(r){console.error(r)}return{instituteId:window.verityInstituteId,lmsProvidedCourseId:e,lmsProvidedAssessmentId:t,assessmentType:n?"canvas-new-quiz":"canvas-quiz"}}function FR(){return RR.PREVIEW_URL_REGEX.test(window.location.pathname)||_R.PREVIEW_URL_REGEX.test(window.location.pathname)}function cc(){const e=document.getElementsByTagName("title");if(e){for(const t of e)if(UR(t))return!0;return!1}return null}const uc=async(e,t)=>{const n=document.getElementById(Ms.ID.WRAPPER_DIV),r=n==null?void 0:n.parentElement;if(!n||!r)return;n.remove();const i=document.createElement("iframe");i.id="yuja-download-instructions-theme",i.style.overflow="auto",i.src="https://zone1.verity.yuja.com/warning/"+t+".html?lms=canvas";const s=document.getElementsByClassName("ic-Layout-contentMain")[0];if(s&&(s.style.display="flex",s.style.justifyContent="center"),i.style.border="none",Ws())i.height="800px",i.width="100%";else{i.height="700px",i.width="100%";const a=document.getElementById("right-side-wrapper");a&&a.remove()}Vp(i,async()=>{if(window.verityInstituteId){const a=await Js(e,window.verityInstituteId),c=window.location.href.split("/courses")[0]+"/courses/"+window.location.pathname.split("/")[2]+"/external_tools/"+a;return{event:"init-auth-instructions",authLink:a?c:void 0,quizLink:void 0}}}),r.appendChild(i),window.addEventListener("message",a=>{if(a.origin!=="https://zone1.verity.yuja.com")return;const c=a.data;(c==null?void 0:c.event)==="instructions-resize"&&(c.scrollHeight&&(i.height=c.scrollHeight+100),c.scrollWidth&&(i.width="100%"),c.noScroll||(document.documentElement.scrollTop=0))})};function DR(){const e=document.getElementById(Ms.ID.WRAPPER_DIV);e&&(e.style.display="none")}function BR(){const e=document.getElementById(Ms.ID.WRAPPER_DIV);e&&e.style.removeProperty("display")}function zR(){return CR.PREVIEW_URL_REGEX.test(window.location.pathname)}function VR(){return jR.PREVIEW_URL_REGEX.test(window.location.pathname)}function qR(e){const t="https://zone1.verity.yuja.com";return new Promise((n,r)=>{e.contentWindow&&window.verityInstituteId?window.verityInstituteId?(e.contentWindow.postMessage({type:"saveInstituteId",instituteId:window.verityInstituteId},t),n(!0)):n(!1):r()})}async function GR(){var e;try{const t=ac(window.location.href),n={lms:t.lms,hostname:t.hostName,courseId:t.lmsProvidedCourseId,quizId:t.lmsProvidedAssessmentId??""},r=await Ae();qR(r);const s=!!(xR()||document.getElementById("preview_quiz_button")||((e=window.top)==null?void 0:e.location.href.includes("speed_grader")))&&document.getElementById("yuja-authentication-instructions")==null;if(!MR()){if(!zR()){if(VR()&&!s&&window.location.href.includes("/take")){const a=ac(window.location.href);await TR({assessmentInfo:await Ep(a),extensionConnectIframe:r,checkVerityEnabledFallback:()=>!!cc()})&&(window.location.href=window.location.href.split("/take")[0])}else if(FR()){const a=async()=>{const c=ac(window.location.href);ER({getAssessmentInfo:()=>Ep(c),isInstructor:s,extensionConnectIframe:r,checkVerityEnabledFallback:()=>!!cc(),injectLoading:DR,removeLoading:BR,injectUnsupportedBrowser:async()=>{Ks(),await uc(r,"browser")},injectInstallExtension:async()=>{Ks(),await uc(r,"download"),De(r,window.location.href,n)},injectUpdateExtension:async()=>{Ks(),await uc(r,"update"),De(r,window.location.href,n)},injectLaunchLockdown:u=>{u&&$p(n,u,window.location.href)},injectLaunchMobile:u=>{u&&$p(n,u,window.location.href,!0,r)}})};cc()===null?document.addEventListener("DOMContentLoaded",a):await a()}}}}catch(t){console.error("YuJa Verity encountered an error: ",t)}window.addEventListener("message",t=>{var n;t.origin==="https://zone1.verity.yuja.com"&&(typeof t.data!="object"||!t.data||"type"in t.data&&t.data.type==="getInstituteId"&&((n=t.source)==null||n.postMessage({type:"sendInstituteId",instituteId:window.verityInstituteId},{targetOrigin:"https://zone1.verity.yuja.com"})))})}window.hasVerityTheme||(window.hasVerityTheme=!0,GR().catch(console.error))})();
//# sourceMappingURL=canvas-f69f0fba.js.map
